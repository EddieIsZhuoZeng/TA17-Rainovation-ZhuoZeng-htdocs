jQuery(function($){var core={MARKER_PULL_DATABASE:"0",MARKER_PULL_XML:"1",PAGE_MAP_LIST:"map-list",PAGE_MAP_EDIT:"map-edit",PAGE_SETTINGS:"map-settings",PAGE_SUPPORT:"map-support",PAGE_CATEGORIES:"categories",PAGE_ADVANCED:"advanced",PAGE_CUSTOM_FIELDS:"custom-fields",maps:[],events:null,settings:null,restAPI:null,localized_strings:null,loadingHTML:'<div class="wpgmza-preloader"><div class="wpgmza-loader">...</div></div>',getCurrentPage:function(){switch(WPGMZA.getQueryParamValue("page")){case"wp-google-maps-menu":return window.location.href.match(/action=edit/)&&window.location.href.match(/map_id=\d+/)?WPGMZA.PAGE_MAP_EDIT:WPGMZA.PAGE_MAP_LIST;case"wp-google-maps-menu-settings":return WPGMZA.PAGE_SETTINGS;case"wp-google-maps-menu-support":return WPGMZA.PAGE_SUPPORT;case"wp-google-maps-menu-categories":return WPGMZA.PAGE_CATEGORIES;case"wp-google-maps-menu-advanced":return WPGMZA.PAGE_ADVANCED;case"wp-google-maps-menu-custom-fields":return WPGMZA.PAGE_CUSTOM_FIELDS;default:return null}},getScrollAnimationOffset:function(){return(WPGMZA.settings.scroll_animation_offset||0)+$("#wpadminbar").height()},getScrollAnimationDuration:function(){return WPGMZA.settings.scroll_animation_milliseconds?WPGMZA.settings.scroll_animation_milliseconds:500},animateScroll:function(element,milliseconds){var offset=WPGMZA.getScrollAnimationOffset();milliseconds=milliseconds||WPGMZA.getScrollAnimationDuration(),$("html, body").animate({scrollTop:$(element).offset().top-offset},milliseconds)},extend:function(child,parent){var constructor=child;child.prototype=Object.create(parent.prototype),child.prototype.constructor=constructor},guid:function(){var d=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(d+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"===c?r:3&r|8).toString(16)})},hexOpacityToRGBA:function(colour,opacity){var hex=parseInt(colour.replace(/^#/,""),16);return[(16711680&hex)>>16,(65280&hex)>>8,255&hex,parseFloat(opacity)]},hexToRgba:function(hex){var c;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)?(3==(c=hex.substring(1).split("")).length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),{r:(c="0x"+c.join(""))>>16&255,g:c>>8&255,b:255&c,a:1}):0},rgbaToString:function(rgba){return"rgba("+rgba.r+", "+rgba.g+", "+rgba.b+", "+rgba.a+")"},latLngRegexp:/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,isLatLngString:function(str){if("string"!=typeof str)return null;str.match(/^\(.+\)$/)&&(str=str.replace(/^\(|\)$/,""));var m=str.match(WPGMZA.latLngRegexp);return m?new WPGMZA.LatLng({lat:parseFloat(m[1]),lng:parseFloat(m[3])}):null},stringToLatLng:function(str){var result=WPGMZA.isLatLngString(str);if(!result)throw new Error("Not a valid latLng");return result},isHexColorString:function(str){return"string"==typeof str&&!!str.match(/#[0-9A-F]{6}/i)},imageDimensionsCache:{},getImageDimensions:function(src,callback){if(WPGMZA.imageDimensionsCache[src])callback(WPGMZA.imageDimensionsCache[src]);else{var img=document.createElement("img");img.onload=function(event){var result={width:img.width,height:img.height};WPGMZA.imageDimensionsCache[src]=result,callback(result)},img.src=src}},decodeEntities:function(input){return input.replace(/&(nbsp|amp|quot|lt|gt);/g,function(m,e){return m[e]}).replace(/&#(\d+);/gi,function(m,e){return String.fromCharCode(parseInt(e,10))})},isDeveloperMode:function(){return this.settings.developer_mode||window.Cookies&&window.Cookies.get("wpgmza-developer-mode")},isProVersion:function(){return"1"==this._isProVersion},openMediaDialog:function(callback){var file_frame;if(file_frame)return file_frame.uploader.uploader.param("post_id",set_to_post_id),void file_frame.open();(file_frame=wp.media.frames.file_frame=wp.media({title:"Select a image to upload",button:{text:"Use this image"},multiple:!1})).on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),callback(attachment.id,attachment.url)}),file_frame.open()},getCurrentPosition:function(callback,error,watch){var nativeFunction="getCurrentPosition";if(WPGMZA.userLocationDenied)error&&error({code:1,message:"Location unavailable"});else if(watch&&(nativeFunction="watchPosition"),navigator.geolocation){var options={enableHighAccuracy:!0};navigator.geolocation[nativeFunction]?navigator.geolocation[nativeFunction](function(position){callback&&callback(position),WPGMZA.events.trigger("userlocationfound")},function(err){options.enableHighAccuracy=!1,navigator.geolocation[nativeFunction](function(position){callback&&callback(position),WPGMZA.events.trigger("userlocationfound")},function(err){console.warn(err.code,err.message),1==err.code&&(WPGMZA.userLocationDenied=!0),error&&error(err)},options)},options):console.warn(nativeFunction+" is not available")}else console.warn("No geolocation available on this device")},watchPosition:function(callback,error){return WPGMZA.getCurrentPosition(callback,error,!0)},runCatchableTask:function(callback,friendlyErrorContainer){if(WPGMZA.isDeveloperMode())callback();else try{callback()}catch(e){var friendlyError=new WPGMZA.FriendlyError(e);$(friendlyErrorContainer).html(""),$(friendlyErrorContainer).append(friendlyError.element),$(friendlyErrorContainer).show()}},assertInstanceOf:function(instance,instanceName){var engine,fullInstanceName,pro=WPGMZA.isProVersion()?"Pro":"";switch(WPGMZA.settings.engine){case"open-layers":engine="OL";break;default:engine="Google"}if(fullInstanceName=WPGMZA[engine+pro+instanceName]?engine+pro+instanceName:WPGMZA[pro+instanceName]?pro+instanceName:WPGMZA[engine+instanceName]?engine+instanceName:instanceName,!(instance instanceof WPGMZA[fullInstanceName]))throw new Error("Object must be an instance of "+fullInstanceName+" (did you call a constructor directly, rather than createInstance?)")},getMapByID:function(id){return!WPGMZA.isProVersion()||MYMAP.map instanceof WPGMZA.Map?MYMAP.map:MYMAP[id].map},isGoogleAutocompleteSupported:function(){return"object"==typeof google&&"object"==typeof google.maps&&"object"==typeof google.maps.places&&"function"==typeof google.maps.places.Autocomplete},googleAPIStatus:window.wpgmza_google_api_status,isSafari:function(){var ua=navigator.userAgent.toLowerCase();return ua.match(/safari/i)&&!ua.match(/chrome/i)},isTouchDevice:function(){return"ontouchstart"in window},isDeviceiOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)},isModernComponentStyleAllowed:function(){return!WPGMZA.settings.user_interface_style||"legacy"==WPGMZA.settings.user_interface_style||"modern"==WPGMZA.settings.user_interface_style},isElementInView:function(element){var pageTop=$(window).scrollTop(),pageBottom=pageTop+$(window).height(),elementTop=$(element).offset().top,elementBottom=elementTop+$(element).height();return elementTop<pageTop&&pageBottom<elementBottom||(pageTop<=elementTop&&elementTop<=pageBottom||pageTop<=elementBottom&&elementBottom<=pageBottom)},isFullScreen:function(){return isFullScreen},getQueryParamValue:function(name){var m,regex=new RegExp(name+"=([^&#]*)");return(m=window.location.href.match(regex))?m[1]:null},notification:function(text,time){switch(arguments.length){case 0:text="",time=4e3;break;case 1:time=4e3}var html='<div class="wpgmza-popup-notification">'+text+"</div>";jQuery("body").append(html),setTimeout(function(){jQuery("body").find(".wpgmza-popup-notification").remove()},time)}};for(var key in window.WPGMZA?window.WPGMZA=$.extend(window.WPGMZA,core):window.WPGMZA=core,WPGMZA_localized_data){var value=WPGMZA_localized_data[key];WPGMZA[key]=value}WPGMZA.settings.useLegacyGlobals=!0,jQuery(function($){$(window).trigger("ready.wpgmza"),$("script[src*='wp-google-maps.combined.js'], script[src*='wp-google-maps-pro.combined.js']").length&&console.warn("Minified script is out of date, using combined script instead.");var elements=$("script").filter(function(){return this.src.match(/(^|\/)jquery\.(min\.)?js(\?|$)/i)});1<elements.length&&console.warn("Multiple jQuery versions detected: ",elements),WPGMZA.restAPI=WPGMZA.RestAPI.createInstance(),$(document).on("click",".wpgmza_edit_btn",function(){WPGMZA.animateScroll("#wpgmaps_tabs_markers")})});var isFullScreen=!1;function onScroll(event){$(".wpgmza_map").each(function(index,el){var isInView=WPGMZA.isElementInView(el);el.wpgmzaScrollIntoViewTriggerFlag?isInView||(el.wpgmzaScrollIntoViewTriggerFlag=!1):isInView&&($(el).trigger("mapscrolledintoview.wpgmza"),el.wpgmzaScrollIntoViewTriggerFlag=!0)})}$(document).on("fullscreenchange",function(){isFullScreen=!!document.fullscreenElement}),$(window).on("load",function(event){for(var key in[]){console.warn("The Array object has been extended incorrectly by your theme or another plugin. This can cause issues with functionality.");break}if("https:"!=window.location.protocol){var warning='<div class="notice notice-warning"><p>'+WPGMZA.localized_strings.unsecure_geolocation+"</p></div>";$(".wpgmza-geolocation-setting").each(function(index,el){$(el).after($(warning))})}}),$(window).on("scroll",onScroll),$(window).on("load",onScroll),WPGMZA.refreshOnLoad&&window.location.reload()}),jQuery(function($){WPGMZA.Compatibility=function(){this.preventDocumentWriteGoogleMapsAPI()},WPGMZA.Compatibility.prototype.preventDocumentWriteGoogleMapsAPI=function(){var old=document.write;document.write=function(content){content.match&&content.match(/maps\.google/)||old.call(document,content)}},WPGMZA.compatiblityModule=new WPGMZA.Compatibility}),function(root,factory){"object"==typeof exports?module.exports=factory(root):"function"==typeof define&&define.amd?define([],factory.bind(root,root)):factory(root)}("undefined"!=typeof global?global:this,function(root){if(root.CSS&&root.CSS.escape)return root.CSS.escape;function cssEscape(value){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var codeUnit,string=String(value),length=string.length,index=-1,result="",firstCodeUnit=string.charCodeAt(0);++index<length;)0!=(codeUnit=string.charCodeAt(index))?result+=1<=codeUnit&&codeUnit<=31||127==codeUnit||0==index&&48<=codeUnit&&codeUnit<=57||1==index&&48<=codeUnit&&codeUnit<=57&&45==firstCodeUnit?"\\"+codeUnit.toString(16)+" ":(0!=index||1!=length||45!=codeUnit)&&(128<=codeUnit||45==codeUnit||95==codeUnit||48<=codeUnit&&codeUnit<=57||65<=codeUnit&&codeUnit<=90||97<=codeUnit&&codeUnit<=122)?string.charAt(index):"\\"+string.charAt(index):result+="�";return result}return root.CSS||(root.CSS={}),root.CSS.escape=cssEscape}),jQuery(function($){Math.PI;function deg2rad(deg){return deg*(Math.PI/180)}WPGMZA.Distance={MILES:!0,KILOMETERS:!1,MILES_PER_KILOMETER:.621371,KILOMETERS_PER_MILE:1.60934,uiToMeters:function(uiDistance){return parseFloat(uiDistance)/(WPGMZA.settings.distance_units==WPGMZA.Distance.MILES?WPGMZA.Distance.MILES_PER_KILOMETER:1)*1e3},uiToKilometers:function(uiDistance){return.001*WPGMZA.Distance.uiToMeters(uiDistance)},uiToMiles:function(uiDistance){return WPGMZA.Distance.uiToKilometers(uiDistance)*WPGMZA.Distance.MILES_PER_KILOMETER},kilometersToUI:function(km){return WPGMZA.settings.distance_units==WPGMZA.Distance.MILES?km*WPGMZA.Distance.MILES_PER_KILOMETER:km},between:function(a,b){if(!(a instanceof WPGMZA.LatLng||"lat"in a&&"lng"in a))throw new Error("First argument must be an instance of WPGMZA.LatLng or a literal");if(!(b instanceof WPGMZA.LatLng||"lat"in b&&"lng"in b))throw new Error("Second argument must be an instance of WPGMZA.LatLng or a literal");if(a===b)return 0;var lat1=a.lat,lon1=a.lng,lat2=b.lat,lon2=b.lng,dLat=deg2rad(lat2-lat1),dLon=deg2rad(lon2-lon1);a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(deg2rad(lat1))*Math.cos(deg2rad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}}}),jQuery(function($){WPGMZA.EliasFano=function(){if(!WPGMZA.EliasFano.isSupported)throw new Error("Elias Fano encoding is not supported on browsers without Uint8Array");WPGMZA.EliasFano.decodingTablesInitialised||WPGMZA.EliasFano.createDecodingTable()},WPGMZA.EliasFano.isSupported="Uint8Array"in window,WPGMZA.EliasFano.decodingTableHighBits=[],WPGMZA.EliasFano.decodingTableDocIDNumber=null,WPGMZA.EliasFano.decodingTableHighBitsCarryover=null,WPGMZA.EliasFano.createDecodingTable=function(){WPGMZA.EliasFano.decodingTableDocIDNumber=new Uint8Array(256),WPGMZA.EliasFano.decodingTableHighBitsCarryover=new Uint8Array(256);for(var decodingTableHighBits=WPGMZA.EliasFano.decodingTableHighBits,decodingTableDocIDNumber=WPGMZA.EliasFano.decodingTableDocIDNumber,decodingTableHighBitsCarryover=WPGMZA.EliasFano.decodingTableHighBitsCarryover,i=0;i<256;i++){var zeroCount=0;decodingTableHighBits[i]=[];for(var j=7;0<=j;j--)zeroCount=0<(i&1<<j)?(decodingTableHighBits[i][decodingTableDocIDNumber[i]]=zeroCount,decodingTableDocIDNumber[i]++,0):(zeroCount+1)%255;decodingTableHighBitsCarryover[i]=zeroCount}WPGMZA.EliasFano.decodingTablesInitialised=!0},WPGMZA.EliasFano.prototype.encode=function(list){var lastDocID=0,buffer1=0,bufferLength1=0,buffer2=0,bufferLength2=0;if(0==list.length)return result;function toByte(n){return 255&n}var compressedBufferPointer1=0,compressedBufferPointer2=0,averageDelta=list[list.length-1]/list.length,averageDeltaLog=Math.log2(averageDelta),lowBitsLength=Math.floor(averageDeltaLog),lowBitsMask=(1<<lowBitsLength)-1,prev=null,maxCompressedSize=Math.floor((2+Math.ceil(Math.log2(averageDelta)))*list.length/8)+6,compressedBuffer=new Uint8Array(maxCompressedSize);lowBitsLength<0&&(lowBitsLength=0),compressedBufferPointer2=Math.floor(lowBitsLength*list.length/8+6),compressedBuffer[compressedBufferPointer1++]=toByte(list.length),compressedBuffer[compressedBufferPointer1++]=toByte(list.length>>8),compressedBuffer[compressedBufferPointer1++]=toByte(list.length>>16),compressedBuffer[compressedBufferPointer1++]=toByte(list.length>>24),compressedBuffer[compressedBufferPointer1++]=toByte(lowBitsLength),list.forEach(function(docID){var docIDDelta=docID-lastDocID-1;if(!$.isNumeric(docID))throw new Error("Value is not numeric");if(docID=parseInt(docID),null!==prev&&docID<=prev)throw new Error("Elias Fano encoding can only be used on a sorted, ascending list of unique integers.");for(prev=docID,buffer1<<=lowBitsLength,buffer1|=docIDDelta&lowBitsMask,bufferLength1+=lowBitsLength;7<bufferLength1;)bufferLength1-=8,compressedBuffer[compressedBufferPointer1++]=toByte(buffer1>>bufferLength1);var unaryCodeLength=1+(docIDDelta>>lowBitsLength);for(buffer2<<=unaryCodeLength,buffer2|=1,bufferLength2+=unaryCodeLength;7<bufferLength2;)bufferLength2-=8,compressedBuffer[compressedBufferPointer2++]=toByte(buffer2>>bufferLength2);lastDocID=docID}),0<bufferLength1&&(compressedBuffer[compressedBufferPointer1++]=toByte(buffer1<<8-bufferLength1)),0<bufferLength2&&(compressedBuffer[compressedBufferPointer2++]=toByte(buffer2<<8-bufferLength2));var result=new Uint8Array(compressedBuffer);return result.pointer=compressedBufferPointer2,result},WPGMZA.EliasFano.prototype.decode=function(compressedBuffer){var resultPointer=0,list=[],decodingTableHighBits=WPGMZA.EliasFano.decodingTableHighBits,decodingTableDocIDNumber=WPGMZA.EliasFano.decodingTableDocIDNumber,decodingTableHighBitsCarryover=WPGMZA.EliasFano.decodingTableHighBitsCarryover,lowBitsPointer=0,lastDocID=0,docID=0,docIDNumber=0,listCount=compressedBuffer[lowBitsPointer++];listCount|=compressedBuffer[lowBitsPointer++]<<8,listCount|=compressedBuffer[lowBitsPointer++]<<16,listCount|=compressedBuffer[lowBitsPointer++]<<24;var highBitsPointer,lowBitsLength=compressedBuffer[lowBitsPointer++],lowBitsCount=0,lowBits=0,cb=1;for(highBitsPointer=Math.floor(lowBitsLength*listCount/8+6);highBitsPointer<compressedBuffer.pointer;highBitsPointer++){docID+=decodingTableHighBitsCarryover[cb],docIDNumber=decodingTableDocIDNumber[cb=compressedBuffer[highBitsPointer]];for(var i=0;i<docIDNumber;i++){for(docID<<=lowBitsCount,docID|=lowBits&(1<<lowBitsCount)-1;lowBitsCount<lowBitsLength;)docID<<=8,docID|=lowBits=compressedBuffer[lowBitsPointer++],lowBitsCount+=8;docID>>=lowBitsCount-=lowBitsLength,docID+=(decodingTableHighBits[cb][i]<<lowBitsLength)+lastDocID+1,lastDocID=list[resultPointer++]=docID,docID=0}}return list}}),jQuery(function($){WPGMZA.EventDispatcher=function(){WPGMZA.assertInstanceOf(this,"EventDispatcher"),this._listenersByType={}},WPGMZA.EventDispatcher.prototype.addEventListener=function(type,listener,thisObject,useCapture){var types=type.split(/\s+/);if(1<types.length)for(var i=0;i<types.length;i++)this.addEventListener(types[i],listener,thisObject,useCapture);else{if(!(listener instanceof Function))throw new Error("Listener must be a function");var target;target=this._listenersByType.hasOwnProperty(type)?this._listenersByType[type]:this._listenersByType[type]=[];var obj={listener:listener,thisObject:thisObject||this,useCapture:!!useCapture};target.push(obj)}},WPGMZA.EventDispatcher.prototype.on=WPGMZA.EventDispatcher.prototype.addEventListener,WPGMZA.EventDispatcher.prototype.removeEventListener=function(type,listener,thisObject,useCapture){var arr,obj;if(arr=this._listenersByType[type]){thisObject=thisObject||this,useCapture=!!useCapture;for(var i=0;i<arr.length;i++)if(obj=arr[i],(1==arguments.length||obj.listener==listener)&&obj.thisObject==thisObject&&obj.useCapture==useCapture)return void arr.splice(i,1)}},WPGMZA.EventDispatcher.prototype.off=WPGMZA.EventDispatcher.prototype.removeEventListener,WPGMZA.EventDispatcher.prototype.hasEventListener=function(type){return!!_listenersByType[type]},WPGMZA.EventDispatcher.prototype.dispatchEvent=function(event){if(!(event instanceof WPGMZA.Event))if("string"==typeof event)event=new WPGMZA.Event(event);else{var src=event;for(var name in event=new WPGMZA.Event,src)event[name]=src[name]}for(var path=[],obj=(event.target=this).parent;null!=obj;obj=obj.parent)path.unshift(obj);event.phase=WPGMZA.Event.CAPTURING_PHASE;for(var i=0;i<path.length&&!event._cancelled;i++)path[i]._triggerListeners(event);if(!event._cancelled){for(event.phase=WPGMZA.Event.AT_TARGET,this._triggerListeners(event),event.phase=WPGMZA.Event.BUBBLING_PHASE,i=path.length-1;0<=i&&!event._cancelled;i--)path[i]._triggerListeners(event);var topMostElement=this.element;for(obj=this.parent;null!=obj;obj=obj.parent)obj.element&&(topMostElement=obj.element);if(topMostElement){var customEvent={};for(var key in event){var value=event[key];"type"==key&&(value+=".wpgmza"),customEvent[key]=value}$(topMostElement).trigger(customEvent)}}},WPGMZA.EventDispatcher.prototype.trigger=WPGMZA.EventDispatcher.prototype.dispatchEvent,WPGMZA.EventDispatcher.prototype._triggerListeners=function(event){var arr,obj;if(arr=this._listenersByType[event.type])for(var i=0;i<arr.length;i++)obj=arr[i],event.phase==WPGMZA.Event.CAPTURING_PHASE&&!obj.useCapture||obj.listener.call(arr[i].thisObject,event)},WPGMZA.events=new WPGMZA.EventDispatcher}),jQuery(function($){WPGMZA.Event=function(options){if("string"==typeof options&&(this.type=options),this.bubbles=!0,this.cancelable=!0,this.phase=WPGMZA.Event.PHASE_CAPTURE,this.target=null,this._cancelled=!1,"object"==typeof options)for(var name in options)this[name]=options[name]},WPGMZA.Event.CAPTURING_PHASE=0,WPGMZA.Event.AT_TARGET=1,WPGMZA.Event.BUBBLING_PHASE=2,WPGMZA.Event.prototype.stopPropagation=function(){this._cancelled=!0}}),jQuery(function($){WPGMZA.FancyControls={formatToggleSwitch:function(el){var div=$("<div class='switch'></div>"),input=el,container=el.parentNode,text=$(container).text().trim(),label=$("<label></label>");$(input).addClass("cmn-toggle cmn-toggle-round-flat"),$(input).attr("id",$(input).attr("name")),$(label).attr("for",$(input).attr("name")),$(div).append(input),$(div).append(label),$(container).replaceWith(div),$(div).wrap($("<div></div>")),$(div).after(text)},formatToggleButton:function(el){var div=$("<div class='switch'></div>"),input=el,container=el.parentNode,text=$(container).text().trim(),label=$("<label></label>");$(input).addClass("cmn-toggle cmn-toggle-yes-no"),$(input).attr("id",$(input).attr("name")),$(label).attr("for",$(input).attr("name")),$(label).attr("data-on",WPGMZA.localized_strings.yes),$(label).attr("data-off",WPGMZA.localized_strings.no),$(div).append(input),$(div).append(label),$(container).replaceWith(div),$(div).wrap($("<div></div>")),$(div).after(text)}},$(".wpgmza-fancy-toggle-switch").each(function(index,el){WPGMZA.FancyControls.formatToggleSwitch(el)}),$(".wpgmza-fancy-toggle-button").each(function(index,el){WPGMZA.FancyControls.formatToggleButton(el)})}),jQuery(function($){WPGMZA.FriendlyError=function(){}}),jQuery(function($){WPGMZA.Geocoder=function(){WPGMZA.assertInstanceOf(this,"Geocoder")},WPGMZA.Geocoder.SUCCESS="success",WPGMZA.Geocoder.ZERO_RESULTS="zero-results",WPGMZA.Geocoder.FAIL="fail",WPGMZA.Geocoder.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.OLGeocoder;default:return WPGMZA.GoogleGeocoder}},WPGMZA.Geocoder.createInstance=function(){return new(WPGMZA.Geocoder.getConstructor())},WPGMZA.Geocoder.prototype.getLatLngFromAddress=function(options,callback){if(WPGMZA.isLatLngString(options.address)){var parts=options.address.split(/,\s*/),latLng=new WPGMZA.LatLng({lat:parseFloat(parts[0]),lng:parseFloat(parts[1])});callback([latLng.latLng=latLng],WPGMZA.Geocoder.SUCCESS)}},WPGMZA.Geocoder.prototype.getAddressFromLatLng=function(options,callback){callback([new WPGMZA.LatLng(options.latLng).toString()],WPGMZA.Geocoder.SUCCESS)},WPGMZA.Geocoder.prototype.geocode=function(options,callback){if("address"in options)return this.getLatLngFromAddress(options,callback);if("latLng"in options)return this.getAddressFromLatLng(options,callback);throw new Error("You must supply either a latLng or address")}}),jQuery(function($){WPGMZA.GoogleAPIErrorHandler=function(){var self=this;if("google-maps"==WPGMZA.settings.engine&&("map-edit"==WPGMZA.currentPage||0==WPGMZA.is_admin&&1==WPGMZA.userCanAdministrator)){this.element=$(WPGMZA.html.googleMapsAPIErrorDialog),1==WPGMZA.is_admin&&this.element.find(".wpgmza-front-end-only").remove(),this.errorMessageList=this.element.find(".wpgmza-google-api-error-list"),this.templateListItem=this.element.find("li.template").remove(),this.messagesAlreadyDisplayed={};var _error=console.error;console.error=function(message){self.onErrorMessage(message),_error.apply(this,arguments)},"google-maps"!=WPGMZA.settings.engine||WPGMZA.settings.wpgmza_google_maps_api_key&&WPGMZA.settings.wpgmza_google_maps_api_key.length||WPGMZA.getCurrentPage()==WPGMZA.PAGE_MAP_EDIT||this.addErrorMessage(WPGMZA.localized_strings.no_google_maps_api_key,["https://www.wpgmaps.com/documentation/creating-a-google-maps-api-key/"])}},WPGMZA.GoogleAPIErrorHandler.prototype.onErrorMessage=function(message){var m;if(message)if((m=message.match(/You have exceeded your (daily )?request quota for this API/))||(m=message.match(/This API project is not authorized to use this API/))||(m=message.match(/^Geocoding Service: .+/))){var urls=message.match(/http(s)?:\/\/[^\s]+/gm);this.addErrorMessage(m[0],urls)}else(m=message.match(/^Google Maps.+error: (.+)\s+(http(s?):\/\/.+)/m))&&this.addErrorMessage(m[1].replace(/([A-Z])/g," $1"),[m[2]])},WPGMZA.GoogleAPIErrorHandler.prototype.addErrorMessage=function(message,urls){var self=this;if(!this.messagesAlreadyDisplayed[message]){var li=this.templateListItem.clone();$(li).find(".wpgmza-message").html(message);var buttonContainer=$(li).find(".wpgmza-documentation-buttons"),buttonTemplate=$(li).find(".wpgmza-documentation-buttons>a");if(buttonTemplate.remove(),urls&&urls.length){for(var i=0;i<urls.length;i++){urls[i];var button=buttonTemplate.clone(),text=WPGMZA.localized_strings.documentation;button.attr("href",urls[i]),$(button).find("i").addClass("fa-external-link"),$(button).append(text)}buttonContainer.append(button)}$(this.errorMessageList).append(li),$("#wpgmza_map, .wpgmza_map").each(function(index,el){var container=$(el).find(".wpgmza-google-maps-api-error-overlay");0==container.length&&(container=$("<div class='wpgmza-google-maps-api-error-overlay'></div>")).html(self.element.html()),setTimeout(function(){$(el).append(container)},1e3)}),$(".gm-err-container").parent().css({"z-index":1}),this.messagesAlreadyDisplayed[message]=!0}},WPGMZA.googleAPIErrorHandler=new WPGMZA.GoogleAPIErrorHandler}),jQuery(function($){WPGMZA.InfoWindow=function(mapObject){var self=this;WPGMZA.EventDispatcher.call(this),WPGMZA.assertInstanceOf(this,"InfoWindow"),this.on("infowindowopen",function(event){self.onOpen(event)}),mapObject&&(this.mapObject=mapObject,this.state=WPGMZA.InfoWindow.STATE_CLOSED,mapObject.map?setTimeout(function(){self.onMapObjectAdded(event)},100):mapObject.addEventListener("added",function(event){self.onMapObjectAdded(event)}))},WPGMZA.InfoWindow.prototype=Object.create(WPGMZA.EventDispatcher.prototype),WPGMZA.InfoWindow.prototype.constructor=WPGMZA.InfoWindow,WPGMZA.InfoWindow.OPEN_BY_CLICK=1,WPGMZA.InfoWindow.OPEN_BY_HOVER=2,WPGMZA.InfoWindow.STATE_OPEN="open",WPGMZA.InfoWindow.STATE_CLOSED="closed",WPGMZA.InfoWindow.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.isProVersion()?WPGMZA.OLProInfoWindow:WPGMZA.OLInfoWindow;default:return WPGMZA.isProVersion()?WPGMZA.GoogleProInfoWindow:WPGMZA.GoogleInfoWindow}},WPGMZA.InfoWindow.createInstance=function(mapObject){return new(this.getConstructor())(mapObject)},WPGMZA.InfoWindow.prototype.getContent=function(callback){var html="";this.mapObject instanceof WPGMZA.Marker&&(html=this.mapObject.address),callback(html)},WPGMZA.InfoWindow.prototype.open=function(map,mapObject){return this.mapObject=mapObject,!WPGMZA.settings.disable_infowindows&&"1"!=WPGMZA.settings.wpgmza_settings_disable_infowindows&&(!this.mapObject.disableInfoWindow&&(this.state=WPGMZA.InfoWindow.STATE_OPEN,!0))},WPGMZA.InfoWindow.prototype.close=function(){this.state!=WPGMZA.InfoWindow.STATE_CLOSED&&(this.state=WPGMZA.InfoWindow.STATE_CLOSED,this.trigger("infowindowclose"))},WPGMZA.InfoWindow.prototype.setContent=function(options){},WPGMZA.InfoWindow.prototype.setOptions=function(options){},WPGMZA.InfoWindow.prototype.onMapObjectAdded=function(){1==this.mapObject.settings.infoopen&&this.open()},WPGMZA.InfoWindow.prototype.onOpen=function(){}}),jQuery(function($){WPGMZA.LatLng=function(arg,lng){if(this._lat=0,(this._lng=0)!=arguments.length)if(1==arguments.length){if("string"==typeof arg){var m;if(!(m=arg.match(WPGMZA.LatLng.REGEXP)))throw new Error("Invalid LatLng string");arg={lat:m[1],lng:m[3]}}if("object"!=typeof arg||!("lat"in arg&&"lng"in arg))throw new Error("Argument must be a LatLng literal");this.lat=arg.lat,this.lng=arg.lng}else this.lat=arg,this.lng=lng},WPGMZA.LatLng.REGEXP=/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,WPGMZA.LatLng.isValid=function(obj){return"object"==typeof obj&&("lat"in obj&&"lng"in obj)},WPGMZA.LatLng.isLatLngString=function(str){return"string"==typeof str&&!!str.match(WPGMZA.LatLng.REGEXP)},Object.defineProperty(WPGMZA.LatLng.prototype,"lat",{get:function(){return this._lat},set:function(val){if(!$.isNumeric(val))throw new Error("Latitude must be numeric");this._lat=parseFloat(val)}}),Object.defineProperty(WPGMZA.LatLng.prototype,"lng",{get:function(){return this._lng},set:function(val){if(!$.isNumeric(val))throw new Error("Longitude must be numeric");this._lng=parseFloat(val)}}),WPGMZA.LatLng.fromString=function(string){if(!WPGMZA.LatLng.isLatLngString(string))throw new Error("Not a valid latlng string");var m=string.match(WPGMZA.LatLng.REGEXP);return new WPGMZA.LatLng({lat:parseFloat(m[1]),lng:parseFloat(m[3])})},WPGMZA.LatLng.prototype.toString=function(){return this._lat+", "+this._lng},WPGMZA.LatLng.fromCurrentPosition=function(callback,options){options=options||{},callback&&WPGMZA.getCurrentPosition(function(position){var latLng=new WPGMZA.LatLng({lat:position.coords.latitude,lng:position.coords.longitude});options.geocodeAddress?WPGMZA.Geocoder.createInstance().getAddressFromLatLng({latLng:latLng},function(results){results.length&&(latLng.address=results[0]),callback(latLng)}):callback(latLng)})},WPGMZA.LatLng.fromGoogleLatLng=function(googleLatLng){return new WPGMZA.LatLng(googleLatLng.lat(),googleLatLng.lng())},WPGMZA.LatLng.toGoogleLatLngArray=function(arr){var result=[];return arr.forEach(function(nativeLatLng){if(!(nativeLatLng instanceof WPGMZA.LatLng||"lat"in nativeLatLng&&"lng"in nativeLatLng))throw new Error("Unexpected input");result.push(new google.maps.LatLng({lat:parseFloat(nativeLatLng.lat),lng:parseFloat(nativeLatLng.lng)}))}),result},WPGMZA.LatLng.prototype.toGoogleLatLng=function(){return new google.maps.LatLng({lat:this.lat,lng:this.lng})},WPGMZA.LatLng.prototype.toLatLngLiteral=function(){return{lat:this.lat,lng:this.lng}},WPGMZA.LatLng.prototype.moveByDistance=function(kilometers,heading){var delta=parseFloat(kilometers)/6371,theta=parseFloat(heading)/180*Math.PI,phi1=this.lat/180*Math.PI,lambda1=this.lng/180*Math.PI,sinPhi1=Math.sin(phi1),cosPhi1=Math.cos(phi1),sinDelta=Math.sin(delta),cosDelta=Math.cos(delta),sinTheta=Math.sin(theta),sinPhi2=sinPhi1*cosDelta+cosPhi1*sinDelta*Math.cos(theta),phi2=Math.asin(sinPhi2),y=sinTheta*sinDelta*cosPhi1,x=cosDelta-sinPhi1*sinPhi2,lambda2=lambda1+Math.atan2(y,x);this.lat=180*phi2/Math.PI,this.lng=180*lambda2/Math.PI},WPGMZA.LatLng.prototype.getGreatCircleDistance=function(arg1,arg2){var other,lat1=this.lat,lon1=this.lng;if(1==arguments.length)other=new WPGMZA.LatLng(arg1);else{if(2!=arguments.length)throw new Error("Invalid number of arguments");other=new WPGMZA.LatLng(arg1,arg2)}var lat2=other.lat,lon2=other.lng,phi1=lat1.toRadians(),phi2=lat2.toRadians(),deltaPhi=(lat2-lat1).toRadians(),deltaLambda=(lon2-lon1).toRadians(),a=Math.sin(deltaPhi/2)*Math.sin(deltaPhi/2)+Math.cos(phi1)*Math.cos(phi2)*Math.sin(deltaLambda/2)*Math.sin(deltaLambda/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}}),jQuery(function($){WPGMZA.LatLngBounds=function(southWest,northEast){if(southWest instanceof WPGMZA.LatLngBounds){var other=southWest;this.south=other.south,this.north=other.north,this.west=other.west,this.east=other.east}else southWest&&northEast&&(this.south=southWest.lat,this.north=northEast.lat,this.west=southWest.lng,this.east=northEast.lng)},WPGMZA.LatLngBounds.fromGoogleLatLngBounds=function(googleLatLngBounds){if(!(googleLatLngBounds instanceof google.maps.LatLngBounds))throw new Error("Argument must be an instance of google.maps.LatLngBounds");var result=new WPGMZA.LatLngBounds,southWest=googleLatLngBounds.getSouthWest(),northEast=googleLatLngBounds.getNorthEast();return result.north=northEast.lat(),result.south=southWest.lat(),result.west=southWest.lng(),result.east=northEast.lng(),result},WPGMZA.LatLngBounds.prototype.isInInitialState=function(){return null==this.north&&null==this.south&&null==this.west&&null==this.east},WPGMZA.LatLngBounds.prototype.extend=function(latLng){if(latLng instanceof WPGMZA.LatLng||(latLng=new WPGMZA.LatLng(latLng)),this.isInInitialState())return this.north=this.south=latLng.lat,void(this.west=this.east=latLng.lng);latLng.lat<this.north&&(this.north=latLng.lat),latLng.lat>this.south&&(this.south=latLng.lat),latLng.lng<this.west&&(this.west=latLng.lng),latLng.lng>this.east&&(this.east=latLng.lng)},WPGMZA.LatLngBounds.prototype.extendByPixelMargin=function(map,x,arg){var y=x;if(!(map instanceof WPGMZA.Map))throw new Error("First argument must be an instance of WPGMZA.Map");if(this.isInInitialState())throw new Error("Cannot extend by pixels in initial state");3<=arguments.length&&(y=arg);var southWest=new WPGMZA.LatLng(this.south,this.west),northEast=new WPGMZA.LatLng(this.north,this.east);southWest=map.latLngToPixels(southWest),northEast=map.latLngToPixels(northEast),southWest.x-=x,southWest.y+=y,northEast.x+=x,northEast.y-=y,southWest=map.pixelsToLatLng(southWest.x,southWest.y),northEast=map.pixelsToLatLng(northEast.x,northEast.y);this.toString();this.north=northEast.lat,this.south=southWest.lat,this.west=southWest.lng,this.east=northEast.lng},WPGMZA.LatLngBounds.prototype.contains=function(latLng){if(!(latLng instanceof WPGMZA.LatLng))throw new Error("Argument must be an instance of WPGMZA.LatLng");return!(latLng.lat<Math.min(this.north,this.south))&&(!(latLng.lat>Math.max(this.north,this.south))&&(this.west<this.east?latLng.lng>=this.west&&latLng.lng<=this.east:latLng.lng<=this.west||latLng.lng>=this.east))},WPGMZA.LatLngBounds.prototype.toString=function(){return this.north+"N "+this.south+"S "+this.west+"W "+this.east+"E"},WPGMZA.LatLngBounds.prototype.toLiteral=function(){return{north:this.north,south:this.south,west:this.west,east:this.east}}}),jQuery(function($){"map-edit"==WPGMZA.currentPage&&(WPGMZA.MapEditPage=function(){var self=this;if(this.themePanel=new WPGMZA.ThemePanel,this.themeEditor=new WPGMZA.ThemeEditor,this.map=WPGMZA.maps[0],"yes"==WPGMZA.settings.wpgmza_settings_map_scroll||"yes"==WPGMZA.settings.wpgmza_settings_map_draggable||"yes"==WPGMZA.settings.wpgmza_settings_map_clickzoom){var diplay_enable_interactions_notice=$("<div class='notice notice-info wpgmza_disabled_interactions_notice' style= 'height: 45px; padding: 7px 5px 2px 5px;'><p style='float: left; padding-top: 10px;'>"+WPGMZA.localized_strings.disabled_interactions_notice+"</p><a class='button button-primary enable_interactions_notice_button' style='float: right;'>"+WPGMZA.localized_strings.disabled_interactions_button+"</a></div>");$(".wpgmza_map").after(diplay_enable_interactions_notice),$(".enable_interactions_notice_button").on("click",function(){WPGMZA.mapEditPage.map.enableAllInteractions(),$(diplay_enable_interactions_notice).fadeOut("slow");var successNotice=$("<div class='notice notice-success'><p>"+WPGMZA.localized_strings.interactions_enabled_notice+"</p></div>");$(WPGMZA.mapEditPage.map.element).after(successNotice),$(successNotice).delay(2e3).fadeIn("slow"),$(successNotice).delay(4e3).fadeOut("slow")})}$("#wpgmza_max_zoom, #wpgmza_min_zoom").on("change input",function(event){self.onZoomLimitChanged(event)})},WPGMZA.MapEditPage.createInstance=function(){return WPGMZA.isProVersion()&&WPGMZA.Version.compare(WPGMZA.pro_version,"8.0.0")>=WPGMZA.Version.EQUAL_TO?new WPGMZA.ProMapEditPage:new WPGMZA.MapEditPage},WPGMZA.MapEditPage.prototype.onZoomLimitChanged=function(event){this.map.setOptions({minZoom:$("#wpgmza_max_zoom").val(),maxZoom:$("#wpgmza_min_zoom").val()})},$(window).on("load",function(event){WPGMZA.mapEditPage=WPGMZA.MapEditPage.createInstance()}))}),jQuery(function($){WPGMZA.MapObject=function(row){if(WPGMZA.assertInstanceOf(this,"MapObject"),WPGMZA.EventDispatcher.call(this),this.id=-1,this.map_id=null,this.guid=WPGMZA.guid(),this.modified=!0,this.settings={},row)for(var name in row)if("settings"==name){if(null==row.settings)this.settings={};else switch(typeof row.settings){case"string":this.settings=JSON.parse(row[name]);break;case"object":this.settings=row[name];break;default:throw new Error("Don't know how to interpret settings")}for(var name in this.settings){var value=this.settings[name];String(value).match(/^-?\d+$/)&&(this.settings[name]=parseInt(value))}}else this[name]=row[name]},WPGMZA.MapObject.prototype=Object.create(WPGMZA.EventDispatcher.prototype),WPGMZA.MapObject.prototype.constructor=WPGMZA.MapObject,WPGMZA.MapObject.prototype.parseGeometry=function(string){var pairs,coords,results=[];pairs=string.replace(/[^ ,\d\.\-+e]/g,"").split(",");for(var i=0;i<pairs.length;i++)coords=pairs[i].split(" "),results.push({lat:parseFloat(coords[1]),lng:parseFloat(coords[0])});return results},WPGMZA.MapObject.prototype.toJSON=function(){return{id:this.id,guid:this.guid,settings:this.settings}}}),jQuery(function($){var Parent=WPGMZA.MapObject;WPGMZA.Circle=function(options,engineCircle){WPGMZA.assertInstanceOf(this,"Circle"),this.center=new WPGMZA.LatLng,this.radius=100,Parent.apply(this,arguments)},WPGMZA.Circle.prototype=Object.create(Parent.prototype),WPGMZA.Circle.prototype.constructor=WPGMZA.Circle,WPGMZA.Circle.createInstance=function(options){var constructor;switch(WPGMZA.settings.engine){case"open-layers":constructor=WPGMZA.OLCircle;break;default:constructor=WPGMZA.GoogleCircle}return new constructor(options)},WPGMZA.Circle.prototype.getCenter=function(){return this.center.clone()},WPGMZA.Circle.prototype.setCenter=function(latLng){this.center.lat=latLng.lat,this.center.lng=latLng.lng},WPGMZA.Circle.prototype.getRadius=function(){return this.radius},WPGMZA.Circle.prototype.setRadius=function(radius){this.radius=radius},WPGMZA.Circle.prototype.getMap=function(){return this.map},WPGMZA.Circle.prototype.setMap=function(map){this.map&&this.map.removeCircle(this),map&&map.addCircle(this)}}),jQuery(function($){WPGMZA.MapSettingsPage=function(){var self=this;this._keypressHistory=[],this.updateEngineSpecificControls(),this.updateGDPRControls(),$("#wpgmza-developer-mode").hide(),$(window).on("keypress",function(event){self.onKeyPress(event)}),$("select[name='wpgmza_maps_engine']").on("change",function(event){self.updateEngineSpecificControls()}),$("input[name='wpgmza_gdpr_require_consent_before_load'], input[name='wpgmza_gdpr_require_consent_before_vgm_submit'], input[name='wpgmza_gdpr_override_notice']").on("change",function(event){self.updateGDPRControls()})},WPGMZA.MapSettingsPage.createInstance=function(){return new WPGMZA.MapSettingsPage},WPGMZA.MapSettingsPage.prototype.updateEngineSpecificControls=function(){var engine=$("select[name='wpgmza_maps_engine']").val();$("[data-required-maps-engine][data-required-maps-engine!='"+engine+"']").hide(),$("[data-required-maps-engine='"+engine+"']").show()},WPGMZA.MapSettingsPage.prototype.updateGDPRControls=function(){var showNoticeControls=$("input[name='wpgmza_gdpr_require_consent_before_load']").prop("checked"),vgmCheckbox=$("input[name='wpgmza_gdpr_require_consent_before_vgm_submit']");vgmCheckbox.length&&(showNoticeControls=showNoticeControls||vgmCheckbox.prop("checked"));var showOverrideTextarea=showNoticeControls&&$("input[name='wpgmza_gdpr_override_notice']").prop("checked");showNoticeControls?$("#wpgmza-gdpr-compliance-notice").show("slow"):$("#wpgmza-gdpr-compliance-notice").hide("slow"),showOverrideTextarea?$("#wpgmza_gdpr_override_notice_text").show("slow"):$("#wpgmza_gdpr_override_notice_text").hide("slow")},WPGMZA.MapSettingsPage.prototype.flushGeocodeCache=function(){(new WPGMZA.OLGeocoder).clearCache(function(response){jQuery("#wpgmza_flush_cache_btn").removeAttr("disabled")})},WPGMZA.MapSettingsPage.prototype.onKeyPress=function(event){this._keypressHistory.push(event.key),9<this._keypressHistory.length&&(this._keypressHistory=this._keypressHistory.slice(this._keypressHistory.length-9)),"codecabin"!=this._keypressHistory.join("")||this._developerModeRevealed||($("#wpgmza-developer-mode").show(),this._developerModeRevealed=!0)},jQuery(function($){window.location.href.match(/wp-google-maps-menu-settings/)&&(WPGMZA.mapSettingsPage=WPGMZA.MapSettingsPage.createInstance(),jQuery(document).ready(function(){jQuery("#wpgmza_flush_cache_btn").on("click",function(){jQuery(this).attr("disabled","disabled"),WPGMZA.mapSettingsPage.flushGeocodeCache()})}))})}),jQuery(function($){WPGMZA.MapSettings=function(element){var json,self=this,str=element.getAttribute("data-settings");try{json=JSON.parse(str)}catch(e){str=(str=str.replace(/\\%/g,"%")).replace(/\\\\"/g,'\\"');try{json=JSON.parse(str)}catch(e){json={},console.warn("Failed to parse map settings JSON")}}function addSettings(input){if(input)for(var key in input)if("other_settings"!=key){var value=input[key];String(value).match(/^-?\d+$/)&&(value=parseInt(value)),self[key]=value}}WPGMZA.assertInstanceOf(this,"MapSettings"),addSettings(WPGMZA.settings),addSettings(json),json&&json.other_settings&&addSettings(json.other_settings)},WPGMZA.MapSettings.prototype.toOLViewOptions=function(){var self=this,options={center:ol.proj.fromLonLat([-119.4179,36.7783]),zoom:4};function empty(name){return"object"!=typeof self[name]&&(!self[name]||!self[name].length)}if("string"==typeof this.start_location){var coords=this.start_location.replace(/^\(|\)$/g,"").split(",");WPGMZA.isLatLngString(this.start_location)?options.center=ol.proj.fromLonLat([parseFloat(coords[1]),parseFloat(coords[0])]):console.warn("Invalid start location")}return this.center&&(options.center=ol.proj.fromLonLat([parseFloat(this.center.lng),parseFloat(this.center.lat)])),empty("map_start_lat")||empty("map_start_lng")||(options.center=ol.proj.fromLonLat([parseFloat(this.map_start_lng),parseFloat(this.map_start_lat)])),this.zoom&&(options.zoom=parseInt(this.zoom)),this.start_zoom&&(options.zoom=parseInt(this.start_zoom)),this.map_min_zoom&&this.map_max_zoom&&(options.minZoom=Math.min(this.map_min_zoom,this.map_max_zoom),options.maxZoom=Math.max(this.map_min_zoom,this.map_max_zoom)),options},WPGMZA.MapSettings.prototype.toGoogleMapsOptions=function(){var self=this,latLngCoords=this.start_location&&this.start_location.length?this.start_location.split(","):[36.7783,-119.4179];function empty(name){return"object"!=typeof self[name]&&(!self[name]||!self[name].length)}function formatCoord(coord){return $.isNumeric(coord)?coord:parseFloat(String(coord).replace(/[\(\)\s]/,""))}var latLng=new google.maps.LatLng(formatCoord(latLngCoords[0]),formatCoord(latLngCoords[1])),zoom=this.start_zoom?parseInt(this.start_zoom):4;!this.start_zoom&&this.zoom&&(zoom=parseInt(this.zoom));var options={zoom:zoom,center:latLng};switch(empty("center")||(options.center=new google.maps.LatLng({lat:parseFloat(this.center.lat),lng:parseFloat(this.center.lng)})),empty("map_start_lat")||empty("map_start_lng")||(options.center=new google.maps.LatLng({lat:parseFloat(this.map_start_lat),lng:parseFloat(this.map_start_lng)})),this.map_min_zoom&&this.map_max_zoom&&(options.minZoom=Math.min(this.map_min_zoom,this.map_max_zoom),options.maxZoom=Math.max(this.map_min_zoom,this.map_max_zoom)),options.zoomControl=!("yes"==this.wpgmza_settings_map_zoom),options.panControl=!("yes"==this.wpgmza_settings_map_pan),options.mapTypeControl=!("yes"==this.wpgmza_settings_map_type),options.streetViewControl=!("yes"==this.wpgmza_settings_map_streetview),options.fullscreenControl=!("yes"==this.wpgmza_settings_map_full_screen_control),options.draggable=!("yes"==this.wpgmza_settings_map_draggable),options.disableDoubleClickZoom="yes"==this.wpgmza_settings_map_clickzoom,this.wpgmza_settings_map_scroll&&(options.scrollwheel=!1),"greedy"==this.wpgmza_force_greedy_gestures||"yes"==this.wpgmza_force_greedy_gestures?options.gestureHandling="greedy":options.gestureHandling="cooperative",parseInt(this.type)){case 2:options.mapTypeId=google.maps.MapTypeId.SATELLITE;break;case 3:options.mapTypeId=google.maps.MapTypeId.HYBRID;break;case 4:options.mapTypeId=google.maps.MapTypeId.TERRAIN;break;default:options.mapTypeId=google.maps.MapTypeId.ROADMAP}return this.wpgmza_theme_data&&this.wpgmza_theme_data.length&&(options.styles=WPGMZA.GoogleMap.parseThemeData(this.wpgmza_theme_data)),options}}),jQuery(function($){WPGMZA.Map=function(element,options){if(WPGMZA.assertInstanceOf(this,"Map"),WPGMZA.EventDispatcher.call(this),!(element instanceof HTMLElement))throw new Error("Argument must be a HTMLElement");if(element.hasAttribute("data-map-id")?this.id=element.getAttribute("data-map-id"):this.id=1,!/\d+/.test(this.id))throw new Error("Map ID must be an integer");if(WPGMZA.maps.push(this),this.element=element,(this.element.wpgmzaMap=this).engineElement=element,this.markers=[],this.polygons=[],this.polylines=[],this.circles=[],this.rectangles=[],this.loadSettings(options),this.shortcodeAttributes={},$(this.element).attr("data-shortcode-attributes"))try{this.shortcodeAttributes=JSON.parse($(this.element).attr("data-shortcode-attributes"))}catch(e){console.warn("Error parsing shortcode attributes")}WPGMZA.getCurrentPage()!=WPGMZA.PAGE_MAP_EDIT&&this.initStoreLocator(),this.markerFilter=WPGMZA.MarkerFilter.createInstance(this)},WPGMZA.Map.prototype=Object.create(WPGMZA.EventDispatcher.prototype),WPGMZA.Map.prototype.constructor=WPGMZA.Map,WPGMZA.Map.nightTimeThemeData=[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#575663"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#80823e"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#1b737a"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],WPGMZA.Map.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.isProVersion()?WPGMZA.OLProMap:WPGMZA.OLMap;default:return WPGMZA.isProVersion()?WPGMZA.GoogleProMap:WPGMZA.GoogleMap}},WPGMZA.Map.createInstance=function(element,options){return new(WPGMZA.Map.getConstructor())(element,options)},Object.defineProperty(WPGMZA.Map.prototype,"lat",{get:function(){return this.getCenter().lat},set:function(value){var center=this.getCenter();center.lat=value,this.setCenter(center)}}),Object.defineProperty(WPGMZA.Map.prototype,"lng",{get:function(){return this.getCenter().lng},set:function(value){var center=this.getCenter();center.lng=value,this.setCenter(center)}}),Object.defineProperty(WPGMZA.Map.prototype,"zoom",{get:function(){return this.getZoom()},set:function(value){this.setZoom(value)}}),WPGMZA.Map.prototype.loadSettings=function(options){var settings=new WPGMZA.MapSettings(this.element);settings.other_settings;if(delete settings.other_settings,options)for(var key in options)settings[key]=options[key];this.settings=settings},WPGMZA.Map.prototype.initStoreLocator=function(){var storeLocatorElement=$(".wpgmza_sl_main_div");storeLocatorElement.length&&(this.storeLocator=WPGMZA.StoreLocator.createInstance(this,storeLocatorElement[0]))},WPGMZA.Map.prototype.setOptions=function(options){for(var name in options)this.settings[name]=options[name]};Math.PI;function deg2rad(deg){return deg*(Math.PI/180)}WPGMZA.Map.getGeographicDistance=function(lat1,lon1,lat2,lon2){var dLat=deg2rad(lat2-lat1),dLon=deg2rad(lon2-lon1),a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(deg2rad(lat1))*Math.cos(deg2rad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))},WPGMZA.Map.prototype.setCenter=function(latLng){if(!("lat"in latLng&&"lng"in latLng))throw new Error("Argument is not an object with lat and lng")},WPGMZA.Map.prototype.setDimensions=function(width,height){$(this.element).css({width:width}),$(this.engineElement).css({width:"100%",height:height})},WPGMZA.Map.prototype.addMarker=function(marker){if(!(marker instanceof WPGMZA.Marker))throw new Error("Argument must be an instance of WPGMZA.Marker");marker.map=this,(marker.parent=this).markers.push(marker),this.dispatchEvent({type:"markeradded",marker:marker}),marker.dispatchEvent({type:"added"})},WPGMZA.Map.prototype.removeMarker=function(marker){if(!(marker instanceof WPGMZA.Marker))throw new Error("Argument must be an instance of WPGMZA.Marker");if(marker.map!==this)throw new Error("Wrong map error");marker.infoWindow&&marker.infoWindow.close(),marker.map=null,marker.parent=null,this.markers.splice(this.markers.indexOf(marker),1),this.dispatchEvent({type:"markerremoved",marker:marker}),marker.dispatchEvent({type:"removed"})},WPGMZA.Map.prototype.getMarkerByID=function(id){for(var i=0;i<this.markers.length;i++)if(this.markers[i].id==id)return this.markers[i];return null},WPGMZA.Map.prototype.getMarkerByTitle=function(title){if("string"==typeof title){for(var i=0;i<this.markers.length;i++)if(this.markers[i].title==title)return this.markers[i]}else{if(!(title instanceof RegExp))throw new Error("Invalid argument");for(i=0;i<this.markers.length;i++)if(title.test(this.markers[i].title))return this.markers[i]}return null},WPGMZA.Map.prototype.removeMarkerByID=function(id){var marker=this.getMarkerByID(id);marker&&this.removeMarker(marker)},WPGMZA.Map.prototype.addPolygon=function(polygon){if(!(polygon instanceof WPGMZA.Polygon))throw new Error("Argument must be an instance of WPGMZA.Polygon");(polygon.map=this).polygons.push(polygon),this.dispatchEvent({type:"polygonadded",polygon:polygon})},WPGMZA.Map.prototype.removePolygon=function(polygon){if(!(polygon instanceof WPGMZA.Polygon))throw new Error("Argument must be an instance of WPGMZA.Polygon");if(polygon.map!==this)throw new Error("Wrong map error");polygon.map=null,this.polygons.splice(this.polygons.indexOf(polygon),1),this.dispatchEvent({type:"polygonremoved",polygon:polygon})},WPGMZA.Map.prototype.getPolygonByID=function(id){for(var i=0;i<this.polygons.length;i++)if(this.polygons[i].id==id)return this.polygons[i];return null},WPGMZA.Map.prototype.removePolygonByID=function(id){var polygon=this.getPolygonByID(id);polygon&&this.removePolygon(polygon)},WPGMZA.Map.prototype.getPolylineByID=function(id){for(var i=0;i<this.polylines.length;i++)if(this.polylines[i].id==id)return this.polylines[i];return null},WPGMZA.Map.prototype.addPolyline=function(polyline){if(!(polyline instanceof WPGMZA.Polyline))throw new Error("Argument must be an instance of WPGMZA.Polyline");(polyline.map=this).polylines.push(polyline),this.dispatchEvent({type:"polylineadded",polyline:polyline})},WPGMZA.Map.prototype.removePolyline=function(polyline){if(!(polyline instanceof WPGMZA.Polyline))throw new Error("Argument must be an instance of WPGMZA.Polyline");if(polyline.map!==this)throw new Error("Wrong map error");polyline.map=null,this.polylines.splice(this.polylines.indexOf(polyline),1),this.dispatchEvent({type:"polylineremoved",polyline:polyline})},WPGMZA.Map.prototype.getPolylineByID=function(id){for(var i=0;i<this.polylines.length;i++)if(this.polylines[i].id==id)return this.polylines[i];return null},WPGMZA.Map.prototype.removePolylineByID=function(id){var polyline=this.getPolylineByID(id);polyline&&this.removePolyline(polyline)},WPGMZA.Map.prototype.addCircle=function(circle){if(!(circle instanceof WPGMZA.Circle))throw new Error("Argument must be an instance of WPGMZA.Circle");(circle.map=this).circles.push(circle),this.dispatchEvent({type:"circleadded",circle:circle})},WPGMZA.Map.prototype.removeCircle=function(circle){if(!(circle instanceof WPGMZA.Circle))throw new Error("Argument must be an instance of WPGMZA.Circle");if(circle.map!==this)throw new Error("Wrong map error");circle.map=null,this.circles.splice(this.circles.indexOf(circle),1),this.dispatchEvent({type:"circleremoved",circle:circle})},WPGMZA.Map.prototype.getCircleByID=function(id){for(var i=0;i<this.circles.length;i++)if(this.circles[i].id==id)return this.circles[i];return null},WPGMZA.Map.prototype.removeCircleByID=function(id){var circle=this.getCircleByID(id);circle&&this.removeCircle(circle)},WPGMZA.Map.prototype.nudgeLatLng=function(latLng,x,y){var pixels=this.latLngToPixels(latLng);if(pixels.x+=parseFloat(x),pixels.y+=parseFloat(y),isNaN(pixels.x)||isNaN(pixels.y))throw new Error("Invalid coordinates supplied");return this.pixelsToLatLng(pixels)},WPGMZA.Map.prototype.nudge=function(x,y){var nudged=this.nudgeLatLng(this.getCenter(),x,y);this.setCenter(nudged)},WPGMZA.Map.prototype.animateNudge=function(x,y,origin,milliseconds){var nudged;if(origin){if(!(origin instanceof WPGMZA.LatLng))throw new Error("Origin must be an instance of WPGMZA.LatLng")}else origin=this.getCenter();nudged=this.nudgeLatLng(origin,x,y),milliseconds=milliseconds||WPGMZA.getScrollAnimationDuration(),$(this).animate({lat:nudged.lat,lng:nudged.lng},milliseconds)},WPGMZA.Map.prototype.onWindowResize=function(event){},WPGMZA.Map.prototype.onElementResized=function(event){},WPGMZA.Map.prototype.onBoundsChanged=function(event){this.trigger("boundschanged"),this.trigger("bounds_changed")},WPGMZA.Map.prototype.onIdle=function(event){this.trigger("idle")},WPGMZA.Map.prototype.hasVisibleMarkers=function(event){var markers_visible=0;for(var marker_id in marker_array){var marker=marker_array[marker_id];if(marker.isFilterable&&marker.getMap()){markers_visible++;break}}return 0<markers_visible},WPGMZA.Map.prototype.closeAllInfoWindows=function(){this.markers.forEach(function(marker){marker.infoWindow&&marker.infoWindow.close()})}}),jQuery(function($){WPGMZA.MapsEngineDialog=function(element){var self=this;this.element=element,window.wpgmzaUnbindSaveReminder&&window.wpgmzaUnbindSaveReminder(),$(element).show(),$(element).remodal().open(),$(element).find("input:radio").on("change",function(event){$("#wpgmza-confirm-engine").prop("disabled",!1)}),$("#wpgmza-confirm-engine").on("click",function(event){self.onButtonClicked(event)})},WPGMZA.MapsEngineDialog.prototype.onButtonClicked=function(event){$(event.target).prop("disabled",!0),$.ajax(WPGMZA.ajaxurl,{method:"POST",data:{action:"wpgmza_maps_engine_dialog_set_engine",engine:$("[name='wpgmza_maps_engine']:checked").val(),nonce:$("#wpgmza-maps-engine-dialog").attr("data-ajax-nonce")},success:function(response,status,xhr){window.location.reload()}})},$(window).on("load",function(event){var element=$("#wpgmza-maps-engine-dialog");element.length&&(WPGMZA.settings.wpgmza_maps_engine_dialog_done||WPGMZA.settings.wpgmza_google_maps_api_key&&WPGMZA.settings.wpgmza_google_maps_api_key.length||(WPGMZA.mapsEngineDialog=new WPGMZA.MapsEngineDialog(element)))})}),jQuery(function($){WPGMZA.MarkerFilter=function(map){WPGMZA.EventDispatcher.call(this),this.map=map},WPGMZA.MarkerFilter.prototype=Object.create(WPGMZA.EventDispatcher.prototype),WPGMZA.MarkerFilter.prototype.constructor=WPGMZA.MarkerFilter,WPGMZA.MarkerFilter.createInstance=function(map){return new WPGMZA.MarkerFilter(map)},WPGMZA.MarkerFilter.prototype.getFilteringParameters=function(){var params={map_id:this.map.id};return this.map.storeLocator&&(params=$.extend(params,this.map.storeLocator.getFilteringParameters())),params},WPGMZA.MarkerFilter.prototype.update=function(){},WPGMZA.MarkerFilter.prototype.onFilteringComplete=function(results){}}),jQuery(function($){WPGMZA.MarkerPanel=function(element){this.element=element},$(window).on("load",function(event){WPGMZA.getCurrentPage()==WPGMZA.PAGE_MAP_EDIT&&(WPGMZA.mapEditPage.markerPanel=new WPGMZA.MarkerPanel($("#wpgmza-marker-edit-panel")[0]))})}),jQuery(function($){WPGMZA.Marker=function(row){var self=this;this._offset={x:0,y:0},WPGMZA.assertInstanceOf(this,"Marker"),this.lat="36.778261",this.lng="-119.4179323999",this.address="California",this.title=null,this.description="",this.link="",this.icon="",this.approved=1,this.pic=null,this.isFilterable=!0,this.disableInfoWindow=!1,WPGMZA.MapObject.apply(this,arguments),row&&row.heatmap||(row&&this.on("init",function(event){row.position&&this.setPosition(row.position),row.map&&row.map.addMarker(this)}),this.addEventListener("added",function(event){self.onAdded(event)}),this.handleLegacyGlobals(row))},WPGMZA.Marker.prototype=Object.create(WPGMZA.MapObject.prototype),WPGMZA.Marker.prototype.constructor=WPGMZA.Marker,WPGMZA.Marker.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.isProVersion()?WPGMZA.OLProMarker:WPGMZA.OLMarker;default:return WPGMZA.isProVersion()?WPGMZA.GoogleProMarker:WPGMZA.GoogleMarker}},WPGMZA.Marker.createInstance=function(row){return new(WPGMZA.Marker.getConstructor())(row)},WPGMZA.Marker.ANIMATION_NONE="0",WPGMZA.Marker.ANIMATION_BOUNCE="1",WPGMZA.Marker.ANIMATION_DROP="2",Object.defineProperty(WPGMZA.Marker.prototype,"offsetX",{get:function(){return this._offset.x},set:function(value){this._offset.x=value,this.updateOffset()}}),Object.defineProperty(WPGMZA.Marker.prototype,"offsetY",{get:function(){return this._offset.y},set:function(value){this._offset.y=value,this.updateOffset()}}),WPGMZA.Marker.prototype.onAdded=function(event){var self=this;this.addEventListener("click",function(event){self.onClick(event)}),this.addEventListener("mouseover",function(event){self.onMouseOver(event)}),this.addEventListener("select",function(event){self.onSelect(event)}),this.map.settings.marker==this.id&&self.trigger("select"),"1"==this.infoopen&&this.openInfoWindow()},WPGMZA.Marker.prototype.handleLegacyGlobals=function(row){var m;if(WPGMZA.settings.useLegacyGlobals&&this.map_id&&this.id&&!(WPGMZA.pro_version&&(m=WPGMZA.pro_version.match(/\d+/))&&m[0]<=7)){window.marker_array||(window.marker_array={}),marker_array[this.map_id]||(marker_array[this.map_id]=[]),marker_array[this.map_id][this.id]=this,window.wpgmaps_localize_marker_data||(window.wpgmaps_localize_marker_data={}),wpgmaps_localize_marker_data[this.map_id]||(wpgmaps_localize_marker_data[this.map_id]=[]);var cloned=$.extend({marker_id:this.id},row);wpgmaps_localize_marker_data[this.map_id][this.id]=cloned}},WPGMZA.Marker.prototype.initInfoWindow=function(){this.infoWindow||(this.infoWindow=WPGMZA.InfoWindow.createInstance())},WPGMZA.Marker.prototype.openInfoWindow=function(){this.map?"map-edit"==WPGMZA.currentPage&&!WPGMZA.pro_version||(this.map.lastInteractedMarker&&this.map.lastInteractedMarker.infoWindow.close(),(this.map.lastInteractedMarker=this).initInfoWindow(),this.infoWindow.open(this.map,this)):console.warn("Cannot open infowindow for marker with no map")},WPGMZA.Marker.prototype.onClick=function(event){},WPGMZA.Marker.prototype.onSelect=function(event){this.openInfoWindow()},WPGMZA.Marker.prototype.onMouseOver=function(event){this.map.settings.info_window_open_by==WPGMZA.InfoWindow.OPEN_BY_HOVER&&this.openInfoWindow()},WPGMZA.Marker.prototype.getIcon=function(){function stripProtocol(url){return"string"!=typeof url?url:url.replace(/^http(s?):/,"")}return WPGMZA.defaultMarkerIcon?stripProtocol(WPGMZA.defaultMarkerIcon):stripProtocol(WPGMZA.settings.default_marker_icon)},WPGMZA.Marker.prototype.getPosition=function(){return new WPGMZA.LatLng({lat:parseFloat(this.lat),lng:parseFloat(this.lng)})},WPGMZA.Marker.prototype.setPosition=function(latLng){latLng instanceof WPGMZA.LatLng?(this.lat=latLng.lat,this.lng=latLng.lng):(this.lat=parseFloat(latLng.lat),this.lng=parseFloat(latLng.lng))},WPGMZA.Marker.prototype.setOffset=function(x,y){this._offset.x=x,this._offset.y=y,this.updateOffset()},WPGMZA.Marker.prototype.updateOffset=function(){},WPGMZA.Marker.prototype.getAnimation=function(animation){return this.settings.animation},WPGMZA.Marker.prototype.setAnimation=function(animation){this.settings.animation=animation},WPGMZA.Marker.prototype.getVisible=function(){},WPGMZA.Marker.prototype.setVisible=function(visible){!visible&&this.infoWindow&&this.infoWindow.close()},WPGMZA.Marker.prototype.getMap=function(){return this.map},WPGMZA.Marker.prototype.setMap=function(map){map?map.addMarker(this):this.map&&this.map.removeMarker(this),this.map=map},WPGMZA.Marker.prototype.getDraggable=function(){},WPGMZA.Marker.prototype.setDraggable=function(draggable){},WPGMZA.Marker.prototype.setOptions=function(options){},WPGMZA.Marker.prototype.setOpacity=function(opacity){},WPGMZA.Marker.prototype.panIntoView=function(){if(!this.map)throw new Error("Marker hasn't been added to a map");this.map.setCenter(this.getPosition())},WPGMZA.Marker.prototype.toJSON=function(){var result=WPGMZA.MapObject.prototype.toJSON.call(this),position=this.getPosition();return $.extend(result,{lat:position.lat,lng:position.lng,address:this.address,title:this.title,description:this.description,link:this.link,icon:this.icon,pic:this.pic,approved:this.approved}),result}}),jQuery(function($){WPGMZA.ModernStoreLocatorCircle=function(map_id,settings){var map;map=WPGMZA.isProVersion()?this.map=MYMAP[map_id].map:this.map=MYMAP.map,this.map_id=map_id,this.mapElement=map.element,this.mapSize={width:$(this.mapElement).width(),height:$(this.mapElement).height()},this.initCanvasLayer(),this.settings={center:new WPGMZA.LatLng(0,0),radius:1,color:"#63AFF2",shadowColor:"white",shadowBlur:4,centerRingRadius:10,centerRingLineWidth:3,numInnerRings:9,innerRingLineWidth:1,innerRingFade:!0,numOuterRings:7,ringLineWidth:1,mainRingLineWidth:2,numSpokes:6,spokesStartAngle:Math.PI/2,numRadiusLabels:6,radiusLabelsStartAngle:Math.PI/2,radiusLabelFont:"13px sans-serif",visible:!1},settings&&this.setOptions(settings)},WPGMZA.ModernStoreLocatorCircle.createInstance=function(map,settings){return"google-maps"==WPGMZA.settings.engine?new WPGMZA.GoogleModernStoreLocatorCircle(map,settings):new WPGMZA.OLModernStoreLocatorCircle(map,settings)},WPGMZA.ModernStoreLocatorCircle.prototype.initCanvasLayer=function(){},WPGMZA.ModernStoreLocatorCircle.prototype.onResize=function(event){this.draw()},WPGMZA.ModernStoreLocatorCircle.prototype.onUpdate=function(event){this.draw()},WPGMZA.ModernStoreLocatorCircle.prototype.setOptions=function(options){for(var name in options){var functionName="set"+name.substr(0,1).toUpperCase()+name.substr(1);"function"==typeof this[functionName]?this[functionName](options[name]):this.settings[name]=options[name]}},WPGMZA.ModernStoreLocatorCircle.prototype.getResolutionScale=function(){return window.devicePixelRatio||1},WPGMZA.ModernStoreLocatorCircle.prototype.getCenter=function(){return this.getPosition()},WPGMZA.ModernStoreLocatorCircle.prototype.setCenter=function(value){this.setPosition(value)},WPGMZA.ModernStoreLocatorCircle.prototype.getPosition=function(){return this.settings.center},WPGMZA.ModernStoreLocatorCircle.prototype.setPosition=function(position){this.settings.center=position},WPGMZA.ModernStoreLocatorCircle.prototype.getRadius=function(){return this.settings.radius},WPGMZA.ModernStoreLocatorCircle.prototype.setRadius=function(radius){if(isNaN(radius))throw new Error("Invalid radius");this.settings.radius=radius},WPGMZA.ModernStoreLocatorCircle.prototype.getVisible=function(){return this.settings.visible},WPGMZA.ModernStoreLocatorCircle.prototype.setVisible=function(visible){this.settings.visible=visible},WPGMZA.ModernStoreLocatorCircle.prototype.getTransformedRadius=function(km){throw new Error("Abstract function called")},WPGMZA.ModernStoreLocatorCircle.prototype.getContext=function(type){throw new Error("Abstract function called")},WPGMZA.ModernStoreLocatorCircle.prototype.getCanvasDimensions=function(){throw new Error("Abstract function called")},WPGMZA.ModernStoreLocatorCircle.prototype.validateSettings=function(){WPGMZA.isHexColorString(this.settings.color)||(this.settings.color="#63AFF2")},WPGMZA.ModernStoreLocatorCircle.prototype.draw=function(){this.validateSettings();var settings=this.settings,canvasDimensions=this.getCanvasDimensions(),canvasWidth=canvasDimensions.width,canvasHeight=canvasDimensions.height;this.map,this.getResolutionScale();if(context=this.getContext("2d"),context.clearRect(0,0,canvasWidth,canvasHeight),settings.visible){context.shadowColor=settings.shadowColor,context.shadowBlur=settings.shadowBlur,context.setTransform(1,0,0,1,0,0);var scale=this.getScale();context.scale(scale,scale);var offset=this.getWorldOriginOffset();context.translate(offset.x,offset.y);new WPGMZA.LatLng(this.settings.center);var worldPoint=this.getCenterPixels(),rgba=WPGMZA.hexToRgba(settings.color),ringSpacing=this.getTransformedRadius(settings.radius)/(settings.numInnerRings+1);context.strokeStyle=settings.color,context.lineWidth=1/scale*settings.centerRingLineWidth,context.beginPath(),context.arc(worldPoint.x,worldPoint.y,this.getTransformedRadius(settings.centerRingRadius)/scale,0,2*Math.PI),context.stroke(),context.closePath();var end,radius=this.getTransformedRadius(settings.radius)+ringSpacing*settings.numOuterRings+1,grad=context.createRadialGradient(0,0,0,0,0,radius),start=(rgba=WPGMZA.hexToRgba(settings.color),WPGMZA.rgbaToString(rgba));rgba.a=0,end=WPGMZA.rgbaToString(rgba),grad.addColorStop(0,start),grad.addColorStop(1,end),context.save(),context.translate(worldPoint.x,worldPoint.y),context.strokeStyle=grad,context.lineWidth=2/scale;for(var i=0;i<settings.numSpokes;i++)spokeAngle=settings.spokesStartAngle+2*Math.PI*(i/settings.numSpokes),x=Math.cos(spokeAngle)*radius,y=Math.sin(spokeAngle)*radius,context.setLineDash([2/scale,15/scale]),context.beginPath(),context.moveTo(0,0),context.lineTo(x,y),context.stroke();context.setLineDash([]),context.restore(),context.lineWidth=1/scale*settings.innerRingLineWidth;for(i=1;i<=settings.numInnerRings;i++){radius=i*ringSpacing;settings.innerRingFade&&(rgba.a=1-(i-1)/settings.numInnerRings),context.strokeStyle=WPGMZA.rgbaToString(rgba),context.beginPath(),context.arc(worldPoint.x,worldPoint.y,radius,0,2*Math.PI),context.stroke(),context.closePath()}context.strokeStyle=settings.color,context.lineWidth=1/scale*settings.centerRingLineWidth,context.beginPath(),context.arc(worldPoint.x,worldPoint.y,this.getTransformedRadius(settings.radius),0,2*Math.PI),context.stroke(),context.closePath();for(radius=radius+ringSpacing,i=0;i<settings.numOuterRings;i++)settings.innerRingFade&&(rgba.a=1-i/settings.numOuterRings),context.strokeStyle=WPGMZA.rgbaToString(rgba),context.beginPath(),context.arc(worldPoint.x,worldPoint.y,radius,0,2*Math.PI),context.stroke(),context.closePath(),radius+=ringSpacing;if(0<settings.numRadiusLabels){var m,x,y;radius=this.getTransformedRadius(settings.radius);(m=settings.radiusLabelFont.match(/(\d+)px/))&&parseInt(m[1]),context.font=settings.radiusLabelFont,context.textAlign="center",context.textBaseline="middle",context.fillStyle=settings.color,context.save(),context.translate(worldPoint.x,worldPoint.y);for(i=0;i<settings.numRadiusLabels;i++){var spokeAngle,width,textAngle=(spokeAngle=settings.radiusLabelsStartAngle+2*Math.PI*(i/settings.numRadiusLabels))+Math.PI/2,text=settings.radiusString;0<Math.sin(spokeAngle)&&(textAngle-=Math.PI),x=Math.cos(spokeAngle)*radius,y=Math.sin(spokeAngle)*radius,context.save(),context.translate(x,y),context.rotate(textAngle),context.scale(1/scale,1/scale),width=context.measureText(text).width,height=width/2,context.clearRect(-width,-height,2*width,2*height),context.fillText(settings.radiusString,0,0),context.restore()}context.restore()}}}}),jQuery(function($){WPGMZA.NativeMapsAppIcon=function(){navigator.userAgent.match(/^Apple|iPhone|iPad|iPod/)?(this.type="apple",this.element=$('<span><i class="fab fa fa-apple" aria-hidden="true"></i></span>')):(this.type="google",this.element=$('<span><i class="fab fa fa-google" aria-hidden="true"></i></span>'))}}),jQuery(function($){Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:function(begin,end){return new Uint8Array(Array.prototype.slice.call(this,begin,end))}}),WPGMZA.isSafari()&&!window.external&&(window.external={})}),jQuery(function($){WPGMZA.Polygon=function(row,enginePolygon){WPGMZA.assertInstanceOf(this,"Polygon"),this.paths=null,this.title=null,this.name=null,this.link=null,WPGMZA.MapObject.apply(this,arguments)},WPGMZA.Polygon.prototype=Object.create(WPGMZA.MapObject.prototype),WPGMZA.Polygon.prototype.constructor=WPGMZA.Polygon,WPGMZA.Polygon.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.isProVersion()?WPGMZA.OLProPolygon:WPGMZA.OLPolygon;default:return WPGMZA.isProVersion()?WPGMZA.GoogleProPolygon:WPGMZA.GooglePolygon}},WPGMZA.Polygon.createInstance=function(row,engineObject){return new(WPGMZA.Polygon.getConstructor())(row,engineObject)},WPGMZA.Polygon.prototype.toJSON=function(){var result=WPGMZA.MapObject.prototype.toJSON.call(this);return $.extend(result,{name:this.name,title:this.title,link:this.link}),result}}),jQuery(function($){WPGMZA.Polyline=function(row,googlePolyline){WPGMZA.assertInstanceOf(this,"Polyline"),this.title=null,WPGMZA.MapObject.apply(this,arguments)},WPGMZA.Polyline.prototype=Object.create(WPGMZA.MapObject.prototype),WPGMZA.Polyline.prototype.constructor=WPGMZA.Polyline,WPGMZA.Polyline.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.OLPolyline;default:return WPGMZA.GooglePolyline}},WPGMZA.Polyline.createInstance=function(row,engineObject){return new(WPGMZA.Polyline.getConstructor())(row,engineObject)},WPGMZA.Polyline.prototype.getPoints=function(){return this.toJSON().points},WPGMZA.Polyline.prototype.toJSON=function(){var result=WPGMZA.MapObject.prototype.toJSON.call(this);return result.title=this.title,result}}),jQuery(function($){WPGMZA.PopoutPanel=function(element){this.element=element},WPGMZA.PopoutPanel.prototype.open=function(){$(this.element).addClass("wpgmza-open")},WPGMZA.PopoutPanel.prototype.close=function(){$(this.element).removeClass("wpgmza-open")}}),jQuery(function($){function sendAJAXFallbackRequest(route,params){if((params=$.extend({},params)).data||(params.data={}),"route"in params.data)throw new Error("Cannot send route through this method");if("action"in params.data)throw new Error("Cannot send action through this method");return params.data.route=route,params.data.action="wpgmza_rest_api_request",WPGMZA.restAPI.addNonce(route,params,WPGMZA.RestAPI.CONTEXT_AJAX),$.ajax(WPGMZA.ajaxurl,params)}WPGMZA.RestAPI=function(){WPGMZA.RestAPI.URL=WPGMZA.resturl,this.useAJAXFallback=!1},WPGMZA.RestAPI.CONTEXT_REST="REST",WPGMZA.RestAPI.CONTEXT_AJAX="AJAX",WPGMZA.RestAPI.createInstance=function(){return new WPGMZA.RestAPI},Object.defineProperty(WPGMZA.RestAPI.prototype,"isCompressedPathVariableSupported",{get:function(){return WPGMZA.serverCanInflate&&"Uint8Array"in window&&"TextEncoder"in window}}),Object.defineProperty(WPGMZA.RestAPI.prototype,"isCompressedPathVariableAllowed",{get:function(){return!WPGMZA.pro_version||WPGMZA.Version.compare(WPGMZA.pro_version,"8.0.0")>=WPGMZA.Version.EQUAL_TO?!WPGMZA.settings.disable_compressed_path_variables:WPGMZA.settings.enable_compressed_path_variables}}),Object.defineProperty(WPGMZA.RestAPI.prototype,"maxURLLength",{get:function(){return 2083}}),WPGMZA.RestAPI.prototype.compressParams=function(params){var suffix="";if(params.markerIDs){var markerIDs=params.markerIDs.split(",");if(1<markerIDs.length){var encoded=(new WPGMZA.EliasFano).encode(markerIDs),compressed=pako.deflate(encoded),string=Array.prototype.map.call(compressed,function(ch){return String.fromCharCode(ch)}).join("");suffix="/"+btoa(string).replace(/\//g,"-").replace(/=+$/,""),params.midcbp=encoded.pointer,delete params.markerIDs}}string=JSON.stringify(params);var input=(new TextEncoder).encode(string),raw=(compressed=pako.deflate(input),Array.prototype.map.call(compressed,function(ch){return String.fromCharCode(ch)}).join(""));return btoa(raw).replace(/\//g,"-").replace(/=+$/,"")+suffix},WPGMZA.RestAPI.prototype.getNonce=function(route){var matches=[];for(var pattern in WPGMZA.restnoncetable){var regex=new RegExp(pattern);route.match(regex)&&matches.push({pattern:pattern,nonce:WPGMZA.restnoncetable[pattern],length:pattern.length})}if(!matches.length)throw new Error("No nonce found for route");return matches.sort(function(a,b){return b.length-a.length}),matches[0].nonce},WPGMZA.RestAPI.prototype.addNonce=function(route,params,context){function setRESTNonce(xhr){context==WPGMZA.RestAPI.CONTEXT_REST&&xhr.setRequestHeader("X-WP-Nonce",WPGMZA.restnonce),params&&params.method&&!params.method.match(/^GET$/i)&&xhr.setRequestHeader("X-WPGMZA-Action-Nonce",self.getNonce(route))}var self=this;if(params.beforeSend){var base=params.beforeSend;params.beforeSend=function(xhr){base(xhr),setRESTNonce(xhr)}}else params.beforeSend=setRESTNonce},WPGMZA.RestAPI.prototype.call=function(route,params){if(this.useAJAXFallback)return sendAJAXFallbackRequest(route,params);var attemptedCompressedPathVariable=!1,fallbackRoute=route,fallbackParams=$.extend({},params);if("string"!=typeof route||!route.match(/^\//)&&!route.match(/^http/))throw new Error("Invalid route");if(WPGMZA.RestAPI.URL.match(/\/$/)&&(route=route.replace(/^\//,"")),params=params||{},this.addNonce(route,params,WPGMZA.RestAPI.CONTEXT_REST),params.error||(params.error=function(xhr,status,message){if("abort"!=status){switch(xhr.status){case 401:case 403:return $.post(WPGMZA.ajaxurl,{action:"wpgmza_report_rest_api_blocked"},function(response){}),console.warn("The REST API was blocked. This is usually due to security plugins blocking REST requests for non-authenticated users."),this.useAJAXFallback=!0,sendAJAXFallbackRequest(fallbackRoute,fallbackParams);case 414:if(!attemptedCompressedPathVariable)break;return fallbackParams.method="POST",fallbackParams.useCompressedPathVariable=!1,WPGMZA.restAPI.call(fallbackRoute,fallbackParams)}throw new Error(message)}}),params.useCompressedPathVariable&&this.isCompressedPathVariableSupported&&this.isCompressedPathVariableAllowed){var compressedParams=$.extend({},params),data=params.data,base64=this.compressParams(data);WPGMZA.isServerIIS&&(base64=encodeURIComponent(base64));var compressedRoute=route.replace(/\/$/,"")+"/base64"+base64;WPGMZA.RestAPI.URL;compressedParams.method="GET",delete compressedParams.data,!1===params.cache&&(compressedParams.data={skip_cache:1}),compressedRoute.length<this.maxURLLength?(attemptedCompressedPathVariable=!0,route=compressedRoute,params=compressedParams):(WPGMZA.RestAPI.compressedPathVariableURLLimitWarningDisplayed||console.warn("Compressed path variable route would exceed URL length limit"),WPGMZA.RestAPI.compressedPathVariableURLLimitWarningDisplayed=!0)}return WPGMZA.RestAPI.URL.match(/\?/)&&(route=route.replace(/\?/,"&")),$.ajax(WPGMZA.RestAPI.URL+route,params)};var nativeCallFunction=WPGMZA.RestAPI.call;WPGMZA.RestAPI.call=function(){console.warn("WPGMZA.RestAPI.call was called statically, did you mean to call the function on WPGMZA.restAPI?"),nativeCallFunction.apply(this,arguments)},$(document.body).on("click","#wpgmza-rest-api-blocked button.notice-dismiss",function(event){WPGMZA.restAPI.call("/rest-api/",{method:"POST",data:{dismiss_blocked_notice:!0}})})}),jQuery(function($){WPGMZA.SettingsPage=function(){$("#wpgmza-global-settings").tabs()},WPGMZA.SettingsPage.createInstance=function(){return new WPGMZA.SettingsPage},$(window).on("load",function(event){var useLegacyHTML=WPGMZA.settings.useLegacyHTML||!window.location.href.match(/no-legacy-html/);WPGMZA.getCurrentPage()!=WPGMZA.PAGE_SETTINGS||useLegacyHTML||(WPGMZA.settingsPage=WPGMZA.SettingsPage.createInstance())})}),jQuery(function($){WPGMZA.StoreLocator=function(map,element){var self=this;WPGMZA.EventDispatcher.call(this),this._center=null,this.map=map,this.element=element,this.state=WPGMZA.StoreLocator.STATE_INITIAL,$(element).find(".wpgmza-not-found-msg").hide(),this.map.on("storelocatorgeocodecomplete",function(event){self.onGeocodeComplete(event)}),this.map.on("init",function(event){self.map.markerFilter.on("filteringcomplete",function(event){self.onFilteringComplete(event)})}),$(element).on("keypress","input",function(event){13==event.which&&(searchLocations(self.map.id),self.onSearch(event))}),$(document.body).on("click",".wpgmza_sl_search_button_"+map.id+", [data-map-id='"+map.id+"'] .wpgmza_sl_search_button",function(event){self.onSearch(event)}),$(document.body).on("click",".wpgmza_sl_reset_button_"+map.id+", [data-map-id='"+map.id+"'] .wpgmza_sl_reset_button_div",function(event){self.onReset(event)})},WPGMZA.StoreLocator.prototype=Object.create(WPGMZA.EventDispatcher.prototype),WPGMZA.StoreLocator.prototype.constructor=WPGMZA.StoreLocator,WPGMZA.StoreLocator.STATE_INITIAL="initial",WPGMZA.StoreLocator.STATE_APPLIED="applied",WPGMZA.StoreLocator.createInstance=function(map,element){return new WPGMZA.StoreLocator(map,element)},Object.defineProperty(WPGMZA.StoreLocator.prototype,"distanceUnits",{get:function(){return 1==this.map.settings.store_locator_distance?WPGMZA.Distance.MILES:WPGMZA.Distance.KILOMETERS}}),Object.defineProperty(WPGMZA.StoreLocator.prototype,"radius",{get:function(){return $("#radiusSelect, #radiusSelect_"+this.map.id).val()}}),Object.defineProperty(WPGMZA.StoreLocator.prototype,"center",{get:function(){return this._center}}),Object.defineProperty(WPGMZA.StoreLocator.prototype,"bounds",{get:function(){return this._bounds}}),Object.defineProperty(WPGMZA.StoreLocator.prototype,"marker",{get:function(){if(1!=this.map.settings.store_locator_bounce)return null;if(this._marker)return this._marker;return this._marker=WPGMZA.Marker.createInstance({visible:!1}),this._marker.disableInfoWindow=!0,this._marker.isFilterable=!1,this._marker.setAnimation(WPGMZA.Marker.ANIMATION_BOUNCE),this._marker}}),Object.defineProperty(WPGMZA.StoreLocator.prototype,"circle",{get:function(){return this._circle||("modern"!=this.map.settings.wpgmza_store_locator_radius_style||WPGMZA.isDeviceiOS()?this._circle=WPGMZA.Circle.createInstance({strokeColor:"#ff0000",strokeOpacity:"0.25",strokeWeight:2,fillColor:"#ff0000",fillOpacity:"0.15",visible:!1,clickable:!1}):(this._circle=WPGMZA.ModernStoreLocatorCircle.createInstance(this.map.id),this._circle.settings.color=this.circleStrokeColor)),this._circle}}),WPGMZA.StoreLocator.prototype.onGeocodeComplete=function(event){if(!event.results||!event.results.length)return this._center=null,void(this._bounds=null);this._center=new WPGMZA.LatLng(event.results[0].latLng),this._bounds=new WPGMZA.LatLngBounds(event.results[0].bounds),this.map.markerFilter.update({},this)},WPGMZA.StoreLocator.prototype.onSearch=function(event){this.state=WPGMZA.StoreLocator.STATE_APPLIED},WPGMZA.StoreLocator.prototype.onReset=function(event){this.state=WPGMZA.StoreLocator.STATE_INITIAL,this._center=null,this._bounds=null,this.map.markerFilter.update({},this)},WPGMZA.StoreLocator.prototype.getFilteringParameters=function(){return this.center?{center:this.center,radius:this.radius}:{}},WPGMZA.StoreLocator.prototype.onFilteringComplete=function(event){var params=event.filteringParams,marker=this.marker;marker&&marker.setVisible(!1),params.center&&marker&&(marker.setPosition(params.center),marker.setVisible(!0),marker.map!=this.map&&this.map.addMarker(marker));var circle=this.circle;if(circle){var factor=this.distanceUnits==WPGMZA.Distance.MILES?WPGMZA.Distance.KILOMETERS_PER_MILE:1;circle.setVisible(!1),params.center&&params.radius&&(circle.setRadius(params.radius*factor),circle.setCenter(params.center),circle.setVisible(!0),circle.map!=this.map&&this.map.addCircle(circle)),circle instanceof WPGMZA.ModernStoreLocatorCircle&&(circle.settings.radiusString=this.radius)}this.map.hasVisibleMarkers()?$(this.element).find(".wpgmza-not-found-msg").hide():$(this.element).find(".wpgmza-not-found-msg").show()}}),jQuery(function($){WPGMZA.Text=function(options){if(options)for(var name in options)this[name]=options[name]},WPGMZA.Text.createInstance=function(options){switch(WPGMZA.settings.engine){case"open-layers":return new WPGMZA.OLText(options);default:return new WPGMZA.GoogleText(options)}}}),jQuery(function($){WPGMZA.ThemeEditor=function(){WPGMZA.EventDispatcher.call(this),this.element=$("#wpgmza-theme-editor"),this.element.length?"open-layers"!=WPGMZA.settings.engine?(this.json=[{}],this.mapElement=WPGMZA.maps[0].element,this.element.appendTo("#wpgmza-map-theme-editor__holder"),$(window).on("scroll",function(event){}),setInterval(function(){},200),this.initHTML(),WPGMZA.themeEditor=this):this.element.remove():console.warn("No element to initialise theme editor on")},WPGMZA.extend(WPGMZA.ThemeEditor,WPGMZA.EventDispatcher),WPGMZA.ThemeEditor.prototype.updatePosition=function(){},WPGMZA.ThemeEditor.features={all:[],administrative:["country","land_parcel","locality","neighborhood","province"],landscape:["man_made","natural","natural.landcover","natural.terrain"],poi:["attraction","business","government","medical","park","place_of_worship","school","sports_complex"],road:["arterial","highway","highway.controlled_access","local"],transit:["line","station","station.airport","station.bus","station.rail"],water:[]},WPGMZA.ThemeEditor.elements={all:[],geometry:["fill","stroke"],labels:["icon","text","text.fill","text.stroke"]},WPGMZA.ThemeEditor.prototype.parse=function(){$("#wpgmza_theme_editor_feature option, #wpgmza_theme_editor_element option").css("font-weight","normal"),$("#wpgmza_theme_editor_error").hide(),$("#wpgmza_theme_editor").show(),$("#wpgmza_theme_editor_do_hue").prop("checked",!1),$("#wpgmza_theme_editor_hue").val("#000000"),$("#wpgmza_theme_editor_lightness").val(""),$("#wpgmza_theme_editor_saturation").val(""),$("#wpgmza_theme_editor_gamma").val(""),$("#wpgmza_theme_editor_do_invert_lightness").prop("checked",!1),$("#wpgmza_theme_editor_visibility").val("inherit"),$("#wpgmza_theme_editor_do_color").prop("checked",!1),$("#wpgmza_theme_editor_color").val("#000000"),$("#wpgmza_theme_editor_weight").val("");var textarea=$('textarea[name="wpgmza_theme_data"]');if(!textarea.val()||textarea.val().length<1)this.json=[{}];else{try{this.json=$.parseJSON($('textarea[name="wpgmza_theme_data"]').val())}catch(e){return this.json=[{}],$("#wpgmza_theme_editor").hide(),void $("#wpgmza_theme_editor_error").show()}if(!$.isArray(this.json)){var jsonCopy=this.json;this.json=[],this.json.push(jsonCopy)}this.highlightFeatures(),this.highlightElements(),this.loadElementStylers()}},WPGMZA.ThemeEditor.prototype.highlightFeatures=function(){$("#wpgmza_theme_editor_feature option").css("font-weight","normal"),$.each(this.json,function(i,v){v.hasOwnProperty("featureType")?$('#wpgmza_theme_editor_feature option[value="'+v.featureType+'"]').css("font-weight","bold"):$('#wpgmza_theme_editor_feature option[value="all"]').css("font-weight","bold")})},WPGMZA.ThemeEditor.prototype.highlightElements=function(){var feature=$("#wpgmza_theme_editor_feature").val();$("#wpgmza_theme_editor_element option").css("font-weight","normal"),$.each(this.json,function(i,v){(v.hasOwnProperty("featureType")&&v.featureType==feature||"all"==feature&&!v.hasOwnProperty("featureType"))&&(v.hasOwnProperty("elementType")?$('#wpgmza_theme_editor_element option[value="'+v.elementType+'"]').css("font-weight","bold"):$('#wpgmza_theme_editor_element option[value="all"]').css("font-weight","bold"))})},WPGMZA.ThemeEditor.prototype.loadElementStylers=function(){var feature=$("#wpgmza_theme_editor_feature").val(),element=$("#wpgmza_theme_editor_element").val();$("#wpgmza_theme_editor_do_hue").prop("checked",!1),$("#wpgmza_theme_editor_hue").val("#000000"),$("#wpgmza_theme_editor_lightness").val(""),$("#wpgmza_theme_editor_saturation").val(""),$("#wpgmza_theme_editor_gamma").val(""),$("#wpgmza_theme_editor_do_invert_lightness").prop("checked",!1),$("#wpgmza_theme_editor_visibility").val("inherit"),$("#wpgmza_theme_editor_do_color").prop("checked",!1),$("#wpgmza_theme_editor_color").val("#000000"),$("#wpgmza_theme_editor_weight").val(""),$.each(this.json,function(i,v){(v.hasOwnProperty("featureType")&&v.featureType==feature||"all"==feature&&!v.hasOwnProperty("featureType"))&&(v.hasOwnProperty("elementType")&&v.elementType==element||"all"==element&&!v.hasOwnProperty("elementType"))&&v.hasOwnProperty("stylers")&&$.isArray(v.stylers)&&0<v.stylers.length&&$.each(v.stylers,function(ii,vv){vv.hasOwnProperty("hue")&&($("#wpgmza_theme_editor_do_hue").prop("checked",!0),$("#wpgmza_theme_editor_hue").val(vv.hue)),vv.hasOwnProperty("lightness")&&$("#wpgmza_theme_editor_lightness").val(vv.lightness),vv.hasOwnProperty("saturation")&&$("#wpgmza_theme_editor_saturation").val(vv.xaturation),vv.hasOwnProperty("gamma")&&$("#wpgmza_theme_editor_gamma").val(vv.gamma),vv.hasOwnProperty("invert_lightness")&&$("#wpgmza_theme_editor_do_invert_lightness").prop("checked",!0),vv.hasOwnProperty("visibility")&&$("#wpgmza_theme_editor_visibility").val(vv.visibility),vv.hasOwnProperty("color")&&($("#wpgmza_theme_editor_do_color").prop("checked",!0),$("#wpgmza_theme_editor_color").val(vv.color)),vv.hasOwnProperty("weight")&&$("#wpgmza_theme_editor_weight").val(vv.weight)})})},WPGMZA.ThemeEditor.prototype.writeElementStylers=function(){var feature=$("#wpgmza_theme_editor_feature").val(),element=$("#wpgmza_theme_editor_element").val(),indexJSON=null,stylers=[];if("inherit"!=$("#wpgmza_theme_editor_visibility").val()&&stylers.push({visibility:$("#wpgmza_theme_editor_visibility").val()}),!0===$("#wpgmza_theme_editor_do_color").prop("checked")&&stylers.push({color:$("#wpgmza_theme_editor_color").val()}),!0===$("#wpgmza_theme_editor_do_hue").prop("checked")&&stylers.push({hue:$("#wpgmza_theme_editor_hue").val()}),0<$("#wpgmza_theme_editor_gamma").val().length&&stylers.push({gamma:parseFloat($("#wpgmza_theme_editor_gamma").val())}),0<$("#wpgmza_theme_editor_weight").val().length&&stylers.push({weight:parseFloat($("#wpgmza_theme_editor_weight").val())}),0<$("#wpgmza_theme_editor_saturation").val().length&&stylers.push({saturation:parseFloat($("#wpgmza_theme_editor_saturation").val())}),0<$("#wpgmza_theme_editor_lightness").val().length&&stylers.push({lightness:parseFloat($("#wpgmza_theme_editor_lightness").val())}),!0===$("#wpgmza_theme_editor_do_invert_lightness").prop("checked")&&stylers.push({invert_lightness:!0}),$.each(this.json,function(i,v){(v.hasOwnProperty("featureType")&&v.featureType==feature||"all"==feature&&!v.hasOwnProperty("featureType"))&&(v.hasOwnProperty("elementType")&&v.elementType==element||"all"==element&&!v.hasOwnProperty("elementType"))&&(indexJSON=i)}),null===indexJSON){if(0<stylers.length){var new_feature_element_stylers={};"all"!=feature&&(new_feature_element_stylers.featureType=feature),"all"!=element&&(new_feature_element_stylers.elementType=element),new_feature_element_stylers.stylers=stylers,this.json.push(new_feature_element_stylers)}}else 0<stylers.length?this.json[indexJSON].stylers=stylers:this.json.splice(indexJSON,1);$('textarea[name="wpgmza_theme_data"]').val(JSON.stringify(this.json).replace(/:/g,": ").replace(/,/g,", ")),this.highlightFeatures(),this.highlightElements(),WPGMZA.themePanel.updateMapTheme()},WPGMZA.ThemeEditor.prototype.initHTML=function(){var self=this;$.each(WPGMZA.ThemeEditor.features,function(i,v){$("#wpgmza_theme_editor_feature").append('<option value="'+i+'">'+i+"</option>"),0<v.length&&$.each(v,function(ii,vv){$("#wpgmza_theme_editor_feature").append('<option value="'+i+"."+vv+'">'+i+"."+vv+"</option>")})}),$.each(WPGMZA.ThemeEditor.elements,function(i,v){$("#wpgmza_theme_editor_element").append('<option value="'+i+'">'+i+"</option>"),0<v.length&&$.each(v,function(ii,vv){$("#wpgmza_theme_editor_element").append('<option value="'+i+"."+vv+'">'+i+"."+vv+"</option>")})}),this.parse(),$('textarea[name="wpgmza_theme_data"]').on("input selectionchange propertychange",function(){self.parse()}),$(".wpgmza_theme_selection").click(function(){setTimeout(function(){$('textarea[name="wpgmza_theme_data"]').trigger("input")},1e3)}),$("#wpgmza_theme_editor_feature").on("change",function(){self.highlightElements(),self.loadElementStylers()}),$("#wpgmza_theme_editor_element").on("change",function(){self.loadElementStylers()}),$("#wpgmza_theme_editor_do_hue, #wpgmza_theme_editor_hue, #wpgmza_theme_editor_lightness, #wpgmza_theme_editor_saturation, #wpgmza_theme_editor_gamma, #wpgmza_theme_editor_do_invert_lightness, #wpgmza_theme_editor_visibility, #wpgmza_theme_editor_do_color, #wpgmza_theme_editor_color, #wpgmza_theme_editor_weight").on("input selectionchange propertychange",function(){self.writeElementStylers()}),"open-layers"==WPGMZA.settings.engine&&$("#wpgmza_theme_editor :input").prop("disabled",!0)}}),jQuery(function($){WPGMZA.ThemePanel=function(){var self=this;this.element=$("#wpgmza-theme-panel"),this.map=WPGMZA.maps[0],this.element.length?($("#wpgmza-theme-presets").owlCarousel({items:5,dots:!0}),this.element.on("click","#wpgmza-theme-presets label",function(event){self.onThemePresetClick(event)}),$("#wpgmza-open-theme-editor").on("click",function(event){$("#wpgmza-map-theme-editor__holder").addClass("active"),$("#wpgmza-theme-editor").addClass("active"),WPGMZA.animateScroll($("#wpgmza-theme-editor"))}),WPGMZA.themePanel=this):console.warn("No element to initialise theme panel on")},WPGMZA.ThemePanel.previewImageCenter={lat:33.701806462148646,lng:-118.15949896058983},WPGMZA.ThemePanel.previewImageZoom=11,WPGMZA.ThemePanel.prototype.onThemePresetClick=function(event){var selectedData=$(event.currentTarget).find("[data-theme-json]").attr("data-theme-json"),textarea=$(this.element).find("textarea[name='wpgmza_theme_data']"),existingData=textarea.val(),allPresetData=[];$(this.element).find("[data-theme-json]").each(function(index,el){allPresetData.push($(el).attr("data-theme-json"))}),existingData.length&&-1==allPresetData.indexOf(existingData)&&!confirm(WPGMZA.localized_strings.overwrite_theme_data)||(textarea.val(selectedData),this.updateMapTheme(),WPGMZA.themeEditor.parse())},WPGMZA.ThemePanel.prototype.updateMapTheme=function(){var data;try{data=JSON.parse($("textarea[name='wpgmza_theme_data']").val())}catch(e){return void alert(WPGMZA.localized_strings.invalid_theme_data)}this.map.setOptions({styles:data})}}),jQuery(function($){WPGMZA.Version=function(){},WPGMZA.Version.GREATER_THAN=1,WPGMZA.Version.EQUAL_TO=0,WPGMZA.Version.LESS_THAN=-1,WPGMZA.Version.compare=function(v1,v2){for(var v1parts=v1.match(/\d+/g),v2parts=v2.match(/\d+/g),i=0;i<v1parts.length;++i){if(v2parts.length===i)return 1;if(v1parts[i]!==v2parts[i])return v1parts[i]>v2parts[i]?1:-1}return v1parts.length!=v2parts.length?-1:0}}),jQuery(function($){WPGMZA.Integration={},WPGMZA.integrationModules={}}),jQuery(function($){if(window.wp&&wp.i18n&&wp.blocks&&wp.editor&&wp.components){var __=wp.i18n.__,registerBlockType=wp.blocks.registerBlockType,_wp$editor=wp.editor,InspectorControls=_wp$editor.InspectorControls,_wp$components=(_wp$editor.BlockControls,wp.components),Dashicon=_wp$components.Dashicon,PanelBody=(_wp$components.Toolbar,_wp$components.Button,_wp$components.Tooltip,_wp$components.PanelBody);_wp$components.TextareaControl,_wp$components.CheckboxControl,_wp$components.TextControl,_wp$components.SelectControl,_wp$components.RichText;WPGMZA.Integration.Gutenberg=function(){registerBlockType("gutenberg-wpgmza/block",this.getBlockDefinition())},WPGMZA.Integration.Gutenberg.prototype.getBlockTitle=function(){return __("WP Google Maps")},WPGMZA.Integration.Gutenberg.prototype.getBlockInspectorControls=function(props){return React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:__("Map Settings")},React.createElement("p",{class:"map-block-gutenberg-button-container"},React.createElement("a",{href:WPGMZA.adminurl+"admin.php?page=wp-google-maps-menu&action=edit&map_id=1",target:"_blank",class:"button button-primary"},React.createElement("i",{class:"fa fa-pencil-square-o","aria-hidden":"true"}),__("Go to Map Editor"))),React.createElement("p",{class:"map-block-gutenberg-button-container"},React.createElement("a",{href:"https://www.wpgmaps.com/documentation/creating-your-first-map/",target:"_blank",class:"button button-primary"},React.createElement("i",{class:"fa fa-book","aria-hidden":"true"}),__("View Documentation")))))},WPGMZA.Integration.Gutenberg.prototype.getBlockAttributes=function(){return{}},WPGMZA.Integration.Gutenberg.prototype.getBlockDefinition=function(props){var _this=this;return{title:__("WP Google Maps"),description:__("The easiest to use Google Maps plugin! Create custom Google Maps with high quality markers containing locations, descriptions, images and links. Add your customized map to your WordPress posts and/or pages quickly and easily with the supplied shortcode. No fuss."),category:"common",icon:"location-alt",keywords:[__("Map"),__("Maps"),__("Google")],attributes:this.getBlockAttributes(),edit:function(props){return[!!props.isSelected&&_this.getBlockInspectorControls(props),React.createElement("div",{className:props.className+" wpgmza-gutenberg-block"},React.createElement(Dashicon,{icon:"location-alt"}),React.createElement("span",{class:"wpgmza-gutenberg-block-title"},__("Your map will appear here on your websites front end")))]},save:function(){return null}}},WPGMZA.Integration.Gutenberg.getConstructor=function(){return WPGMZA.Integration.Gutenberg},WPGMZA.Integration.Gutenberg.createInstance=function(){return new(WPGMZA.Integration.Gutenberg.getConstructor())},WPGMZA.isProVersion()||/^6/.test(WPGMZA.pro_version)||(WPGMZA.integrationModules.gutenberg=WPGMZA.Integration.Gutenberg.createInstance())}}),jQuery(function($){$(window).on("load",function(event){var parent=document.body.onclick;parent&&(document.body.onclick=function(event){event.target instanceof WPGMZA.Marker||parent(event)})})}),jQuery(function($){WPGMZA.GoogleUICompatibility=function(){if(!(navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"))){var style=$("<style id='wpgmza-google-ui-compatiblity-fix'/>");style.html(".wpgmza_map img:not(button img) { padding:0 !important; }"),$(document.head).append(style)}},WPGMZA.googleUICompatibility=new WPGMZA.GoogleUICompatibility}),jQuery(function($){WPGMZA.GoogleCircle=function(options,googleCircle){var self=this;WPGMZA.Circle.call(this,options,googleCircle),googleCircle?this.googleCircle=googleCircle:(this.googleCircle=new google.maps.Circle,this.googleCircle.wpgmzaCircle=this),google.maps.event.addListener(this.googleCircle,"click",function(){self.dispatchEvent({type:"click"})}),options&&this.setOptions(options)},WPGMZA.GoogleCircle.prototype=Object.create(WPGMZA.Circle.prototype),WPGMZA.GoogleCircle.prototype.constructor=WPGMZA.GoogleCircle,WPGMZA.GoogleCircle.prototype.setCenter=function(center){WPGMZA.Circle.prototype.setCenter.apply(this,arguments),this.googleCircle.setCenter(center)},WPGMZA.GoogleCircle.prototype.setRadius=function(radius){WPGMZA.Circle.prototype.setRadius.apply(this,arguments),this.googleCircle.setRadius(1e3*parseFloat(radius))},WPGMZA.GoogleCircle.prototype.setVisible=function(visible){this.googleCircle.setVisible(!!visible)},WPGMZA.GoogleCircle.prototype.setOptions=function(options){var googleOptions={};delete(googleOptions=$.extend({},options)).map,delete googleOptions.center,options.center&&(googleOptions.center=new google.maps.LatLng({lat:parseFloat(options.center.lat),lng:parseFloat(options.center.lng)})),options.radius&&(googleOptions.radius=parseFloat(options.radius)),options.color&&(googleOptions.fillColor=options.color),options.opacity&&(googleOptions.fillOpacity=parseFloat(options.opacity),googleOptions.strokeOpacity=parseFloat(options.opacity)),this.googleCircle.setOptions(googleOptions),options.map&&options.map.addCircle(this)}}),jQuery(function($){WPGMZA.GoogleGeocoder=function(){},WPGMZA.GoogleGeocoder.prototype=Object.create(WPGMZA.Geocoder.prototype),WPGMZA.GoogleGeocoder.prototype.constructor=WPGMZA.GoogleGeocoder,WPGMZA.GoogleGeocoder.prototype.getLatLngFromAddress=function(options,callback){if(!options||!options.address)throw new Error("No address specified");if(WPGMZA.isLatLngString(options.address))return WPGMZA.Geocoder.prototype.getLatLngFromAddress.call(this,options,callback);options.country&&(options.componentRestrictions={country:options.country}),(new google.maps.Geocoder).geocode(options,function(results,status){if(status==google.maps.GeocoderStatus.OK){var location=results[0].geometry.location,latLng={lat:location.lat(),lng:location.lng()},bounds=null;results[0].geometry.bounds&&(bounds=WPGMZA.LatLngBounds.fromGoogleLatLngBounds(results[0].geometry.bounds)),callback(results=[{geometry:{location:latLng},latLng:latLng,lat:latLng.lat,lng:latLng.lng,bounds:bounds}],WPGMZA.Geocoder.SUCCESS)}else{var nativeStatus=WPGMZA.Geocoder.FAIL;status==google.maps.GeocoderStatus.ZERO_RESULTS&&(nativeStatus=WPGMZA.Geocoder.ZERO_RESULTS),callback(null,nativeStatus)}})},WPGMZA.GoogleGeocoder.prototype.getAddressFromLatLng=function(options,callback){if(!options||!options.latLng)throw new Error("No latLng specified");var latLng=new WPGMZA.LatLng(options.latLng),geocoder=new google.maps.Geocoder;delete(options=$.extend(options,{location:{lat:latLng.lat,lng:latLng.lng}})).latLng,geocoder.geocode(options,function(results,status){"OK"!==status&&callback(null,WPGMZA.Geocoder.FAIL),results&&results.length||callback([],WPGMZA.Geocoder.NO_RESULTS),callback([results[0].formatted_address],WPGMZA.Geocoder.SUCCESS)})}}),jQuery(function($){WPGMZA.settings.engine&&"google-maps"!=WPGMZA.settings.engine||window.google&&window.google.maps&&(WPGMZA.GoogleHTMLOverlay=function(map){this.element=$("<div class='wpgmza-google-html-overlay'></div>"),this.visible=!0,this.position=new WPGMZA.LatLng,this.setMap(map.googleMap),this.wpgmzaMap=map},WPGMZA.GoogleHTMLOverlay.prototype=new google.maps.OverlayView,WPGMZA.GoogleHTMLOverlay.prototype.onAdd=function(){this.getPanes().overlayMouseTarget.appendChild(this.element[0])},WPGMZA.GoogleHTMLOverlay.prototype.onRemove=function(){this.element&&$(this.element).parent().length&&($(this.element).remove(),this.element=null)},WPGMZA.GoogleHTMLOverlay.prototype.draw=function(){this.updateElementPosition()},WPGMZA.GoogleHTMLOverlay.prototype.updateElementPosition=function(){var projection=this.getProjection();if(projection){var pixels=projection.fromLatLngToDivPixel(this.position.toGoogleLatLng());$(this.element).css({left:pixels.x,top:pixels.y})}})}),jQuery(function($){WPGMZA.GoogleModernStoreLocatorCircle=function(map,settings){var self=this;WPGMZA.ModernStoreLocatorCircle.call(this,map,settings),this.intervalID=setInterval(function(){var mapSize={width:$(self.mapElement).width(),height:$(self.mapElement).height()};mapSize.width==self.mapSize.width&&mapSize.height==self.mapSize.height||(self.canvasLayer.resize_(),self.canvasLayer.draw(),self.mapSize=mapSize)},1e3),$(document).bind("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){self.canvasLayer.resize_(),self.canvasLayer.draw()})},WPGMZA.GoogleModernStoreLocatorCircle.prototype=Object.create(WPGMZA.ModernStoreLocatorCircle.prototype),WPGMZA.GoogleModernStoreLocatorCircle.prototype.constructor=WPGMZA.GoogleModernStoreLocatorCircle,WPGMZA.GoogleModernStoreLocatorCircle.prototype.initCanvasLayer=function(){var self=this;this.canvasLayer&&(this.canvasLayer.setMap(null),this.canvasLayer.setAnimate(!1)),this.canvasLayer=new CanvasLayer({map:this.map.googleMap,resizeHandler:function(event){self.onResize(event)},updateHandler:function(event){self.onUpdate(event)},animate:!0,resolutionScale:this.getResolutionScale()})},WPGMZA.GoogleModernStoreLocatorCircle.prototype.setOptions=function(options){WPGMZA.ModernStoreLocatorCircle.prototype.setOptions.call(this,options),this.canvasLayer.scheduleUpdate()},WPGMZA.GoogleModernStoreLocatorCircle.prototype.setPosition=function(position){WPGMZA.ModernStoreLocatorCircle.prototype.setPosition.call(this,position),this.canvasLayer.scheduleUpdate()},WPGMZA.GoogleModernStoreLocatorCircle.prototype.setRadius=function(radius){WPGMZA.ModernStoreLocatorCircle.prototype.setRadius.call(this,radius),this.canvasLayer.scheduleUpdate()},WPGMZA.GoogleModernStoreLocatorCircle.prototype.getTransformedRadius=function(km){var spherical=google.maps.geometry.spherical,center=this.settings.center,equator=new WPGMZA.LatLng({lat:0,lng:0}),latitude=new WPGMZA.LatLng({lat:center.lat,lng:0}),offsetAtEquator=spherical.computeOffset(equator.toGoogleLatLng(),1e3*km,90),result=.006395*km*(spherical.computeOffset(latitude.toGoogleLatLng(),1e3*km,90).lng()/offsetAtEquator.lng());if(isNaN(result))throw new Error("here");return result},WPGMZA.GoogleModernStoreLocatorCircle.prototype.getCanvasDimensions=function(){return{width:this.canvasLayer.canvas.width,height:this.canvasLayer.canvas.height}},WPGMZA.GoogleModernStoreLocatorCircle.prototype.getWorldOriginOffset=function(){var position=this.map.googleMap.getProjection().fromLatLngToPoint(this.canvasLayer.getTopLeft());return{x:-position.x,y:-position.y}},WPGMZA.GoogleModernStoreLocatorCircle.prototype.getCenterPixels=function(){var center=new WPGMZA.LatLng(this.settings.center);return this.map.googleMap.getProjection().fromLatLngToPoint(center.toGoogleLatLng())},WPGMZA.GoogleModernStoreLocatorCircle.prototype.getContext=function(type){return this.canvasLayer.canvas.getContext("2d")},WPGMZA.GoogleModernStoreLocatorCircle.prototype.getScale=function(){return Math.pow(2,this.map.getZoom())*this.getResolutionScale()},WPGMZA.GoogleModernStoreLocatorCircle.prototype.setVisible=function(visible){WPGMZA.ModernStoreLocatorCircle.prototype.setVisible.call(this,visible),this.canvasLayer.scheduleUpdate()},WPGMZA.GoogleModernStoreLocatorCircle.prototype.destroy=function(){this.canvasLayer.setMap(null),this.canvasLayer=null,clearInterval(this.intervalID)}}),jQuery(function($){WPGMZA.GooglePolyline=function(options,googlePolyline){var self=this;if(WPGMZA.Polyline.call(this,options,googlePolyline),googlePolyline)this.googlePolyline=googlePolyline;else{if(this.googlePolyline=new google.maps.Polyline(this.settings),options){var googleOptions=$.extend({},options);options.polydata&&(googleOptions.path=this.parseGeometry(options.polydata)),options.linecolor&&(googleOptions.strokeColor="#"+options.linecolor),options.linethickness&&(googleOptions.strokeWeight=parseInt(options.linethickness)),options.opacity&&(googleOptions.strokeOpacity=parseFloat(options.opacity))}if(options&&options.polydata){var path=this.parseGeometry(options.polydata);this.setPoints(path)}}this.googlePolyline.wpgmzaPolyline=this,google.maps.event.addListener(this.googlePolyline,"click",function(){self.dispatchEvent({type:"click"})})},WPGMZA.GooglePolyline.prototype=Object.create(WPGMZA.Polyline.prototype),WPGMZA.GooglePolyline.prototype.constructor=WPGMZA.GooglePolyline,WPGMZA.GooglePolyline.prototype.setEditable=function(value){this.googlePolyline.setOptions({editable:value})},WPGMZA.GooglePolyline.prototype.setPoints=function(points){this.googlePolyline.setOptions({path:points})},WPGMZA.GooglePolyline.prototype.toJSON=function(){var result=WPGMZA.Polyline.prototype.toJSON.call(this);result.points=[];for(var path=this.googlePolyline.getPath(),i=0;i<path.getLength();i++){var latLng=path.getAt(i);result.points.push({lat:latLng.lat(),lng:latLng.lng()})}return result}}),jQuery(function($){WPGMZA.GoogleText=function(options){WPGMZA.Text.apply(this,arguments),this.overlay=new WPGMZA.GoogleTextOverlay(options)},WPGMZA.extend(WPGMZA.GoogleText,WPGMZA.Text)}),jQuery(function($){WPGMZA.GoogleTextOverlay=function(options){this.element=$("<div class='wpgmza-google-text-overlay'><div class='wpgmza-inner'></div></div>"),(options=options||{}).position&&(this.position=options.position),options.text&&this.element.find(".wpgmza-inner").text(options.text),options.map&&this.setMap(options.map.googleMap)},window.google&&google.maps&&google.maps.OverlayView&&(WPGMZA.GoogleTextOverlay.prototype=new google.maps.OverlayView),WPGMZA.GoogleTextOverlay.prototype.onAdd=function(){var position=this.getProjection().fromLatLngToDivPixel(this.position.toGoogleLatLng());this.element.css({position:"absolute",left:position.x+"px",top:position.y+"px"}),this.getPanes().floatPane.appendChild(this.element[0])},WPGMZA.GoogleTextOverlay.prototype.draw=function(){var position=this.getProjection().fromLatLngToDivPixel(this.position.toGoogleLatLng());this.element.css({position:"absolute",left:position.x+"px",top:position.y+"px"})},WPGMZA.GoogleTextOverlay.prototype.onRemove=function(){this.element.remove()},WPGMZA.GoogleTextOverlay.prototype.hide=function(){this.element.hide()},WPGMZA.GoogleTextOverlay.prototype.show=function(){this.element.show()},WPGMZA.GoogleTextOverlay.prototype.toggle=function(){this.element.is(":visible")?this.element.hide():this.element.show()}}),jQuery(function($){"google-maps"==WPGMZA.settings.engine&&(WPGMZA.googleAPIStatus&&"USER_CONSENT_NOT_GIVEN"==WPGMZA.googleAPIStatus.code||(WPGMZA.GoogleVertexContextMenu=function(mapEditPage){var self=this;this.mapEditPage=mapEditPage,this.element=document.createElement("div"),this.element.className="wpgmza-vertex-context-menu",this.element.innerHTML="Delete",google.maps.event.addDomListener(this.element,"click",function(event){return self.removeVertex(),event.preventDefault(),event.stopPropagation(),!1})},WPGMZA.GoogleVertexContextMenu.prototype=new google.maps.OverlayView,WPGMZA.GoogleVertexContextMenu.prototype.onAdd=function(){var self=this,map=this.getMap();this.getPanes().floatPane.appendChild(this.element),this.divListener=google.maps.event.addDomListener(map.getDiv(),"mousedown",function(e){e.target!=self.element&&self.close()},!0)},WPGMZA.GoogleVertexContextMenu.prototype.onRemove=function(){google.maps.event.removeListener(this.divListener),this.element.parentNode.removeChild(this.element),this.set("position"),this.set("path"),this.set("vertex")},WPGMZA.GoogleVertexContextMenu.prototype.open=function(map,path,vertex){this.set("position",path.getAt(vertex)),this.set("path",path),this.set("vertex",vertex),this.setMap(map),this.draw()},WPGMZA.GoogleVertexContextMenu.prototype.close=function(){this.setMap(null)},WPGMZA.GoogleVertexContextMenu.prototype.draw=function(){var position=this.get("position"),projection=this.getProjection();if(position&&projection){var point=projection.fromLatLngToDivPixel(position);this.element.style.top=point.y+"px",this.element.style.left=point.x+"px"}},WPGMZA.GoogleVertexContextMenu.prototype.removeVertex=function(){var path=this.get("path"),vertex=this.get("vertex");path&&null!=vertex&&path.removeAt(vertex),this.close()}))}),jQuery(function($){var Parent=WPGMZA.Circle;WPGMZA.OLCircle=function(options,olFeature){this.center={lat:0,lng:0},this.radius=0,this.fillcolor="#ff0000",this.opacity=.6,Parent.call(this,options,olFeature),this.olStyle=new ol.style.Style(this.getStyleFromSettings()),this.vectorLayer3857=this.layer=new ol.layer.Vector({source:new ol.source.Vector,style:this.olStyle}),olFeature?this.olFeature=olFeature:this.recreate()},WPGMZA.OLCircle.prototype=Object.create(Parent.prototype),WPGMZA.OLCircle.prototype.constructor=WPGMZA.OLCircle,WPGMZA.OLCircle.prototype.recreate=function(){if(this.olFeature&&(this.layer.getSource().removeFeature(this.olFeature),delete this.olFeature),this.center&&this.radius){var x,y,radius=1e3*parseFloat(this.radius)/2;x=this.center.lng,y=this.center.lat;var circle3857=ol.geom.Polygon.circular([x,y],radius,64).clone().transform("EPSG:4326","EPSG:3857");this.olFeature=new ol.Feature(circle3857),this.layer.getSource().addFeature(this.olFeature)}},WPGMZA.OLCircle.prototype.getStyleFromSettings=function(){var params={};return this.opacity&&(params.fill=new ol.style.Fill({color:WPGMZA.hexOpacityToRGBA(this.fillColor,this.opacity)})),params},WPGMZA.OLCircle.prototype.updateStyleFromSettings=function(){var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.layer.setStyle(this.olStyle)},WPGMZA.OLCircle.prototype.setVisible=function(visible){this.layer.setVisible(!!visible)},WPGMZA.OLCircle.prototype.setCenter=function(center){WPGMZA.Circle.prototype.setCenter.apply(this,arguments),this.recreate()},WPGMZA.OLCircle.prototype.setRadius=function(radius){WPGMZA.Circle.prototype.setRadius.apply(this,arguments),this.recreate()}}),jQuery(function($){WPGMZA.OLGeocoder=function(){},WPGMZA.OLGeocoder.prototype=Object.create(WPGMZA.Geocoder.prototype),WPGMZA.OLGeocoder.prototype.constructor=WPGMZA.OLGeocoder,WPGMZA.OLGeocoder.prototype.getResponseFromCache=function(query,callback){WPGMZA.restAPI.call("/geocode-cache",{data:{query:JSON.stringify(query)},success:function(response,xhr,status){response.lng=response.lon,callback(response)},useCompressedPathVariable:!0})},WPGMZA.OLGeocoder.prototype.getResponseFromNominatim=function(options,callback){var data={q:options.address,format:"json"};options.componentRestrictions&&options.componentRestrictions.country&&(data.countrycodes=options.componentRestrictions.country),$.ajax("https://nominatim.openstreetmap.org/search/",{data:data,success:function(response,xhr,status){callback(response)},error:function(response,xhr,status){callback(null,WPGMZA.Geocoder.FAIL)}})},WPGMZA.OLGeocoder.prototype.cacheResponse=function(query,response){$.ajax(WPGMZA.ajaxurl,{data:{action:"wpgmza_store_nominatim_cache",query:JSON.stringify(query),response:JSON.stringify(response)},method:"POST"})},WPGMZA.OLGeocoder.prototype.clearCache=function(callback){$.ajax(WPGMZA.ajaxurl,{data:{action:"wpgmza_clear_nominatim_cache"},method:"POST",success:function(response){callback(response)}})},WPGMZA.OLGeocoder.prototype.getLatLngFromAddress=function(options,callback){return WPGMZA.OLGeocoder.prototype.geocode(options,callback)},WPGMZA.OLGeocoder.prototype.getAddressFromLatLng=function(options,callback){return WPGMZA.OLGeocoder.prototype.geocode(options,callback)},WPGMZA.OLGeocoder.prototype.geocode=function(options,callback){var self=this;if(!options)throw new Error("Invalid options");if(WPGMZA.LatLng.REGEXP.test(options.address)){var latLng=WPGMZA.LatLng.fromString(options.address);callback([{geometry:{location:latLng},latLng:latLng,lat:latLng.lat,lng:latLng.lng}],WPGMZA.Geocoder.SUCCESS)}else{var finish,location;if(options.location&&(options.latLng=new WPGMZA.LatLng(options.location)),options.address)location=options.address,finish=function(response,status){for(var i=0;i<response.length;i++)response[i].geometry={location:new WPGMZA.LatLng({lat:parseFloat(response[i].lat),lng:parseFloat(response[i].lon)})},response[i].latLng={lat:parseFloat(response[i].lat),lng:parseFloat(response[i].lon)},response[i].bounds=new WPGMZA.LatLngBounds(new WPGMZA.LatLng({lat:response[i].boundingbox[1],lng:response[i].boundingbox[2]}),new WPGMZA.LatLng({lat:response[i].boundingbox[0],lng:response[i].boundingbox[3]})),response[i].lng=response[i].lon;callback(response,status)};else{if(!options.latLng)throw new Error("You must supply either a latLng or address");location=options.latLng.toString(),finish=function(response,status){var address=response[0].display_name;callback([address],status)}}var query={location:location,options:options};this.getResponseFromCache(query,function(response){response.length?finish(response,WPGMZA.Geocoder.SUCCESS):self.getResponseFromNominatim($.extend(options,{address:location}),function(response,status){status!=WPGMZA.Geocoder.FAIL?0!=response.length?(finish(response,WPGMZA.Geocoder.SUCCESS),self.cacheResponse(query,response)):callback([],WPGMZA.Geocoder.ZERO_RESULTS):callback(null,WPGMZA.Geocoder.FAIL)})})}}}),jQuery(function($){WPGMZA.OLModernStoreLocatorCircle=function(map,settings){WPGMZA.ModernStoreLocatorCircle.call(this,map,settings)},WPGMZA.OLModernStoreLocatorCircle.prototype=Object.create(WPGMZA.ModernStoreLocatorCircle.prototype),WPGMZA.OLModernStoreLocatorCircle.prototype.constructor=WPGMZA.OLModernStoreLocatorCircle,WPGMZA.OLModernStoreLocatorCircle.prototype.initCanvasLayer=function(){var self=this,mapElement=$(this.map.element),olViewportElement=mapElement.children(".ol-viewport");this.canvas=document.createElement("canvas"),this.canvas.className="wpgmza-ol-canvas-overlay",mapElement.append(this.canvas),this.renderFunction=function(event){self.canvas.width==olViewportElement.width()&&self.canvas.height==olViewportElement.height()||(self.canvas.width=olViewportElement.width(),self.canvas.height=olViewportElement.height(),$(this.canvas).css({width:olViewportElement.width()+"px",height:olViewportElement.height()+"px"})),self.draw()},this.map.olMap.on("postrender",this.renderFunction)},WPGMZA.OLModernStoreLocatorCircle.prototype.getContext=function(type){return this.canvas.getContext(type)},WPGMZA.OLModernStoreLocatorCircle.prototype.getCanvasDimensions=function(){return{width:this.canvas.width,height:this.canvas.height}},WPGMZA.OLModernStoreLocatorCircle.prototype.getCenterPixels=function(){return this.map.latLngToPixels(this.settings.center)},WPGMZA.OLModernStoreLocatorCircle.prototype.getWorldOriginOffset=function(){return{x:0,y:0}},WPGMZA.OLModernStoreLocatorCircle.prototype.getTransformedRadius=function(km){var center=new WPGMZA.LatLng(this.settings.center),outer=new WPGMZA.LatLng(center);outer.moveByDistance(km,90);var centerPixels=this.map.latLngToPixels(center),outerPixels=this.map.latLngToPixels(outer);return Math.abs(outerPixels.x-centerPixels.x)},WPGMZA.OLModernStoreLocatorCircle.prototype.getScale=function(){return 1},WPGMZA.OLModernStoreLocatorCircle.prototype.destroy=function(){$(this.canvas).remove(),this.map.olMap.un("postrender",this.renderFunction),this.map=null,this.canvas=null}}),jQuery(function($){var Parent;WPGMZA.OLPolyline=function(options,olFeature){if(WPGMZA.Polyline.call(this,options),this.olStyle=new ol.style.Style,olFeature)this.olFeature=olFeature;else{var coordinates=[];if(options&&(options.polydata||options.points)){var path;path=options.polydata?this.parseGeometry(options.polydata):options.points;for(var i=0;i<path.length;i++){if(!$.isNumeric(path[i].lat))throw new Error("Invalid latitude");if(!$.isNumeric(path[i].lng))throw new Error("Invalid longitude");coordinates.push(ol.proj.fromLonLat([parseFloat(path[i].lng),parseFloat(path[i].lat)]))}}var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.olFeature=new ol.Feature({geometry:new ol.geom.LineString(coordinates)})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:[this.olFeature]}),style:this.olStyle}),this.layer.getSource().getFeatures()[0].setProperties({wpgmzaPolyline:this})},Parent=WPGMZA.Polyline,WPGMZA.OLPolyline.prototype=Object.create(Parent.prototype),WPGMZA.OLPolyline.prototype.constructor=WPGMZA.OLPolyline,WPGMZA.OLPolyline.prototype.getStyleFromSettings=function(){var params={};return this.settings.strokeOpacity&&(params.stroke=new ol.style.Stroke({color:WPGMZA.hexOpacityToRGBA(this.settings.strokeColor,this.settings.strokeOpacity),width:parseInt(this.settings.strokeWeight)})),params},WPGMZA.OLPolyline.prototype.updateStyleFromSettings=function(){var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.layer.setStyle(this.olStyle)},WPGMZA.OLPolyline.prototype.setEditable=function(editable){},WPGMZA.OLPolyline.prototype.setPoints=function(points){this.olFeature&&this.layer.getSource().removeFeature(this.olFeature);for(var coordinates=[],i=0;i<points.length;i++)coordinates.push(ol.proj.fromLonLat([parseFloat(points[i].lng),parseFloat(points[i].lat)]));this.olFeature=new ol.Feature({geometry:new ol.geom.LineString(coordinates)}),this.layer.getSource().addFeature(this.olFeature)},WPGMZA.OLPolyline.prototype.toJSON=function(){var result=Parent.prototype.toJSON.call(this),coordinates=this.olFeature.getGeometry().getCoordinates();result.points=[];for(var i=0;i<coordinates.length;i++){var lonLat=ol.proj.toLonLat(coordinates[i]),latLng={lat:lonLat[1],lng:lonLat[0]};result.points.push(latLng)}return result}}),jQuery(function($){WPGMZA.OLText=function(){}}),jQuery(function($){WPGMZA.DataTable=function(element){var self=this;if(!$.fn.dataTable)return console.warn("The dataTables library is not loaded. Cannot create a dataTable. Did you enable 'Do not enqueue dataTables'?"),void(WPGMZA.settings.wpgmza_do_not_enqueue_datatables&&WPGMZA.getCurrentPage()==WPGMZA.PAGE_MAP_EDIT&&alert("You have selected 'Do not enqueue DataTables' in WP Google Maps' settings. No 3rd party software is loading the DataTables library. Because of this, the marker table cannot load. Please uncheck this option to use the marker table."));if($.fn.dataTable.ext)$.fn.dataTable.ext.errMode="throw";else{var version=$.fn.dataTable.version?$.fn.dataTable.version:"unknown";console.warn("You appear to be running an outdated or modified version of the dataTables library. This may cause issues with table functionality. This is usually caused by 3rd party software loading an older version of DataTables. The loaded version is "+version+", we recommend version 1.10.12 or above.")}this.element=element,(this.element.wpgmzaDataTable=this).dataTableElement=this.getDataTableElement();var settings=this.getDataTableSettings();this.phpClass=$(element).attr("data-wpgmza-php-class"),(this.wpgmzaDataTable=this).useCompressedPathVariable=WPGMZA.restAPI.isCompressedPathVariableSupported&&WPGMZA.settings.enable_compressed_path_variables,this.method=this.useCompressedPathVariable?"GET":"POST",null==this.getLanguageURL()||"//cdn.datatables.net/plug-ins/1.10.12/i18n/English.json"==this.getLanguageURL()?(this.dataTable=$(this.dataTableElement).DataTable(settings),this.dataTable.ajax.reload()):$.ajax(this.getLanguageURL(),{success:function(response,status,xhr){self.languageJSON=response,self.dataTable=$(self.dataTableElement).DataTable(settings),self.dataTable.ajax.reload()}})},WPGMZA.DataTable.prototype.getDataTableElement=function(){return $(this.element).find("table")},WPGMZA.DataTable.prototype.onAJAXRequest=function(data,settings){var params={phpClass:this.phpClass},attr=$(this.element).attr("data-wpgmza-ajax-parameters");return attr&&$.extend(params,JSON.parse(attr)),$.extend(data,params)},WPGMZA.DataTable.prototype.onDataTableAjaxRequest=function(data,callback,settings){var self=this,element=this.element,route=$(element).attr("data-wpgmza-rest-api-route"),params=this.onAJAXRequest(data,settings),draw=params.draw;if(delete params.draw,!route)throw new Error("No data-wpgmza-rest-api-route attribute specified");var options={method:"POST",useCompressedPathVariable:!0,data:params,dataType:"json",cache:!this.preventCaching,beforeSend:function(xhr){xhr.setRequestHeader("X-DataTables-Draw",draw)},success:function(response,status,xhr){response.draw=draw,self.lastResponse=response,callback(response),self.onAJAXResponse(response)}};return WPGMZA.restAPI.call(route,options)},WPGMZA.DataTable.prototype.getDataTableSettings=function(){var self=this,element=this.element,options={};$(element).attr("data-wpgmza-datatable-options")&&(options=JSON.parse($(element).attr("data-wpgmza-datatable-options"))),options.deferLoading=!0,options.processing=!0,options.serverSide=!0,options.ajax=function(data,callback,settings){return WPGMZA.DataTable.prototype.onDataTableAjaxRequest.apply(self,arguments)},WPGMZA.AdvancedTableDataTable&&this instanceof WPGMZA.AdvancedTableDataTable&&WPGMZA.settings.wpgmza_default_items&&(options.iDisplayLength=parseInt(WPGMZA.settings.wpgmza_default_items)),options.aLengthMenu=[[5,10,25,50,100,-1],["5","10","25","50","100",WPGMZA.localized_strings.all]];var languageURL=this.getLanguageURL();return languageURL&&(options.language={url:languageURL}),options},WPGMZA.DataTable.prototype.getLanguageURL=function(){if(!WPGMZA.locale)return null;var languageURL;switch(WPGMZA.locale.substr(0,2)){case"af":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Afrikaans.json";break;case"sq":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Albanian.json";break;case"am":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Amharic.json";break;case"ar":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Arabic.json";break;case"hy":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Armenian.json";break;case"az":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Azerbaijan.json";break;case"bn":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Bangla.json";break;case"eu":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Basque.json";break;case"be":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Belarusian.json";break;case"bg":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Bulgarian.json";break;case"ca":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Catalan.json";break;case"zh":languageURL="zh_TW"==WPGMZA.locale?WPGMZA.pluginDirURL+"languages/datatables/Chinese-traditional.json":"//cdn.datatables.net/plug-ins/1.10.12/i18n/Chinese.json";break;case"hr":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Croatian.json";break;case"cs":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Czech.json";break;case"da":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Danish.json";break;case"nl":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Dutch.json";break;case"et":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Estonian.json";break;case"fi":languageURL=WPGMZA.locale.match(/^fil/)?WPGMZA.pluginDirURL+"languages/datatables/Filipino.json":WPGMZA.pluginDirURL+"languages/datatables/Finnish.json";break;case"fr":languageURL=WPGMZA.pluginDirURL+"languages/datatables/French.json";break;case"gl":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Galician.json";break;case"ka":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Georgian.json";break;case"de":languageURL=WPGMZA.pluginDirURL+"languages/datatables/German.json";break;case"el":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Greek.json";break;case"gu":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Gujarati.json";break;case"he":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Hebrew.json";break;case"hi":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Hindi.json";break;case"hu":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Hungarian.json";break;case"is":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Icelandic.json";break;case"id":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Indonesian.json";break;case"ga":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Irish.json";break;case"it":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Italian.json";break;case"ja":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Japanese.json";break;case"kk":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Kazakh.json";break;case"ko":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Korean.json";break;case"ky":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Kyrgyz.json";break;case"lv":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Latvian.json";break;case"lt":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Lithuanian.json";break;case"mk":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Macedonian.json";break;case"ml":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Malay.json";break;case"mn":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Mongolian.json";break;case"ne":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Nepali.json";break;case"nb":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Norwegian-Bokmal.json";break;case"nn":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Norwegian-Nynorsk.json";break;case"ps":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Pashto.json";break;case"fa":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Persian.json";break;case"pl":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Polish.json";break;case"pt":languageURL="pt_BR"==WPGMZA.locale?WPGMZA.pluginDirURL+"languages/datatables/Portuguese-Brasil.json":"//cdn.datatables.net/plug-ins/1.10.12/i18n/Portuguese.json";break;case"ro":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Romanian.json";break;case"ru":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Russian.json";break;case"sr":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Serbian.json";break;case"si":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Sinhala.json";break;case"sk":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Slovak.json";break;case"sl":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Slovenian.json";break;case"es":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Spanish.json";break;case"sw":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Swahili.json";break;case"sv":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Swedish.json";break;case"ta":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Tamil.json";break;case"te":languageURL=WPGMZA.pluginDirURL+"languages/datatables/telugu.json";break;case"th":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Thai.json";break;case"tr":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Turkish.json";break;case"uk":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Ukrainian.json";break;case"ur":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Urdu.json";break;case"uz":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Uzbek.json";break;case"vi":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Vietnamese.json";break;case"cy":languageURL=WPGMZA.pluginDirURL+"languages/datatables/Welsh.json"}return languageURL},WPGMZA.DataTable.prototype.onAJAXResponse=function(response){},WPGMZA.DataTable.prototype.reload=function(){this.dataTable.ajax.reload(null,!1)}}),jQuery(function($){WPGMZA.AdminMarkerDataTable=function(element){var self=this;this.preventCaching=!0,WPGMZA.DataTable.call(this,element),$(element).on("click","[data-delete-marker-id]",function(event){self.onDeleteMarker(event)}),$(element).find(".wpgmza.select_all_markers").on("click",function(event){self.onSelectAll(event)}),$(element).find(".wpgmza.bulk_delete").on("click",function(event){self.onBulkDelete(event)}),$(element).on("click","[data-center-marker-id]",function(event){self.onCenterMarker(event)})},WPGMZA.AdminMarkerDataTable.prototype=Object.create(WPGMZA.DataTable.prototype),WPGMZA.AdminMarkerDataTable.prototype.constructor=WPGMZA.AdminMarkerDataTable,WPGMZA.AdminMarkerDataTable.createInstance=function(element){return new WPGMZA.AdminMarkerDataTable(element)},WPGMZA.AdminMarkerDataTable.prototype.getDataTableSettings=function(){var self=this,options=WPGMZA.DataTable.prototype.getDataTableSettings.call(this);return options.createdRow=function(row,data,index){var meta=self.lastResponse.meta[index];row.wpgmzaMarkerData=meta},options},WPGMZA.AdminMarkerDataTable.prototype.onEditMarker=function(event){WPGMZA.animatedScroll("#wpgmaps_tabs_markers")},WPGMZA.AdminMarkerDataTable.prototype.onDeleteMarker=function(event){var self=this,id=$(event.currentTarget).attr("data-delete-marker-id"),data={action:"delete_marker",security:WPGMZA.legacyajaxnonce,map_id:WPGMZA.mapEditPage.map.id,marker_id:id};$.post(ajaxurl,data,function(response){WPGMZA.mapEditPage.map.removeMarkerByID(id),self.reload()})},WPGMZA.AdminMarkerDataTable.prototype.onApproveMarker=function(event){var cur_id=$(this).attr("id"),data={action:"approve_marker",security:WPGMZA.legacyajaxnonce,map_id:WPGMZA.mapEditPage.map.id,marker_id:cur_id};$.post(ajaxurl,data,function(response){wpgmza_InitMap(),wpgmza_reinitialisetbl()})},WPGMZA.AdminMarkerDataTable.prototype.onSelectAll=function(event){$(this.element).find("input[name='mark']").prop("checked",!0)},WPGMZA.AdminMarkerDataTable.prototype.onBulkDelete=function(event){var self=this,ids=[],map=WPGMZA.maps[0];$(this.element).find("input[name='mark']:checked").each(function(index,el){var row=$(el).closest("tr")[0];ids.push(row.wpgmzaMarkerData.id)}),ids.forEach(function(marker_id){var marker=map.getMarkerByID(marker_id);marker&&map.removeMarker(marker)}),WPGMZA.restAPI.call("/markers/",{method:"DELETE",data:{ids:ids},complete:function(){self.reload()}})},WPGMZA.AdminMarkerDataTable.prototype.onCenterMarker=function(event){var id;id=null==event.currentTarget?event:$(event.currentTarget).attr("data-center-marker-id");var marker=WPGMZA.mapEditPage.map.getMarkerByID(id);if(marker){var latLng=new WPGMZA.LatLng({lat:marker.lat,lng:marker.lng});WPGMZA.mapEditPage.map.setCenter(latLng),WPGMZA.mapEditPage.map.setZoom(6),WPGMZA.animateScroll("#wpgmaps_tabs_markers")}},$(document).ready(function(event){$("[data-wpgmza-admin-marker-datatable]").each(function(index,el){WPGMZA.adminMarkerDataTable=WPGMZA.AdminMarkerDataTable.createInstance(el)})})}),jQuery(function($){WPGMZA.AdminMapDataTable=function(element){var self=this;WPGMZA.DataTable.call(this,element),$(element).on("mousedown","button[data-action='edit']",function(event){switch(event.which){case 1:var map_id=$(event.target).attr("data-map-id");window.location.href=window.location.href+"&action=edit&map_id="+map_id;break;case 2:map_id=$(event.target).attr("data-map-id");window.open(window.location.href+"&action=edit&map_id="+map_id)}}),$(element).find(".wpgmza.select_all_maps").on("click",function(event){self.onSelectAll(event)}),$(element).find(".wpgmza.bulk_delete_maps").on("click",function(event){self.onBulkDelete(event)}),$(element).on("click","button[data-action='duplicate']",function(event){var map_id=$(event.target).attr("data-map-id");WPGMZA.restAPI.call("/maps/",{method:"POST",data:{id:map_id,action:"duplicate"},success:function(response,status,xhr){self.reload()}})}),$(element).on("click","button[data-action='trash']",function(event){if(confirm(WPGMZA.localized_strings.map_delete_prompt_text)){var map_id=$(event.target).attr("data-map-id");WPGMZA.restAPI.call("/maps/",{method:"DELETE",data:{id:map_id},success:function(response,status,xhr){self.reload()}})}})},WPGMZA.extend(WPGMZA.AdminMapDataTable,WPGMZA.DataTable),WPGMZA.AdminMapDataTable.prototype.getDataTableSettings=function(){var self=this,options=WPGMZA.DataTable.prototype.getDataTableSettings.call(this);return options.createdRow=function(row,data,index){var meta=self.lastResponse.meta[index];row.wpgmzaMapData=meta},options},WPGMZA.AdminMapDataTable.prototype.onSelectAll=function(event){$(this.element).find("input[name='mark']").prop("checked",!0)},WPGMZA.AdminMapDataTable.prototype.onBulkDelete=function(event){var self=this,ids=[];$(this.element).find("input[name='mark']:checked").each(function(index,el){var row=$(el).closest("tr")[0];ids.push(row.wpgmzaMapData.id)}),confirm(WPGMZA.localized_strings.map_bulk_delete_prompt_text)&&WPGMZA.restAPI.call("/maps/",{method:"DELETE",data:{ids:ids},complete:function(){self.reload()}})},$(document).ready(function(event){$("[data-wpgmza-admin-map-datatable]").each(function(index,el){WPGMZA.AdminMapDataTable=new WPGMZA.AdminMapDataTable(el)})})}),jQuery(function($){WPGMZA.AdvancedPage=function(){WPGMZA.restAPI.call("/markers?action=count-duplicates",{success:function(result){}}),$("button#wpgmza-remove-duplicates").on("click",function(event){confirm(WPGMZA.localized_strings.confirm_remove_duplicates)&&($(event.target).prop("disabled",!0),WPGMZA.restAPI.call("/markers?action=remove-duplicates",{success:function(result){alert(result.message),$(event.target).prop("disabled",!1)}}))})},$(window).on("load",function(event){WPGMZA.getCurrentPage()==WPGMZA.PAGE_ADVANCED&&(WPGMZA.advancedPage=new WPGMZA.AdvancedPage)})}),jQuery(function($){WPGMZA.CategoriesPage=function(){0<$(".wpgmza-marker-icon-picker").length&&(this.markerIconPicker=new WPGMZA.MarkerIconPicker($(".wpgmza-marker-icon-picker")))},$(window).on("load",function(event){WPGMZA.getCurrentPage()==WPGMZA.PAGE_CATEGORIES&&(WPGMZA.categoriesPage=new WPGMZA.CategoriesPage)})}),jQuery(function($){WPGMZA.CategoryPicker=function(element){var self=this,data=JSON.parse($(element).attr("data-js-tree-data"));this.element=element,this.input=$(this.element).find("input.wpgmza-category-picker-input"),$(this.element).jstree({core:{data:data},plugins:["checkbox"]}).on("loaded.jstree",function(){$(self.element).jstree("open_all")}),$(this.element).after(this.input),$(this.element).on("changed.jstree",function(e,data){self.input.val(self.getSelection().join(","))})},WPGMZA.CategoryPicker.prototype.getSelection=function(){return $(this.element).jstree("get_selected")},WPGMZA.CategoryPicker.prototype.setSelection=function(arr){$(this.element).jstree("deselect_all"),arr&&$(this.element).jstree("select_node",arr)}}),jQuery(function($){WPGMZA.CategoryTreeNode=function(options){for(var name in this.children=[],options)switch(name){case"children":for(var i=0;i<options.children.length;i++){var child=WPGMZA.CategoryTreeNode.createInstance(options.children[i]);(child.parent=this).children.push(child)}break;default:this[name]=options[name]}},WPGMZA.extend(WPGMZA.CategoryTreeNode,WPGMZA.EventDispatcher),WPGMZA.CategoryTreeNode.createInstance=function(options){return new WPGMZA.CategoryTreeNode(options)},WPGMZA.CategoryTreeNode.prototype.getChildByID=function(id){if(this.id==id)return this;for(var i=0;i<this.children.length;i++){var result=this.children[i].getChildByID(id);if(result)return result}return null}}),jQuery(function($){WPGMZA.CategoryTree=function(options){WPGMZA.CategoryTreeNode.call(this,options)},WPGMZA.extend(WPGMZA.CategoryTree,WPGMZA.CategoryTreeNode),WPGMZA.CategoryTree.createInstance=function(options){return new WPGMZA.CategoryTree(options)},WPGMZA.CategoryTree.prototype.getCategoryByID=function(id){return this.getChildByID(id)},WPGMZA.categoryTreeData&&(WPGMZA.categories=WPGMZA.CategoryTree.createInstance(WPGMZA.categoryTreeData),delete WPGMZA.categoryTreeData)}),jQuery(function($){WPGMZA.CustomFieldFilterController=function(map_id){var self=this;this.map_id=map_id,this.widgets=[],this.ajaxTimeoutID=null,this.ajaxRequest=null,this.markerListingCSS=$("<style type='text/css'/>"),$(document.body).append(this.markerListingCSS),WPGMZA.CustomFieldFilterController.controllersByMapID[map_id]=this,$("[data-wpgmza-filter-widget-class][data-map-id="+map_id+"]").each(function(index,el){self.widgets.push(WPGMZA.CustomFieldFilterWidget.createInstance(el)),$(el).on("input change",function(event){self.onWidgetChanged(event)}),$(el).is(":checkbox")&&$(el).on("click",function(event){self.onWidgetChanged(event)})});var container=$(".wpgmza-filter-widgets[data-map-id='"+map_id+"']");$(container).find("button.wpgmza-reset-custom-fields").on("click",function(event){$(container).find("input:not([type='checkbox']):not([type='radio']), textarea").val(""),$(container).find("input[type='checkbox']").prop("checked",!1),$(container).find("select").val(""),self.onWidgetChanged()})},WPGMZA.CustomFieldFilterController.AJAX_DELAY=500,WPGMZA.CustomFieldFilterController.controllersByMapID={},WPGMZA.CustomFieldFilterController.dataTablesSourceHTMLByMapID={},WPGMZA.CustomFieldFilterController.createInstance=function(map_id){return new WPGMZA.CustomFieldFilterController(map_id)},WPGMZA.CustomFieldFilterController.prototype.getAjaxRequestData=function(){var self=this,result={url:ajaxurl,method:"POST",data:{action:"wpgmza_custom_field_filter_get_filtered_marker_ids",map_id:this.map_id,widgetData:[]},success:function(response,status,xhr){self.onAjaxResponse(response,status,xhr)}};return this.widgets.forEach(function(widget){result.data.widgetData.push(widget.getAjaxRequestData())}),result},WPGMZA.CustomFieldFilterController.prototype.onWidgetChanged=function(event){WPGMZA.getMapByID(this.map_id).markerFilter.update({},this)},WPGMZA.CustomFieldFilterController.prototype.onAjaxResponse=function(response,status,xhr){this.lastResponse=response;var container,selectors=[];for(var marker_id in marker_array[this.map_id]){var visible=0==response.marker_ids.length||-1<response.marker_ids.indexOf(marker_id);marker_array[this.map_id][marker_id].setVisible(visible),visible||selectors.push(".wpgmaps_mlist_row[mid='"+marker_id+"']")}wpgmaps_localize[this.map_id].order_markers_by&&2==wpgmaps_localize[this.map_id].order_markers_by?wpgmza_update_data_table(WPGMZA.CustomFieldFilterController.dataTablesSourceHTMLByMapID[this.map_id],this.map_id):(this.markerListingCSS.html(selectors.join(", ")+"{ display: none; }"),container=this.currAdvancedTableHTML?$("#wpgmza_marker_holder_"+this.map_id):$(this.currAdvancedTableHTML),this.applyToAdvancedTable(container))},WPGMZA.CustomFieldFilterController.prototype.reapplyLastResponse=function(){if(this.lastResponse){var response=this.lastResponse;for(var marker_id in marker_array[this.map_id]){var visible=-1<response.marker_ids.indexOf(marker_id);marker_array[this.map_id][marker_id].setVisible(visible)}}},WPGMZA.CustomFieldFilterController.prototype.applyToAdvancedTable=function(){if(this.lastResponse){var response=this.lastResponse,container=$("#wpgmza_marker_holder_"+this.map_id);$(container).find("[mid]").each(function(index,el){var marker_id=$(el).attr("mid");-1==response.marker_ids.indexOf(marker_id)&&$(el).remove()})}},$(window).on("load",function(event){1!=WPGMZA.is_admin&&$(".wpgmza_map").each(function(index,el){parseInt($(el).attr("id").match(/\d+/)[0]);setTimeout(function(){$(el).children("div").first().after($(".wpgmza-modern-marker-open-button"))},500)})})}),jQuery(function($){WPGMZA.CustomFieldFilterWidget=function(element){this.element=element},WPGMZA.CustomFieldFilterWidget.createInstance=function(element){var widgetPHPClass=$(element).attr("data-wpgmza-filter-widget-class"),constructor=null;switch(widgetPHPClass){case"WPGMZA\\CustomFieldFilterWidget\\Text":constructor=WPGMZA.CustomFieldFilterWidget.Text;break;case"WPGMZA\\CustomFieldFilterWidget\\Dropdown":constructor=WPGMZA.CustomFieldFilterWidget.Dropdown;break;case"WPGMZA\\CustomFieldFilterWidget\\Checkboxes":constructor=WPGMZA.CustomFieldFilterWidget.Checkboxes;break;case"WPGMZA\\CustomFieldFilterWidget\\Time":constructor=WPGMZA.CustomFieldFilterWidget.Time;break;case"WPGMZA\\CustomFieldFilterWidget\\Date":constructor=WPGMZA.CustomFieldFilterWidget.Date;break;default:throw new Error("Unknown field type '"+widgetPHPClass+"'")}return new constructor(element)},WPGMZA.CustomFieldFilterWidget.prototype.getAjaxRequestData=function(){return{field_id:$(this.element).attr("data-field-id"),value:$(this.element).val()}},WPGMZA.CustomFieldFilterWidget.Text=function(element){WPGMZA.CustomFieldFilterWidget.apply(this,arguments)},WPGMZA.CustomFieldFilterWidget.Text.prototype=Object.create(WPGMZA.CustomFieldFilterWidget.prototype),WPGMZA.CustomFieldFilterWidget.Text.prototype.constructor=WPGMZA.CustomFieldFilterWidget.Text,WPGMZA.CustomFieldFilterWidget.Dropdown=function(element){WPGMZA.CustomFieldFilterWidget.apply(this,arguments)},WPGMZA.CustomFieldFilterWidget.Dropdown.prototype=Object.create(WPGMZA.CustomFieldFilterWidget.prototype),WPGMZA.CustomFieldFilterWidget.Dropdown.prototype.constructor=WPGMZA.CustomFieldFilterWidget.Dropdown,WPGMZA.CustomFieldFilterWidget.Checkboxes=function(element){WPGMZA.CustomFieldFilterWidget.apply(this,arguments)},WPGMZA.CustomFieldFilterWidget.Checkboxes.prototype=Object.create(WPGMZA.CustomFieldFilterWidget.prototype),WPGMZA.CustomFieldFilterWidget.Checkboxes.prototype.constructor=WPGMZA.CustomFieldFilterWidget.Checkboxes,WPGMZA.CustomFieldFilterWidget.Checkboxes.prototype.getAjaxRequestData=function(){var checked=[];return $(this.element).find(":checked").each(function(index,el){checked.push($(el).val())}),{field_id:$(this.element).attr("data-field-id"),value:checked}},$(document.body).on("mouseover",".wpgmza-placeholder-label",function(event){$(event.currentTarget).children("ul.wpgmza-checkboxes").stop(!0,!1).fadeIn()}),$(document.body).on("mouseleave",".wpgmza-placeholder-label",function(event){$(event.currentTarget).children("ul.wpgmza-checkboxes").stop(!0,!1).fadeOut()}),WPGMZA.CustomFieldFilterWidget.Time=function(element){WPGMZA.CustomFieldFilterWidget.apply(this,arguments)},WPGMZA.CustomFieldFilterWidget.Time.prototype.getAjaxRequestData=function(){var field_id=$(this.element).attr("data-field-id");return{field_id:field_id,value_start:$('[data-field-id="'+field_id+'"][data-date-start="true"]').val(),value_end:$('[data-field-id="'+field_id+'"][data-date-end="true"]').val(),type:"time"}},WPGMZA.CustomFieldFilterWidget.Date=function(element){WPGMZA.CustomFieldFilterWidget.apply(this,arguments)},WPGMZA.CustomFieldFilterWidget.Date.prototype.getAjaxRequestData=function(){var field_id=$(this.element).attr("data-field-id");return{field_id:field_id,value_start:$('[data-field-id="'+field_id+'"][data-date-start="true"]').val(),value_end:$('[data-field-id="'+field_id+'"][data-date-end="true"]').val(),type:"date"}}}),jQuery(function($){WPGMZA.DirectionsBox=function(map){var self=this;if(this.map=map,this.element=$("#wpgmaps_directions_edit_"+map.id),this.element[0].wpgmzaMap=map,this.optionsElement=this.element.find(".wpgmza-directions-options"),this.optionsElement.hide(),this.showOptionsElement=this.element.find("#wpgmza_show_options_"+map.id),this.showOptionsElement.on("click",function(event){self.onShowOptions(event)}),this.hideOptionsElement=this.element.find("#wpgmza_hide_options_"+map.id),this.hideOptionsElement.on("click",function(event){self.onHideOptions(event)}),this.hideOptionsElement.hide(),this.waypointTemplateItem=$(this.element).find(".wpgmaps_via.wpgmaps_template"),this.waypointTemplateItem.removeClass("wpgmaps_template"),this.waypointTemplateItem.remove(),this.element.find(".wpgmaps_add_waypoint a").on("click",function(event){self.onAddWaypoint(event)}),this.element.on("click",".wpgmza_remove_via",function(event){self.onRemoveWaypoint(event)}),$("body").sortable&&$(this.element).find(".wpgmaps_directions_outer_div [data-map-id]").sortable({items:".wpgmza-form-field.wpgmaps_via"}),this.getDirectionsButton=this.element.find(".wpgmaps_get_directions"),this.getDirectionsButton.on("click",function(event){self.onGetDirections()}),$(this.element).find(".wpgmza-reset-directions").on("click",function(event){self.onResetDirections(event)}),$(this.element).find(".wpgmza-print-directions").on("click",function(event){self.onPrintDirections(event)}),this.service=WPGMZA.DirectionsService.createInstance(map),this.renderer=WPGMZA.DirectionsRenderer.createInstance(map),this.map.shortcodeAttributes.directions_from&&$("#wpgmza_input_from_"+this.map.id).val(this.map.shortcodeAttributes.directions_from),this.map.shortcodeAttributes.directions_to&&$("#wpgmza_input_to_"+this.map.id).val(this.map.shortcodeAttributes.directions_to),this.map.shortcodeAttributes.directions_waypoints)for(var addresses=this.map.shortcodeAttributes.directions_waypoints.split("|"),i=0;i<addresses.length;i++)this.addWaypoint(addresses[i]);"true"==this.map.shortcodeAttributes.directions_auto&&this.route(),this.openExternal&&this.isUsingAppleMaps&&$(".wpgmza-add-waypoint").hide()},WPGMZA.DirectionsBox.prototype=Object.create(WPGMZA.EventDispatcher),WPGMZA.DirectionsBox.prototype.constructor=WPGMZA.DirectionsBox,WPGMZA.DirectionsBox.STYLE_DEFAULT="default",WPGMZA.DirectionsBox.STYLE_MODERN="modern",WPGMZA.DirectionsBox.STATE_INPUT="input",WPGMZA.DirectionsBox.STATE_DISPLAY="display",WPGMZA.DirectionsBox.forceGoogleMaps=!1,WPGMZA.DirectionsBox.createInstance=function(map){return!WPGMZA.isModernComponentStyleAllowed()||"modern"!=map.settings.directions_box_style&&"modern"!=WPGMZA.settings.user_interface_style?new WPGMZA.DirectionsBox(map):new WPGMZA.ModernDirectionsBox(map)},Object.defineProperty(WPGMZA.DirectionsBox.prototype,"style",{get:function(){return this.map.settings.directions_box_style}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"state",{set:function(value){switch($(".wpgmza-directions-box[data-map-id='"+this.map.id+"']").show(),value){case WPGMZA.DirectionsBox.STATE_INPUT:$("#wpgmaps_directions_editbox_"+this.map.id).show("slow"),$("#wpgmaps_directions_notification_"+this.map.id).hide("slow"),$(this.element).find("input.wpgmza-get-directions").show(),$(this.element).find("a.wpgmza-reset-directions").hide(),$(this.element).find("a.wpgmza-print-directions").hide();break;case WPGMZA.DirectionsBox.STATE_DISPLAY:$("#wpgmaps_directions_editbox_"+this.map.id).hide("slow"),$("#wpgmaps_directions_notification_"+this.map.id).show("slow"),$(this.element).find("input.wpgmza-get-directions").hide(),$(this.element).find("a.wpgmza-reset-directions").show(),$(this.element).find("a.wpgmza-print-directions").show();break;default:throw new Error("Unknown state")}}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"start",{get:function(){return this.from}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"end",{get:function(){return this.to}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"from",{get:function(){return $("#wpgmza_input_from_"+this.map.id).val()},set:function(value){$("#wpgmza_input_from_"+this.map.id).val(value)}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"to",{get:function(){return $("#wpgmza_input_to_"+this.map.id).val()},set:function(value){$("#wpgmza_input_to_"+this.map.id).val(value)}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"avoidTolls",{get:function(){return $("#wpgmza_tolls_"+this.map.id).is(":checked")}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"avoidHighways",{get:function(){return $("#wpgmza_highways_"+this.map.id).is(":checked")}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"avoidFerries",{get:function(){return $("#wpgmza_ferries_"+this.map.id).is(":checked")}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"travelMode",{get:function(){return $("#wpgmza_dir_type_"+this.map.id).val()}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"travelModeShort",{get:function(){return this.travelMode.substr(0,1).toLowerCase()}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"openExternal",{get:function(){return"external"==this.map.settings.directions_behaviour||"intelligent"==this.map.settings.directions_behaviour&&WPGMZA.isTouchDevice()}}),Object.defineProperty(WPGMZA.DirectionsBox.prototype,"isUsingAppleMaps",{get:function(){return navigator.platform.match(/iPhone|iPod|iPad/)&&!this.map.settings.force_google_directions_app}}),WPGMZA.DirectionsBox.prototype.getAjaxParameters=function(){var request={origin:this.from,destination:this.to,provideRouteAlternatives:!0,avoidHighways:this.avoidHighways,avoidTolls:this.avoidTolls,avoidFerries:this.avoidFerries,travelMode:this.travelMode},addresses=this.getWaypointAddresses(),waypoints=[];if(addresses.length){for(var i in addresses){var location=addresses[i];waypoints[i]={location:location,stopover:!1}}request.waypoints=waypoints}return request},WPGMZA.DirectionsBox.prototype.getWaypointAddresses=function(){$("#wpgmza_input_waypoints_"+this.map.id).val();var elements=$("#wpgmaps_directions_edit_"+this.map.id+" input.wpgmaps_via"),values=[];return elements.length&&elements.each(function(index,el){values.push($(el).val())}),values},WPGMZA.DirectionsBox.prototype.getExternalURLParameters=function(options){var waypoints;if("apple"==(options=options||{}).scheme?(params={saddr:this.from,daddr:this.to},options.marker&&(params.daddr=options.marker.address)):(params={api:1,origin:this.from,destination:this.to,travelmode:this.travelMode},(waypoints=this.getWaypointAddresses()).length&&(params.waypoints=waypoints.join("|")),options.marker&&(params.destination=options.marker.address)),"string"!=options.format)return params;var components=[];for(var name in params)components.push(name+"="+encodeURIComponent(params[name]));return"?"+components.join("&")},WPGMZA.DirectionsBox.prototype.getExternalURL=function(options){return options=options||{},options=$.extend(options,{format:"string"}),this.isUsingAppleMaps?(options.scheme="apple","https://maps.apple.com/maps"+this.getExternalURLParameters(options)):"https://www.google.com/maps/dir/"+this.getExternalURLParameters(options)},WPGMZA.DirectionsBox.prototype.route=function(){var self=this;if(""!=this.from||""!=this.to){var params=this.getAjaxParameters();"legacy"==WPGMZA.settings.user_interface_style&&"modern"==self.map.settings.directions_box_style||WPGMZA.settings.user_interface_style;this.state=WPGMZA.DirectionsBox.STATE_DISPLAY,this.map.modernDirectionsBox&&this.map.modernDirectionsBox.open(),this.service.route(params,function(response,status){switch(status){case WPGMZA.DirectionsService.SUCCESS:$("#wpgmaps_directions_notification_"+self.map.id).html(""),$("#directions_panel_"+self.map.id).show(),self.renderer.setDirections(response);break;case WPGMZA.DirectionsService.ZERO_RESULTS:self.state=WPGMZA.DirectionsBox.STATE_INPUT,$("#wpgmaps_directions_notification_"+self.map.id).html(WPGMZA.localized_strings.zero_results),self.reset();break;case WPGMZA.DirectionsService.NOT_FOUND:if(self.state=WPGMZA.DirectionsBox.STATE_INPUT,$("#wpgmaps_directions_notification_"+self.map.id).html(WPGMZA.localized_strings.zero_results),self.reset(),response.geocoded_waypoints&&response.geocoded_waypoints.length)for(var i=0;i<response.geocoded_waypoints.length;i++){(status=response.geocoded_waypoints[i].geocoder_status)==WPGMZA.DirectionsService.NOT_FOUND&&(0==i?$(self.element).find(".wpgmza-directions-from").addClass("wpgmza-not-found"):i==response.geocoded_waypoints.length-1?$(self.element).find(".wpgmza-directions-to").addClass("wpgmza-not-found"):$($(self.element).find("div.wpgmza-waypoint-via")[i-1]).addClass("wpgmza-not-found"))}break;default:alert(WPGMZA.localized_strings.unknown_directions_service_status),this.state=WPGMZA.DirectionsBox.STATE_INPUT}})}else alert(WPGMZA.localized_strings.please_fill_out_both_from_and_to_fields)},WPGMZA.DirectionsBox.prototype.reset=function(){$("#wpgmaps_directions_editbox_"+this.map.id).show(),$("#directions_panel_"+this.map.id).hide(),$("#directions_panel_"+this.map.id).html(""),$("#wpgmaps_directions_notification_"+this.map.id).hide(),$("#wpgmaps_directions_reset_"+this.map.id).hide(),$("#wpgmaps_directions_notification_"+this.map.id).html(WPGMZA.localized_strings.fetching_directions),$(".wpgmza-not-found").removeClass("wpgmza-not-found"),this.state=WPGMZA.DirectionsBox.STATE_INPUT,this.renderer.clear()},WPGMZA.DirectionsBox.prototype.showOptions=function(show){show||0==arguments.length?(this.optionsElement.show(),this.showOptionsElement.hide(),this.hideOptionsElement.show()):(this.optionsElement.hide(),this.showOptionsElement.show(),this.hideOptionsElement.hide())},WPGMZA.DirectionsBox.prototype.hideOptions=function(){this.showOptions(!1)},WPGMZA.DirectionsBox.prototype.addWaypoint=function(address){var row=this.waypointTemplateItem.clone();if($(this.element).find("div.wpgmza-directions-to").before(row),address&&$(row).find("input").val(address),window.google&&google.maps&&google.maps.places){var options={fields:["name","formatted_address"],types:["geocode"]},restrict=wpgmaps_localize[this.map.id].other_settings.wpgmza_store_locator_restrict;restrict&&restrict.length&&(options.componentRestrictions={country:restrict}),new google.maps.places.Autocomplete($(row).find("input")[0],options)}return row},WPGMZA.DirectionsBox.prototype.onAddWaypoint=function(){this.addWaypoint().find("input").focus()},WPGMZA.DirectionsBox.prototype.onShowOptions=function(event){$(this.element).find(".wpgmza-directions-options").show(),$(this.element).find(".wpgmza-hide-directions-options").show(),$(this.element).find(".wpgmza-show-directions-options").hide()},WPGMZA.DirectionsBox.prototype.onHideOptions=function(event){$(this.element).find(".wpgmza-directions-options").hide(),$(this.element).find(".wpgmza-hide-directions-options").hide(),$(this.element).find(".wpgmza-show-directions-options").show()},WPGMZA.DirectionsBox.prototype.onRemoveWaypoint=function(){$(event.target).closest(".wpgmza-form-field").remove()},WPGMZA.DirectionsBox.prototype.onGetDirections=function(event){this.openExternal?window.open(this.getExternalURL(),"_blank"):this.route()},WPGMZA.DirectionsBox.prototype.onPrintDirections=function(event){var url=this.getExternalURL()+"&om=1";window.open(url,"_blank")},WPGMZA.DirectionsBox.prototype.onResetDirections=function(event){this.reset()},$(document.body).on("click",".wpgmza_gd, .wpgmza-directions-button",function(event){var component,marker,address,coords,map;if((component=$(event.currentTarget).closest("[data-wpgmza-marker-listing]")).length||(component=$(event.currentTarget).closest(".wpgmza_modern_infowindow, [data-map-id]")),component.length){if(component.length){var element=component[0];element.wpgmzaMarkerListing?marker=(map=element.wpgmzaMarkerListing.map).getMarkerByID($(event.currentTarget).closest("[data-marker-id]").attr("data-marker-id")):element.wpgmzaInfoWindow?map=(marker=element.wpgmzaInfoWindow.mapObject).map:element.wpgmzaMap&&(map=element.wpgmzaMap,marker=element.wpgmzaMap.getMarkerByID($(event.currentTarget).attr("data-marker-id")))}address=marker.address,coords=marker.getPosition().toString(),map.directionsBox.openExternal?window.open(map.directionsBox.getExternalURL({marker:marker})):(map.directionsBox.state=WPGMZA.DirectionsBox.STATE_INPUT,map.directionsBox.to=address&&address.length?address:coords,$("#wpgmza_input_from_"+map.id).focus().select(),map.directionsBox instanceof WPGMZA.ModernDirectionsBox?map.directionsBox.open():WPGMZA.animateScroll(map.directionsBox.element))}})}),jQuery(function($){WPGMZA.DirectionsRenderer=function(map){WPGMZA.EventDispatcher.apply(this,arguments),this.map=map},WPGMZA.extend(WPGMZA.DirectionsRenderer,WPGMZA.EventDispatcher),WPGMZA.DirectionsRenderer.createInstance=function(map){switch(WPGMZA.settings.engine){case"open-layers":return new WPGMZA.OLDirectionsRenderer(map);default:return new WPGMZA.GoogleDirectionsRenderer(map)}},WPGMZA.DirectionsRenderer.prototype.setDirections=function(directions){}}),jQuery(function($){WPGMZA.DirectionsService=function(map){WPGMZA.EventDispatcher.apply(this,arguments),this.map=map},WPGMZA.extend(WPGMZA.DirectionsService,WPGMZA.EventDispatcher),WPGMZA.DirectionsService.ZERO_RESULTS="zero-results",WPGMZA.DirectionsService.NOT_FOUND="not-found",WPGMZA.DirectionsService.SUCCESS="success",WPGMZA.DirectionsService.DRIVING="driving",WPGMZA.DirectionsService.WALKING="walking",WPGMZA.DirectionsService.TRANSIT="transit",WPGMZA.DirectionsService.BICYCLING="bicycling",WPGMZA.DirectionsService.createInstance=function(map){switch(WPGMZA.settings.engine){case"open-layers":return new WPGMZA.OLDirectionsService(map);default:return new WPGMZA.GoogleDirectionsService(map)}},WPGMZA.DirectionsService.route=function(params,callback){}}),jQuery(function($){WPGMZA.Heatmap=function(row){if(WPGMZA.assertInstanceOf(this,"EventDispatcher"),this.name="",this.points=[],WPGMZA.MapObject.apply(this,arguments),"array"!=typeof this.settings.gradient&&(console.warn("Ignoring invalid gradient"),delete this.settings.gradient,this.settings.gradient=["rgba(0, 255, 255, 0)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"]),this.hashMap={},row&&row.points){this.points=this.parseGeometry(row.points);for(var i=0;i<this.points.length;i++)this.addPointToHashMap(this.points[i])}},WPGMZA.Heatmap.prototype=Object.create(WPGMZA.MapObject.prototype),WPGMZA.Heatmap.prototype.constructor=WPGMZA.Heatmap,WPGMZA.Heatmap.getConstructor=function(){switch(WPGMZA.settings.engine){case"open-layers":return WPGMZA.OLHeatmap;default:return WPGMZA.GoogleHeatmap}},WPGMZA.Heatmap.createInstance=function(row){return new(WPGMZA.Heatmap.getConstructor())(row)},WPGMZA.Heatmap.prototype.getHashFromLatLng=function(latLng){return parseFloat(latLng.lat).toFixed(11)+","+parseFloat(latLng.lng).toFixed(11)},WPGMZA.Heatmap.prototype.addPointToHashMap=function(point){var hash=this.getHashFromLatLng({lat:point.lat,lng:point.lng});this.hashMap[hash]=point},WPGMZA.Heatmap.prototype.addPoint=function(latLng){this.points.push(latLng),this.addPointToHashMap(latLng),this.modified=!0},WPGMZA.Heatmap.prototype.removePoint=function(latLng){var hash=this.getHashFromLatLng(latLng),point=this.hashMap[hash],index=this.points.indexOf(point);-1!=index?(this.points.splice(index,1),this.modified=!0):console.warn("No point found at "+hash)},WPGMZA.Heatmap.prototype.toJSON=function(){var result=WPGMZA.MapObject.prototype.toJSON.call(this);result.points=[];for(var i=0;i<this.points.length;i++){var latLng=this.points[i];result.points.push({lat:latLng.lat,lng:latLng.lng})}return result}}),jQuery(function($){WPGMZA.LegacyJSONConverter=function(){},WPGMZA.LegacyJSONConverter.prototype.convert=function(json){var markers=[];for(var key in"string"==typeof json&&(json=JSON.parse(json)),json){function getField(name){return json[name]}var data={map_id:getField("map_id"),marker_id:getField("marker_id"),title:getField("title"),address:getField("address"),icon:getField("icon"),pic:getField("pic"),desc:getField("desc"),linkd:getField("linkd"),anim:getField("anim"),retina:getField("retina"),category:getField("category"),lat:getField("lat"),lng:getField("lng"),infoopen:getField("infoopen")};markers[data.marker_id]=data}return markers}}),jQuery(function($){WPGMZA.MarkerGalleryInput=function(input){var self=this,container=$(input).parent();container.append("<div class='wpgmza-gallery-input'><ul><li class='wpgmza-add-new-picture'><i class='fa fa-camera' aria-hidden='true'></i></li></ul></div>"),this.input=input,this.element=container.find(".wpgmza-gallery-input"),$(this.input).next("#upload_image_button").remove(),$(this.input).hide(),this.addNewPictureButton=$(this.element).find(".wpgmza-add-new-picture"),this.addNewPictureButton.on("click",function(event){self.onAddNewPictureClicked(event)}),this.templateItem=$(this.addNewPictureButton).clone(),this.templateItem.removeClass("wpgmza-add-new-picture"),this.templateItem.find("i").remove(),$(this.element).find("ul").sortable({items:"li:not(.wpgmza-add-new-picture)",stop:function(){self.onDragEnd()}}),$(document.body).on("click",".wpgmza-delete-gallery-item",function(event){self.onDeleteItem(event)})},WPGMZA.MarkerGalleryInput.prototype.populate=function(arr){if(this.clear(),arr&&arr.length)for(var i=0;i<arr.length;i++)this.addPicture(arr[i])},WPGMZA.MarkerGalleryInput.prototype.update=function(){var string=this.serialize();this.input.val(string),this.input.attr("value",string)},WPGMZA.MarkerGalleryInput.prototype.clear=function(){$(this.element).find("[data-picture-url]").remove()},WPGMZA.MarkerGalleryInput.prototype.addPicture=function(picture){var item=this.templateItem.clone(),url=picture.url;item.css({"background-image":"url('"+url+"')"}),item.attr("data-picture-url",url),item.attr("data-attachment-id",picture.attachment_id),item.insertBefore(this.addNewPictureButton),item.append($("<button type='button' class='wpgmza-delete-gallery-item'>✖</button>")),this.update()},WPGMZA.MarkerGalleryInput.prototype.serialize=function(){return JSON.stringify(this.toJSON())},WPGMZA.MarkerGalleryInput.prototype.toJSON=function(){var gallery=[];return $(this.element).find("[data-picture-url]").each(function(index,el){gallery.push({attachment_id:$(el).attr("data-attachment-id"),url:$(el).attr("data-picture-url")})}),gallery},WPGMZA.MarkerGalleryInput.prototype.onDragEnd=function(){this.update()},WPGMZA.MarkerGalleryInput.prototype.onAttachmentPicked=function(attachment_id,attachment_url){this.addPicture({attachment_id:attachment_id,url:attachment_url})},WPGMZA.MarkerGalleryInput.prototype.onAddNewPictureClicked=function(event){var self=this;WPGMZA.openMediaDialog(function(attachment_id,attachment_url){self.onAttachmentPicked(attachment_id,attachment_url)})},WPGMZA.MarkerGalleryInput.prototype.onDeleteItem=function(event){$(event.target).closest("[data-picture-url]").remove()}}),jQuery(function($){WPGMZA.MarkerGallery=function(marker,context){var self=this,guid=WPGMZA.guid();if(this.element=$("<div class='wpgmza-empty-gallery'/>"),(this.marker=marker).gallery){if(marker.gallery.length<2){var first=marker.gallery[0];if(0==marker.gallery.length)return;var preview=first.thumbnail?first.thumbnail:first.url,img=context.getImageElementFromURL(preview);return img.attr("data-featherlight",first.url),context instanceof WPGMZA.ProInfoWindow&&(img.attr("id",guid),context.on("domready",function(event){$("#"+guid).on("click",function(event){self.onFeatherLightClick(event)})})),void(this.element=img)}if(this.element=$("<div class='wpgmza-marker-gallery'><div id='"+guid+"' class='owl-carousel'></div></div>"),this.carouselElement=this.element.find(".owl-carousel"),marker.gallery.forEach(function(item){self.addPicture(item,context)}),context instanceof WPGMZA.ProInfoWindow){var width=context.imageWidth;width=width||200,this.element.css({width:width+"px","max-width":width+"px",overflow:"hidden"}),this.carouselElement.css({width:width+"px","max-width":width+"px",overflow:"hidden"}),context.on("domready",function(event){$("#"+guid).owlCarousel(self.getOwlCarouselOptions()),$("#"+guid).on("click","[data-featherlight]",function(event){self.onFeatherLightClick(event)})})}else context instanceof WPGMZA.CarouselMarkerListing?setTimeout(function(){var width=$(context.element).find(".owl-item").innerWidth()-40;self.element.css({width:width+"px","max-width":width+"px",overflow:"hidden"}),self.carouselElement.css({width:width+"px","max-width":width+"px",overflow:"hidden"}),$(self.carouselElement).owlCarousel(self.getOwlCarouselOptions())},1e3):setTimeout(function(){$(self.carouselElement).owlCarousel(self.getOwlCarouselOptions())},100)}},WPGMZA.MarkerGallery.prototype.getOwlCarouselOptions=function(){return{navigation:!0,pagination:!1,dots:!1,slideSpeed:3e3,paginationSpeed:400,singleItem:!0,loop:!0,items:1,autoplay:!0,autoplayTimeout:4e3}},WPGMZA.MarkerGallery.prototype.addPicture=function(item,context){var img,container=$("<div/>");item.thumbnail||(item.thumbnail=item.url),context instanceof WPGMZA.ProInfoWindow?img=context.getImageElementFromURL(item.thumbnail):(img=$("<img/>")).attr("src",item.thumbnail),img.css({float:"none"}),img.attr("data-featherlight",item.url),container.append(img),$(this.carouselElement).append(container)},WPGMZA.MarkerGallery.prototype.onFeatherLightClick=function(event){var self=this;WPGMZA.isFullScreen()&&setTimeout(function(){$($(self.marker.map.element).find(".gm-style")[0]).append($(".featherlight"))},250)},$(document).on("fullscreenchange",function(){$(".featherlight").remove()})}),jQuery(function($){WPGMZA.MarkerIconPicker=function(element){var self=this;if(!element)throw new Error("Element cannot be undefined");if(!(element instanceof HTMLElement||element instanceof jQuery&&1==element.length))throw new Error("Invalid element");this.element=element;var input=$(this.element).find("input[name]"),name=$(input).attr("name");if(input.length){if(!name)throw new Error("Input must have a name for marker library to function");$(this.element).find("button.wpgmza-marker-library").attr("data-target-name",name);WPGMZA.MarkerIcon.createInstance(input.val())}$(this.element).find("button.wpgmza-upload").on("click",function(event){self.onUploadImage(event)}),$(this.element).find("button.wpgmza-reset").on("click",function(event){self.onReset(event)})},WPGMZA.MarkerIconPicker.prototype.setIcon=function(input){var url=WPGMZA.MarkerIcon.createInstance(input).url,preview=url;url!=WPGMZA.defaultMarkerIcon?$(this.element).find("input.wpgmza-marker-icon-url").val(url):$(this.element).find("input.wpgmza-marker-icon-url").val(""),0==url.length&&(preview=WPGMZA.defaultMarkerIcon),$(this.element).find(".wpgmza-marker-icon-preview").css({"background-image":"url('"+preview+"')"})},WPGMZA.MarkerIconPicker.prototype.onUploadImage=function(){var self=this;WPGMZA.openMediaDialog(function(attachment_id,attachment_url){self.setIcon(attachment_url),$(this.element).find("input.wpgmza-marker-icon-url").val("")})},WPGMZA.MarkerIconPicker.prototype.onReset=function(){this.reset()},WPGMZA.MarkerIconPicker.prototype.reset=function(){this.setIcon(WPGMZA.defaultMarkerIcon)}}),jQuery(function($){WPGMZA.MarkerIcon=function(options){var self=this;if(WPGMZA.EventDispatcher.apply(this,arguments),this.isLoaded=!1,this.url="",this.retina=!1,"object"==typeof options)for(var key in options)this[key]=options[key];else if("string"==typeof options)try{var json=JSON.parse(options);for(var key in json)this[key]=json[key]}catch(e){this.url=options}else if(options)throw new Error("Argument must be an object");this.url=this.url.replace(/^http(s?):/,""),this.dimensions={width:null,height:null};var url=this.isDefault?WPGMZA.defaultMarkerIcon:this.url;WPGMZA.getImageDimensions(url,function(dimensions){self.dimensions=dimensions,self.isLoaded=!0,self.trigger("load")})},WPGMZA.extend(WPGMZA.MarkerIcon,WPGMZA.EventDispatcher),WPGMZA.MarkerIcon.createInstance=function(options){return new WPGMZA.MarkerIcon(options)},Object.defineProperty(WPGMZA.MarkerIcon.prototype,"width",{get:function(){return this.retina?parseInt(WPGMZA.settings.retinaWidth):parseInt(this.dimensions.width)}}),Object.defineProperty(WPGMZA.MarkerIcon.prototype,"height",{get:function(){return this.retina?parseInt(WPGMZA.settings.retinaHeight):parseInt(this.dimensions.height)}}),Object.defineProperty(WPGMZA.MarkerIcon.prototype,"isDefault",{get:function(){return 0==this.url.length||this.url==WPGMZA.defaultMarkerIcon}}),WPGMZA.MarkerIcon.prototype.applyToElement=function(element){this.isDefault?$(element).attr("src",WPGMZA.defaultMarkerIcon):$(element).attr("src",this.url),this.retina&&$(element).css({width:this.width+"px",height:this.height+"px"})}}),jQuery(function($){WPGMZA.ModernDirectionsBox=function(map){WPGMZA.DirectionsBox.apply(this,arguments);var self=this,original=this.element;if(original.length){var container=$(map.element);this.map=map,this.element=$("<div class='wpgmza-popout-panel wpgmza-modern-directions-box'></div>"),this.panel=new WPGMZA.PopoutPanel(this.element),this.element.append(original),container.append(this.element),$(this.element).find("h2").after($("\t\t\t<div class='wpgmza-directions-buttons'>\t\t\t\t<span class='wpgmza-close'><i class='fa fa-times' aria-hidden='true'></i></span>\t\t\t</div>\t\t")),$(this.element).find("td:first-child").remove();var row=$(this.element).find("select[name^='wpgmza_dir_type']").closest("tr");$(this.element).find(".wpgmaps_to_row").after(row),$(this.element).find("#wpgmza_options_box_"+map.id).addClass("wpgmza-directions-options"),this.resultBox=new WPGMZA.ModernDirectionsResultBox(map,this);var behaviour=map.settings.directions_behaviour;"intelligent"==behaviour&&(behaviour=WPGMZA.isTouchDevice()?"external":"default"),"default"==behaviour&&$(this.element).find(".wpgmaps_get_directions").on("click",function(event){0!=self.from.length&&0!=self.to.length&&self.resultBox.open()}),$(this.element).find(".wpgmza-close").on("click",function(event){self.panel.close()}),$(this.element).on("click",".wpgmza-travel-mode-option",function(){var mode=jQuery(this).data("mode");jQuery("body").find(".wpgmza-travel-mode-option").removeClass("wpgmza-travel-option__selected"),jQuery(this).addClass("wpgmza-travel-option__selected"),jQuery("body").find(".wpgmza-travel-mode").val(mode)})}},WPGMZA.extend(WPGMZA.ModernDirectionsBox,WPGMZA.DirectionsBox),Object.defineProperty(WPGMZA.ModernDirectionsBox.prototype,"from",{get:function(){return $(this.element).find("input.wpgmza-directions-from").val()},set:function(value){return $(this.element).find("input.wpgmza-directions-from").val(value)}}),Object.defineProperty(WPGMZA.ModernDirectionsBox.prototype,"to",{get:function(){return $(this.element).find("input.wpgmza-directions-to").val()},set:function(value){return $(this.element).find("input.wpgmza-directions-to").val(value)}}),WPGMZA.ModernDirectionsBox.prototype.open=function(){this.panel.open(),this.resultBox&&this.resultBox.close(),$(this.element).children().show()},WPGMZA.ModernDirectionsBox.prototype.onNativeMapsApp=function(){var url=this.getExternalURL();window.open(url,"_blank")}}),jQuery(function($){WPGMZA.ModernDirectionsResultBox=function(map,directionsBox){WPGMZA.PopoutPanel.apply(this,arguments);var self=this,container=$(map.element);this.map=map,this.directionsBox=directionsBox,this.element=$("<div class='wpgmza-popout-panel wpgmza-modern-directions-box'>\t\t\t<h2 class='wpgmza-directions-box__title'>"+$(directionsBox.element).find("h2").html()+"</h2>\t\t\t<div class='wpgmza-directions-buttons'>\t\t\t\t<span class='wpgmza-close'><i class='fa fa-arrow-left' aria-hidden='true'></i></span>\t\t\t\t<a class='wpgmza-print' style='display: none;'><i class='fa fa-print' aria-hidden='true'></i></a>\t\t\t</div>\t\t\t<div class='wpgmza-directions-results'>\t\t\t</div>\t\t</div>"),this.element.addClass("wpgmza-modern-directions-box__results");var nativeIcon=new WPGMZA.NativeMapsAppIcon;this.nativeMapAppIcon=nativeIcon,$(this.element).find(".wpgmza-directions-buttons").append(nativeIcon.element),$(nativeIcon.element).on("click",function(event){self.onNativeMapsApp(event)}),container.append(this.element),this.element.append($("#directions_panel_"+map.id)),$(this.element).find(".wpgmza-print").attr("href","data:text/html,<script>document.body.innerHTML += sessionStorage.wpgmzaPrintDirectionsHTML; window.print();<\/script>"),$(this.element).find(".wpgmza-close").on("click",function(event){self.close()}),$(this.element).find(".wpgmza-print").on("click",function(event){self.onPrint(event)}),this.map.on("directionsserviceresult",function(event){self.onDirectionsChanged(event,event.response,event.status)}),this.clear()},WPGMZA.ModernDirectionsResultBox.prototype=Object.create(WPGMZA.PopoutPanel.prototype),WPGMZA.ModernDirectionsResultBox.prototype.constructor=WPGMZA.ModernDirectionsResultBox,WPGMZA.ModernDirectionsResultBox.prototype.clear=function(){$(this.element).find(".wpgmza-directions-results").html(""),$(this.element).find("a.wpgmza-print").attr("href","")},WPGMZA.ModernDirectionsResultBox.prototype.open=function(){WPGMZA.PopoutPanel.prototype.open.apply(this,arguments),this.showPreloader()},WPGMZA.ModernDirectionsResultBox.prototype.showPreloader=function(){$(this.element).find(".wpgmza-directions-results").html("<img src='"+wpgmza_ajax_loader_gif.src+"'/>")},WPGMZA.ModernDirectionsResultBox.prototype.onDirectionsChanged=function(event,response,status){switch(this.clear(),status){case WPGMZA.DirectionsService.SUCCESS:break;case WPGMZA.DirectionsService.NOT_FOUND:case WPGMZA.DirectionsService.ZERO_RESULTS:var key=status.toLowerCase(),message=WPGMZA.localized_strings[key];$(this.element).find(".wpgmza-directions-results").html('<i class="fa fa-times" aria-hidden="true"></i>'+message);break;default:message=WPGMZA.localized_strings.unknown_error;$(this.element).find(".wpgmza-directions-results").html('<i class="fa fa-times" aria-hidden="true"></i>'+message)}},WPGMZA.ModernDirectionsResultBox.prototype.onNativeMapsApp=function(event){var url=this.directionsBox.getExternalURL();window.open(url,"_blank")},WPGMZA.ModernDirectionsResultBox.prototype.onPrint=function(event){var content=$(this.element).find(".wpgmza-directions-results").html();document.implementation.createHTMLDocument();sessionStorage.wpgmzaPrintDirectionsHTML=content}}),jQuery(function($){WPGMZA.ModernMarkerListingMarkerView=function(map){var self=this;this.map=map,this.map_id=map.id,WPGMZA.PopoutPanel.apply(this,arguments);var container=$("#wpgmza_map_"+map.id);this.element=$("<div class='wpgmza-popout-panel wpgmza-modern-marker-listing-marker-view'>\t\t\t<div class='wpgmza-close-container'>\t\t\t\t<span class='wpgmza-close'><i class='fa fa-arrow-left' aria-hidden='true'></i></span>\t\t\t\t<span class='wpgmza-close'><i class='fa fa-times' aria-hidden='true'></i></span>\t\t\t</div>\t\t\t<div data-name='title'></div>\t\t\t<div data-name='address'></div>\t\t\t<div data-name='category'></div>\t\t\t<img data-name='pic'/>\t\t\t<div data-name='description'></div>\t\t\t<div class='wpgmza-modern-marker-listing-buttons'>\t\t\t\t<div class='wpgmza-modern-marker-listing-button wpgmza-link-button'>\t\t\t\t\t<i class='fa fa-link' aria-hidden='true'></i>\t\t\t\t\t<div>\t\t\t\t\t\t"+WPGMZA.localized_strings.link+"\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<div class='wpgmza-modern-marker-listing-button wpgmza-directions-button'>\t\t\t\t\t<i class='fa fa-road' aria-hidden='true'></i>\t\t\t\t\t<div>\t\t\t\t\t\t"+WPGMZA.localized_strings.directions+"\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<div class='wpgmza-modern-marker-listing-button wpgmza-zoom-button'>\t\t\t\t\t<i class='fa fa-search-plus' aria-hidden='true'></i>\t\t\t\t\t<div>\t\t\t\t\t\t"+WPGMZA.localized_strings.zoom+"\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div>\t\t</div>"),map.on("init",function(){container.append(self.element)}),map.on("click",function(event){event.target instanceof WPGMZA.Marker&&event.target!=self.map.userLocationMarker&&event.target!=self.map.storeLocatorMarker&&self.open(event.target.id)}),$(this.element).find(".wpgmza-close").on("click",function(event){self.close(),$("#wpgmza_map_"+self.map_id+" .wpgmza-modern-store-locator").removeClass("wpgmza_sl_mv_offset")}),$(this.element).find(".wpgmza-link-button").on("click",function(event){self.onLink(event)}),$(this.element).find(".wpgmza-directions-button").on("click",function(event){self.onDirections(event)}),$(this.element).find(".wpgmza-zoom-button").on("click",function(event){self.onZoom(event)}),$(container).append(this.element),container.children(".wpgmza-modern-directions-box").length&&$(this.element).after(container.children(".wpgmza-modern-directions-box"))},WPGMZA.ModernMarkerListingMarkerView.prototype=Object.create(WPGMZA.PopoutPanel.prototype),WPGMZA.ModernMarkerListingMarkerView.prototype.constructor=WPGMZA.ModernMarkerListingMarkerView,WPGMZA.ModernMarkerListingMarkerView.prototype.open=function(marker_id){var self=this,marker=this.map.getMarkerByID(marker_id);marker.disableInfoWindow||(WPGMZA.PopoutPanel.prototype.open.apply(this,arguments),this.marker=marker,$(this.element).find("[data-name]").each(function(index,el){var value,name=$(el).attr("data-name");switch(value=marker[name]?marker[name]:"",name){case"pic":$(el).attr("src",value),$(el).attr("alt",marker.title),marker.pic.length?$(el).show():$(el).hide();break;case"category":for(var ids=value.split(","),names=[],i=0;i<ids.length;i++){var id=ids[i];wpgmza_category_data[id]&&names.push(wpgmza_category_data[id].category_name)}$(el).html(names.join(", "));break;default:$(el).html(value)}}),marker.link&&0!=marker.link.length?$(this.element).find(".wpgmza-link-button").show():$(this.element).find(".wpgmza-link-button").hide(),$("#wpgmza_map_"+this.map_id+" .wpgmza-modern-store-locator").addClass("wpgmza_sl_mv_offset"),$(this.element).find("[data-custom-field-name]").remove(),$(this.element).find(".wpgmza-modern-marker-listing-buttons").before(marker.custom_fields_html),$(this.element).find(".wpgmza-directions-button").attr("data-marker-id",marker_id),$(this.element).find(".wpgmza-close").on("click",function(event){self.close()}))},WPGMZA.ModernMarkerListingMarkerView.prototype.onLink=function(event){window.open(this.marker.link,"_blank")},WPGMZA.ModernMarkerListingMarkerView.prototype.onDirections=function(event){this.map.directionsBox.to=this.marker.address,this.map.directionsBox.element.show()},WPGMZA.ModernMarkerListingMarkerView.prototype.onZoom=function(event){var map=MYMAP[this.map_id].map;map.setCenter(this.focusedMarker.getPosition()),map.setZoom(14)}}),jQuery(function($){WPGMZA.ProInfoWindow=function(mapObject){var self=this;WPGMZA.InfoWindow.call(this,mapObject),this.on("infowindowopen",function(event){self.updateDistanceFromLocation()})},WPGMZA.ProInfoWindow.prototype=Object.create(WPGMZA.InfoWindow.prototype),WPGMZA.ProInfoWindow.prototype.constructor=WPGMZA.ProInfoWindow,WPGMZA.ProInfoWindow.STYLE_INHERIT="-1",WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE="0",WPGMZA.ProInfoWindow.STYLE_MODERN="1",WPGMZA.ProInfoWindow.STYLE_MODERN_PLUS="2",WPGMZA.ProInfoWindow.STYLE_MODERN_CIRCULAR="3",WPGMZA.ProInfoWindow.STYLE_TEMPLATE="template",WPGMZA.ProInfoWindow.OPEN_BY_CLICK=1,WPGMZA.ProInfoWindow.OPEN_BY_HOVER=2,Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"maxWidth",{get:function(){var width=WPGMZA.settings.wpgmza_settings_infowindow_width;return!(!width||!/^\d+$/.test(width))&&width}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"imageWidth",{get:function(){var width=WPGMZA.settings.wpgmza_settings_image_width;return!(!width||!/^\d+$/.test(width))&&width}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"imageHeight",{get:function(){var height=WPGMZA.settings.wpgmza_settings_image_height;return!(!height||!/^\d+$/.test(height))&&height}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"enableImageResizing",{get:function(){return"yes"==WPGMZA.settings.wpgmza_settings_image_resizing}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"linkTarget",{get:function(){return"yes"==WPGMZA.settings.wpgmza_settings_infowindow_links?"_BLANK":""}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"linkText",{get:function(){return window.wpgmaps_lang_more_details}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"directionsText",{get:function(){return window.wpgmaps_lang_get_dir}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"distanceUnits",{get:function(){return 1==this.mapObject.map.settings.store_locator_distance?WPGMZA.Distance.MILES:WPGMZA.Distance.KILOMETERS}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"showAddress",{get:function(){return"yes"!=WPGMZA.settings.wpgmza_settings_infowindow_address}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"style",{get:function(){return this.map&&this.map.userLocationMarker==this?WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE:this.getSelectedStyle()}}),Object.defineProperty(WPGMZA.ProInfoWindow.prototype,"isPanIntoViewAllowed",{get:function(){return this.style==WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE}}),WPGMZA.ProInfoWindow.prototype.getSelectedStyle=function(){var globalTypeSetting=WPGMZA.settings.wpgmza_iw_type,localTypeSetting=this.mapObject.map.settings.wpgmza_iw_type,type=localTypeSetting;return(localTypeSetting!=WPGMZA.ProInfoWindow.STYLE_INHERIT&&void 0!==localTypeSetting||(type=globalTypeSetting)!=WPGMZA.ProInfoWindow.STYLE_INHERIT)&&type?String(type):WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE},WPGMZA.ProInfoWindow.prototype.getImageElementFromURL=function(url){var img=$("<img/>");return img.addClass("wpgmza_infowindow_image"),img.attr("src",url),img.css({float:"right"}),this.maxWidth&&img.css({"max-width":this.maxWidth}),this.enableImageResizing&&this.imageWidth&&(img.css({width:this.imageWidth}),img.css({height:this.imageHeight})),this.enableImageResizing||img.css({margin:"5px"}),img},WPGMZA.ProInfoWindow.prototype.updateDistanceFromLocation=function(){var marker=this.mapObject;if(marker instanceof WPGMZA.Marker){var location=marker.map.showDistanceFromLocation;if(location){var distanceToDisplay=WPGMZA.Distance.between(location,marker.getPosition());this.distanceUnits==WPGMZA.Distance.MILES&&(distanceToDisplay/=WPGMZA.Distance.KILOMETERS_PER_MILE);var text=Math.round(distanceToDisplay,2),source=location.source==WPGMZA.ProMap.SHOW_DISTANCE_FROM_USER_LOCATION?WPGMZA.localized_strings.from_your_location:WPGMZA.localized_strings.from_searched_location;$(this.element).find(".wpgmza-distance-from-location .wpgmza-amount").text(text),$(this.element).find(".wpgmza-distance-from-location .wpgmza-source").text(source)}}else console.warn("This function is only intended for use with markers and should not have been called in this manner")},WPGMZA.ProInfoWindow.prototype.legacyCreateDefaultInfoWindow=function(map){var marker=this.mapObject;map=marker.map;function empty(field){return!(field&&field.length&&0<field.length)}var container=$("<div class='wpgmza_markerbox scrollFix'></div>");if(this.maxWidth&&container.css({"max-width":this.maxWidth}),empty(marker.gallery)){if(!empty(marker.pic)){var img=this.getImageElementFromURL(marker.pic);container.append(img)}}else{var gallery=new WPGMZA.MarkerGallery(marker,this);container.append(gallery.element)}empty(marker.title)||((p=$("<p class='wpgmza_infowindow_title'></p>")).html(marker.title),container.append(p));!empty(marker.address)&&this.showAddress&&((p=$("<p class='wpgmza_infowindow_address'></p>")).html(marker.address),container.append(p));if(!empty(marker.desc)||!empty(marker.description)){var description=empty(marker.desc)?marker.description:marker.desc,div=$("<div class='wpgmza_infowindow_description'></div>");div.html(description),container.append(div)}if(1==map.settings.show_distance_from_location){var p=$("<p class='wpgmza-distance-from-location'><span class='wpgmza-amount'></span> <span class='wpgmza-units'></span> <span class='wpgmza-source'></span></p>"),units=this.distanceUnits==WPGMZA.Distance.MILES?WPGMZA.localized_strings.miles_away:WPGMZA.localized_strings.kilometers_away;p.find(".wpgmza-units").text(units),container.append(p)}if(!empty(marker.linkd)||!empty(marker.link)){var link=empty(marker.link)?marker.linkd:marker.link;p=$("<p class='wpgmza_infowindow_link'></p>");(a=$("<a class='wpgmza_infowindow_link'></a>")).attr("href",WPGMZA.decodeEntities(link)),a.attr("target",this.linkTarget),a.text(this.linkText),p.append(a),container.append(p)}if(map.directionsEnabled){var a;p=$("<p></p>");(a=$("<a class='wpgmza_gd'></a>")).attr("href","javascript: ;"),a.attr("id",map.id),a.attr("data-address",marker.address),a.attr("data-latlng",marker.getPosition().toString()),a.attr("data-marker-id",marker.id),a.attr("wpgm_addr_field",marker.address),a.attr("gps",marker.lat+","+marker.lng),a.text(this.directionsText),p.append(a),container.append(p)}marker.custom_fields_html&&container.append(marker.custom_fields_html),this.setContent(container.html())},WPGMZA.ProInfoWindow.prototype.legacyCreateModernInfoWindow=function(map){var mapid=map.id;if(0==$("#wpgmza_iw_holder_"+map.id).length){$(document.body).append("<div id='wpgmza_iw_holder_"+map.id+"'></div>"),null!==(legend=document.getElementById("wpgmza_iw_holder_"+mapid))&&$(legend).remove(),wpgmza_iw_Div[mapid]=document.createElement("div"),wpgmza_iw_Div[mapid].wpgmzaInfoWindow=this,wpgmza_iw_Div[mapid].id="wpgmza_iw_holder_"+mapid,wpgmza_iw_Div[mapid].style="display:block;",document.getElementsByTagName("body")[0].appendChild(wpgmza_iw_Div[mapid]),wpgmza_iw_Div_inner=document.createElement("div"),wpgmza_iw_Div_inner.className="wpgmza_modern_infowindow_inner wpgmza_modern_infowindow_inner_"+mapid,wpgmza_iw_Div[mapid].appendChild(wpgmza_iw_Div_inner),wpgmza_iw_Div_close=document.createElement("div"),wpgmza_iw_Div_close.className="wpgmza_modern_infowindow_close",wpgmza_iw_Div_close.setAttribute("mid",mapid);var t=document.createTextNode("x");if(wpgmza_iw_Div_close.appendChild(t),wpgmza_iw_Div_inner.appendChild(wpgmza_iw_Div_close),wpgmza_iw_Div_img=document.createElement("div"),wpgmza_iw_Div_img.className="wpgmza_iw_image",wpgmza_iw_Div_inner.appendChild(wpgmza_iw_Div_img),wpgmza_iw_img=document.createElement("img"),wpgmza_iw_img.className="wpgmza_iw_marker_image",wpgmza_iw_img.src="",wpgmza_iw_img.style="max-width:100%;",wpgmza_iw_Div_img.appendChild(wpgmza_iw_img),wpgmza_iw_img_div=document.createElement("div"),wpgmza_iw_img_div.className="wpgmza_iw_title",wpgmza_iw_Div_inner.appendChild(wpgmza_iw_img_div),wpgmza_iw_img_div_p=document.createElement("p"),wpgmza_iw_img_div_p.className="wpgmza_iw_title_p",wpgmza_iw_img_div.appendChild(wpgmza_iw_img_div_p),wpgmza_iw_address_div=document.createElement("div"),wpgmza_iw_address_div.className="wpgmza_iw_address",wpgmza_iw_Div_inner.appendChild(wpgmza_iw_address_div),wpgmza_iw_address_p=document.createElement("p"),wpgmza_iw_address_p.className="wpgmza_iw_address_p",wpgmza_iw_address_div.appendChild(wpgmza_iw_address_p),wpgmza_iw_description=document.createElement("div"),wpgmza_iw_description.className="wpgmza_iw_description",wpgmza_iw_Div_inner.appendChild(wpgmza_iw_description),wpgmza_iw_description_p=document.createElement("p"),wpgmza_iw_description_p.className="wpgmza_iw_description_p",wpgmza_iw_description.appendChild(wpgmza_iw_description_p),1==map.settings.show_distance_from_location){var p=$("<p class='wpgmza-distance-from-location'><span class='wpgmza-amount'></span> <span class='wpgmza-units'></span> <span class='wpgmza-source'></span></p>"),units=this.distanceUnits==WPGMZA.Distance.MILES?WPGMZA.localized_strings.miles_away:WPGMZA.localized_strings.kilometers_away;p.find(".wpgmza-units").text(units),$(wpgmza_iw_Div_inner).append(p)}var ratingContainer=$("<div class='wpgmza-rating-container'></div>")[0];wpgmza_iw_Div_inner.appendChild(ratingContainer),$(wpgmza_iw_Div_inner).append("<div class='wpgmza_iw_custom_fields'/>"),wpgmza_iw_buttons=document.createElement("div"),wpgmza_iw_buttons.className="wpgmza_iw_buttons",wpgmza_iw_Div_inner.appendChild(wpgmza_iw_buttons),wpgmza_directions_button=document.createElement("a"),wpgmza_directions_button.className="wpgmza_button wpgmza_left wpgmza_directions_button",wpgmza_directions_button.src="#";t=document.createTextNode(wpgmaps_lang_directions);wpgmza_directions_button.appendChild(t),wpgmza_iw_buttons.appendChild(wpgmza_directions_button),wpgmza_more_info_button=document.createElement("a"),wpgmza_more_info_button.className="wpgmza_button wpgmza_right wpgmza_more_info_button",wpgmza_more_info_button.src="#";t=document.createTextNode(wpgmaps_lang_more_info);wpgmza_more_info_button.appendChild(t),wpgmza_iw_buttons.appendChild(wpgmza_more_info_button);var legend=document.getElementById("wpgmza_iw_holder_"+mapid);if($(legend).css("display","block"),$(legend).addClass("wpgmza_modern_infowindow"),$(legend).addClass("wpgmza-shadow"),"google-maps"==WPGMZA.settings.engine)MYMAP[mapid].map.googleMap.controls[google.maps.ControlPosition.RIGHT_TOP].push(legend);else{var container=$(".wpgmza-ol-modern-infowindow-container[data-map-id='"+mapid+"']");container.length||(container=$("<div class='wpgmza-ol-modern-infowindow-container' data-map-id='"+mapid+"'></div>"),$(".wpgmza_map[data-map-id='"+mapid+"']").append(container)),container.append(legend)}}},WPGMZA.ProInfoWindow.prototype.open=function(map,mapObject){var marker=mapObject;if(window.infoWindow&&(infoWindow[mapObject.map.id]=this),!WPGMZA.InfoWindow.prototype.open.call(this,map,mapObject))return!1;if(this.mapObject==map.userLocationMarker)return!0;if(map.settings.list_markers_by==WPGMZA.MarkerListing.STYLE_MODERN)return!1;if(WPGMZA.settings.wpgmza_settings_disable_infowindows)return!1;if(this.style==WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE||"map-edit"==WPGMZA.currentPage)return this.legacyCreateDefaultInfoWindow(),!0;this.legacyCreateModernInfoWindow(map),modern_iw_open[map.id]=!0;var element=this.element=jQuery("#wpgmza_iw_holder_"+map.id);if(element.find(".wpgmza_iw_marker_image").attr("src",""),element.find(".wpgmza_iw_title").html(""),element.find(".wpgmza_iw_description").html(""),element.find(".wpgmza_iw_address_p").html(""),element.find(".wpgmza_more_info_button").attr("href","#"),element.find(".wpgmza_more_info_button").attr("target",""),element.find(".wpgmza_directions_button").attr("gps",""),element.find(".wpgmza_directions_button").attr("href","#"),element.find(".wpgmza_directions_button").attr("id",""),element.find(".wpgmza_directions_button").attr("wpgm_addr_field",""),""===marker.image&&""===marker.title?element.find(".wpgmza_iw_image").css("display","none"):element.find(".wpgmza_iw_image").css("display","block"),(container=$("#wpgmza_iw_holder_"+map.id+" .wpgmza_iw_image")).html(""),marker.gallery){var gallery=new WPGMZA.MarkerGallery(marker,this);gallery.element.css({float:"none"}),container.append(gallery.element)}else if(marker.pic.length){var image=$("<img class='wpgmza_infowindow_image'/>");image.attr("src",marker.pic),image.css({display:"block"}),container.append(image)}else element.find(".wpgmza_iw_marker_image").css("display","none"),element.find(".wpgmza_iw_title").attr("style","position: relative !important");""!==marker.title&&element.find(".wpgmza_iw_title").html(marker.title);var description="";marker.desc?description=marker.desc:marker.description&&(description=marker.description),description&&description.length?(element.find(".wpgmza_iw_description").css("display","block"),element.find(".wpgmza_iw_description").html(description)):element.find(".wpgmza_iw_description").css("display","none");var container=element.find(".wpgmza_iw_description");return marker.custom_fields_html&&(container.append(marker.custom_fields_html),container.css("display","block")),void 0!==wpgmaps_localize_global_settings.wpgmza_settings_infowindow_address&&"yes"===wpgmaps_localize_global_settings.wpgmza_settings_infowindow_address||void 0!==marker.address&&""!==marker.address&&element.find(".wpgmza_iw_address_p").html(marker.address),void 0!==marker.link&&""!==marker.link?(element.find(".wpgmza_more_info_button").show(),element.find(".wpgmza_more_info_button").attr("href",marker.link),element.find(".wpgmza_more_info_button").attr("target",this.linkTarget)):element.find(".wpgmza_more_info_button").hide(),map.directionsEnabled?(element.find(".wpgmza_directions_button").show(),element.find(".wpgmza_directions_button").attr("href","javascript:void(0);"),element.find(".wpgmza_directions_button").attr("gps",marker.lat+","+marker.lng),element.find(".wpgmza_directions_button").attr("wpgm_addr_field",marker.address),element.find(".wpgmza_directions_button").attr("id",map.id),element.find(".wpgmza_directions_button").addClass("wpgmza_gd")):element.find(".wpgmza_directions_button").hide(),element.show(),this.trigger("domready"),this.trigger("infowindowopen"),!0},WPGMZA.ProInfoWindow.prototype.close=function(){$(this.mapObject.map.element).find(".wpgmza-pro-info-window-container").html()},$(document).ready(function(event){$(document.body).on("click",".wpgmza-close-info-window",function(event){$(event.target).closest(".wpgmza-info-window").remove()})})}),jQuery(function($){var Parent;WPGMZA.GoogleInfoWindow=function(mapObject){Parent.call(this,mapObject),this.setMapObject(mapObject)},WPGMZA.GoogleInfoWindow.Z_INDEX=99,Parent=WPGMZA.isProVersion()?WPGMZA.ProInfoWindow:WPGMZA.InfoWindow,WPGMZA.GoogleInfoWindow.prototype=Object.create(Parent.prototype),WPGMZA.GoogleInfoWindow.prototype.constructor=WPGMZA.GoogleInfoWindow,WPGMZA.GoogleInfoWindow.prototype.setMapObject=function(mapObject){mapObject instanceof WPGMZA.Marker?this.googleObject=mapObject.googleMarker:mapObject instanceof WPGMZA.Polygon?this.googleObject=mapObject.googlePolygon:mapObject instanceof WPGMZA.Polyline&&(this.googleObject=mapObject.googlePolyline)},WPGMZA.GoogleInfoWindow.prototype.createGoogleInfoWindow=function(){var self=this;this.googleInfoWindow||(this.googleInfoWindow=new google.maps.InfoWindow,this.googleInfoWindow.setZIndex(WPGMZA.GoogleInfoWindow.Z_INDEX),google.maps.event.addListener(this.googleInfoWindow,"domready",function(event){self.trigger("domready")}),google.maps.event.addListener(this.googleInfoWindow,"closeclick",function(event){self.state!=WPGMZA.InfoWindow.STATE_CLOSED&&(self.state=WPGMZA.InfoWindow.STATE_CLOSED,self.trigger("infowindowclose"))}))},WPGMZA.GoogleInfoWindow.prototype.open=function(map,mapObject){var self=this;if(!Parent.prototype.open.call(this,map,mapObject))return!1;this.parent=map,this.createGoogleInfoWindow(),this.setMapObject(mapObject),this.googleObject instanceof google.maps.Polygon||this.googleInfoWindow.open(this.mapObject.map.googleMap,this.googleObject);var intervalID,guid=WPGMZA.guid(),html="<div id='"+guid+"'>"+this.content+"</div>";return this.googleInfoWindow.setContent(html),intervalID=setInterval(function(event){div=$("#"+guid),div.length&&(clearInterval(intervalID),div[0].wpgmzaMapObject=self.mapObject,div.addClass("wpgmza-infowindow"),self.element=div[0],self.trigger("infowindowopen"))},50),!0},WPGMZA.GoogleInfoWindow.prototype.close=function(){this.googleInfoWindow&&(WPGMZA.InfoWindow.prototype.close.call(this),this.googleInfoWindow.close())},WPGMZA.GoogleInfoWindow.prototype.setContent=function(html){Parent.prototype.setContent.call(this,html),this.content=html,this.createGoogleInfoWindow(),this.googleInfoWindow.setContent(html)},WPGMZA.GoogleInfoWindow.prototype.setOptions=function(options){Parent.prototype.setOptions.call(this,options),this.createGoogleInfoWindow(),this.googleInfoWindow.setOptions(options)}}),jQuery(function($){var Parent;WPGMZA.OLInfoWindow=function(mapObject){var self=this;Parent.call(this,mapObject),this.element=$("<div class='wpgmza-infowindow ol-info-window-container ol-info-window-plain'></div>")[0],$(this.element).on("click",".ol-info-window-close",function(event){self.close()})},Parent=WPGMZA.isProVersion()?WPGMZA.ProInfoWindow:WPGMZA.InfoWindow,WPGMZA.OLInfoWindow.prototype=Object.create(Parent.prototype),WPGMZA.OLInfoWindow.prototype.constructor=WPGMZA.OLInfoWindow,Object.defineProperty(WPGMZA.OLInfoWindow.prototype,"isPanIntoViewAllowed",{get:function(){return!0}}),WPGMZA.OLInfoWindow.prototype.open=function(map,mapObject){var self=this,latLng=mapObject.getPosition();if(!Parent.prototype.open.call(this,map,mapObject))return!1;this.parent=map,this.overlay&&this.mapObject.map.olMap.removeOverlay(this.overlay),this.overlay=new ol.Overlay({element:this.element,stopEvent:!1}),this.overlay.setPosition(ol.proj.fromLonLat([latLng.lng,latLng.lat])),self.mapObject.map.olMap.addOverlay(this.overlay),$(this.element).show(),WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER&&WPGMZA.getImageDimensions(mapObject.getIcon(),function(size){$(self.element).css({left:Math.round(size.width/2)+"px"})}),this.trigger("infowindowopen"),this.trigger("domready")},WPGMZA.OLInfoWindow.prototype.close=function(event){$(this.element).hide(),this.overlay&&(WPGMZA.InfoWindow.prototype.close.call(this),this.trigger("infowindowclose"),this.mapObject.map.olMap.removeOverlay(this.overlay),this.overlay=null)},WPGMZA.OLInfoWindow.prototype.setContent=function(html){$(this.element).html("<i class='fa fa-times ol-info-window-close' aria-hidden='true'></i>"+html)},WPGMZA.OLInfoWindow.prototype.setOptions=function(options){options.maxWidth&&$(this.element).css({"max-width":options.maxWidth+"px"})},WPGMZA.OLInfoWindow.prototype.onOpen=function(){var self=this,imgs=$(this.element).find("img"),numImages=imgs.length,numImagesLoaded=0;if(WPGMZA.InfoWindow.prototype.onOpen.apply(this,arguments),this.isPanIntoViewAllowed){function inside(el,viewport){var a=$(el)[0].getBoundingClientRect(),b=$(viewport)[0].getBoundingClientRect();return a.left>=b.left&&a.left<=b.right&&a.right<=b.right&&a.right>=b.left&&a.top>=b.top&&a.top<=b.bottom&&a.bottom<=b.bottom&&a.bottom>=b.top}function panIntoView(){var offset=.45*-$(self.element).height();self.mapObject.map.animateNudge(0,offset,self.mapObject.getPosition())}imgs.each(function(index,el){el.onload=function(){++numImagesLoaded!=numImages||inside(self.element,self.mapObject.map.element)||panIntoView()}}),0!=numImages||inside(self.element,self.mapObject.map.element)||panIntoView()}}}),jQuery(function($){WPGMZA.LatLng.fromJpeg=function(src,callback){var img=new Image;img.onload=function(){EXIF.getData(img,function(){var aLat=EXIF.getTag(img,"GPSLatitude"),aLng=EXIF.getTag(img,"GPSLongitude");if(aLat&&aLng){var latRef=EXIF.getTag(img,"GPSLatitudeRef")||"N",lngRef=EXIF.getTag(img,"GPSLongitudeRef")||"W",fLat=(aLat[0]+aLat[1]/60+aLat[2]/3600)*("N"==latRef?1:-1),fLng=(aLng[0]+aLng[1]/60+aLng[2]/3600)*("W"==lngRef?-1:1);callback(new WPGMZA.LatLng({lat:fLat,lng:fLng}))}else callback(null)})},img.src=src},WPGMZA.LatLng.EXIF_ADDRESS_GEOCODE_KM_THRESHOLD=.5,$(document.body).on("click",".wpgmza-get-location-from-picture[data-source][data-destination]",function(event){var m,url,source=$(this).attr("data-source"),dest=$(this).attr("data-destination"),lat=$(this).attr("data-destination-lat"),lng=$(this).attr("data-destination-lng");if(!$(source).length)throw new Error("Source element not found");if(!$(dest).length)throw new Error("Destination element not found");if($(source).is("img"))url=$(source).attr("src");else{if(!(m=$(source).css("background-image").match(/url\(["'](.+)["'"]\)/)))throw new Error("No background image found");url=m[1]}url&&0!=url.length||alert(WPGMZA.localised_strings.no_picture_found),WPGMZA.LatLng.fromJpeg(url,function(jpegLatLng){if(jpegLatLng){if($(dest).val(jpegLatLng.toString()),lat&&lng&&($(lat).val(jpegLatLng.lat),$(lng).val(jpegLatLng.lng)),!WPGMZA.settings.useRawJpegCoordinates){var geocoder=WPGMZA.Geocoder.createInstance();geocoder.getAddressFromLatLng({latLng:jpegLatLng},function(results,status){if(status==WPGMZA.Geocoder.SUCCESS){var address=results[0];geocoder.getLatLngFromAddress({address:address},function(results,status){if(status==WPGMZA.Geocoder.SUCCESS){var addressLatLng=new WPGMZA.LatLng(results[0].latLng);WPGMZA.Distance.between(addressLatLng,jpegLatLng)<=WPGMZA.LatLng.EXIF_ADDRESS_GEOCODE_KM_THRESHOLD&&$(dest).val(address)}})}})}}else alert(WPGMZA.localized_strings.no_gps_coordinates)})})}),jQuery(function($){"map-edit"==WPGMZA.currentPage&&(WPGMZA.ProMapEditPage=function(){var self=this;WPGMZA.MapEditPage.apply(this,arguments),this.markerPanel=new WPGMZA.ProMarkerPanel,this.directionsOriginIconPicker=new WPGMZA.MarkerIconPicker($("#directions_origin_icon_picker_container > .wpgmza-marker-icon-picker")),this.directionsDestinationIconPicker=new WPGMZA.MarkerIconPicker($("#directions_destination_icon_picker_container > .wpgmza-marker-icon-picker")),this.advancedSettingsMarkerIconPicker=new WPGMZA.MarkerIconPicker($("#advanced-settings-marker-icon-picker-container > .wpgmza-marker-icon-picker")),$("input[name='store_locator_search_area']").on("input",function(event){self.onStoreLocatorSearchAreaChanged(event)}),self.onStoreLocatorSearchAreaChanged(),$("#open-route-service-key-notice").wrapInner("<div class='notice notice-error'><p></p></div>");var store_locator_search_area=$("input[name='store_locator_search_area']");$(store_locator_search_area).on("change",function(){self.onStoreLocatorSearchAreaChanged()}),self.onDirectionsBoxStyle(),$("body").on("change",'[name="directions_box_style"]',function(){self.onDirectionsBoxStyle()})},WPGMZA.extend(WPGMZA.ProMapEditPage,WPGMZA.MapEditPage),WPGMZA.ProMapEditPage.prototype.onStoreLocatorSearchAreaChanged=function(event){var value=$("input[name='store_locator_search_area']:checked").val();$("[data-search-area='"+value+"']").show(),$("[data-search-area][data-search-area!='"+value+"']").hide(),"auto"==value?($(".wpgmza-store-locator-radial-setting").hide(),$("#wpgmza_store_locator_bounce_conditional").hide()):($(".wpgmza-store-locator-radial-setting").show(),$("#wpgmza_store_locator_bounce_conditional").show())},WPGMZA.ProMapEditPage.prototype.onDirectionsBoxStyle=function(){var style=$('[name="directions_box_style"]:checked').val();"modern"==style||"modern"==WPGMZA.settings.user_interface_style?$("#wpgmza-directions-box-open-by-default, #wpgmza-directions-box-width").hide():"default"==style&&$("#wpgmza-directions-box-open-by-default, #wpgmza-directions-box-width").show()})}),jQuery(function($){WPGMZA.ProMapSettingsPage=function(){WPGMZA.MapSettingsPage.call(this)},WPGMZA.extend(WPGMZA.ProMapSettingsPage,WPGMZA.MapSettingsPage),WPGMZA.MapSettingsPage.createInstance=function(){return new WPGMZA.ProMapSettingsPage}}),jQuery(function($){WPGMZA.ProMap=function(element,options){var self=this;this._markersPlaced=!1,this.element=element,WPGMZA.Map.call(this,element,options),this.defaultMarkerIcon=null,this.settings.upload_default_marker&&(this.defaultMarkerIcon=WPGMZA.MarkerIcon.createInstance(this.settings.upload_default_marker)),this.heatmaps=[],this.showDistanceFromLocation=null,this.initCustomFieldFilterController(),this.initUserLocationMarker(),this.on("filteringcomplete",function(){self.onFilteringComplete()}),this.on("init",function(event){self.onInit(event)}),this._onMarkersPlaced=function(event){self.onMarkersPlaced(event)},this.on("markersplaced",this._onMarkersPlaced)},WPGMZA.ProMap.prototype=Object.create(WPGMZA.Map.prototype),WPGMZA.ProMap.prototype.constructor=WPGMZA.ProMap,WPGMZA.ProMap.SHOW_DISTANCE_FROM_USER_LOCATION="user",WPGMZA.ProMap.SHOW_DISTANCE_FROM_SEARCHED_ADDRESS="searched",Object.defineProperty(WPGMZA.ProMap.prototype,"mashupIDs",{get:function(){var result=[],attr=$(this.element).attr("data-mashup-ids");return attr&&attr.length&&(result=attr.split(",")),result}}),Object.defineProperty(WPGMZA.ProMap.prototype,"directionsEnabled",{get:function(){return 1==this.settings.directions_enabled}}),Object.defineProperty(WPGMZA.ProMap.prototype,"markersPlaced",{get:function(){return this._markersPlaced},set:function(value){throw new Error("Value is read only")}}),WPGMZA.ProMap.prototype.onInit=function(event){var zoom,self=this;if(this.initPreloader(),this.initDirectionsBox(),"autoFetchMarkers"in this.settings&&!1===this.settings.autoFetchMarkers||this.fetchMarkers(),this.shortcodeAttributes.lat&&this.shortcodeAttributes.lng){var latLng=new WPGMZA.LatLng({lat:this.shortcodeAttributes.lat,lng:this.shortcodeAttributes.lng});this.setCenter(latLng)}else if(this.shortcodeAttributes.address){WPGMZA.Geocoder.createInstance().geocode({address:this.shortcodeAttributes.address},function(results,status){status==WPGMZA.Geocoder.SUCCESS?self.setCenter(results[0].latLng):console.warn("Shortcode attribute address could not be geocoded")})}(zoom=WPGMZA.getQueryParamValue("mzoom"))&&this.setZoom(zoom),WPGMZA.getCurrentPage()!=WPGMZA.PAGE_MAP_EDIT&&"1"==this.settings.automatically_pan_to_users_location&&WPGMZA.getCurrentPosition(function(result){self.setCenter(new WPGMZA.LatLng({lat:result.coords.latitude,lng:result.coords.longitude})),"1"==self.settings.override_users_location_zoom_level&&self.setZoom(self.settings.override_users_location_zoom_levels)})},WPGMZA.ProMap.prototype.onMarkersPlaced=function(event){var self=this,jumpToNearestMarker=0==WPGMZA.is_admin&&1==self.settings.jump_to_nearest_marker_on_initialization;this.settings.order_markers_by!=WPGMZA.MarkerListing.ORDER_BY_DISTANCE&&1!=this.settings.show_distance_from_location&&!jumpToNearestMarker||WPGMZA.getCurrentPosition(function(result){var location=new WPGMZA.LatLng({lat:result.coords.latitude,lng:result.coords.longitude});self.userLocation=location,self.userLocation.source=WPGMZA.ProMap.SHOW_DISTANCE_FROM_USER_LOCATION,self.showDistanceFromLocation=location,self.updateInfoWindowDistances(),self.markerListing&&(self.markersPlaced?self.markerListing.reload():self.on("markersplaced",function(event){self.markerListing.reload()})),jumpToNearestMarker&&self.panToNearestMarker(location)},function(error){self.markerListing&&self.markerListing.reload()}),self.initMarkerListing(),window.wpgm_g_e&&1==wpgm_g_e&&1==this.settings.mass_marker_support&&(this.markerClusterer.addMarkers(this.markers),"array"==typeof window.markerClusterer&&(window.markerClusterer[this.id]=clusterer)),"1"==this.settings.fit_maps_bounds_to_markers&&self.fitMapBoundsToMarkers()},WPGMZA.ProMap.prototype.panToNearestMarker=function(latlng){var closestMarker,distance=1/0;latlng=latlng||this.getCenter();for(var i=0;i<this.markers.length;i++){var distanceToMarker=WPGMZA.Distance.between(latlng,this.markers[i].getPosition());distanceToMarker<distance&&(closestMarker=this.markers[i],distance=distanceToMarker)}closestMarker&&this.panTo(closestMarker.getPosition(this.setZoom(7)))},WPGMZA.ProMap.prototype.fitBoundsToMarkers=function(markers){var bounds=new WPGMZA.LatLngBounds;markers=markers||this.markers;for(var i=0;i<markers.length;i++){if(!(markers[i]instanceof WPGMZA.Marker))throw new Error("Invalid input, not a WPGMZA.Marker");markers[i].isFiltered||bounds.extend(markers[i])}this.fitBounds(bounds)},WPGMZA.ProMap.prototype.fitMapBoundsToMarkers=WPGMZA.ProMap.prototype.fitBoundsToMarkers,WPGMZA.ProMap.prototype.resetBounds=function(){var latlng=new WPGMZA.LatLng(this.settings.map_start_lat,this.settings.map_start_lng);this.panTo(latlng),this.setZoom(this.settings.map_start_zoom)},WPGMZA.ProMap.prototype.onFilteringComplete=function(){if("1"==this.settings.fit_maps_bounds_to_markers_after_filtering){for(var areMarkersVisible=!1,i=0;i<this.markers.length;i++)if(!this.markers[i].isFiltered){areMarkersVisible=!0;break}areMarkersVisible&&this.fitBoundsToMarkers()}},WPGMZA.ProMap.prototype.initPreloader=function(){this.preloader=$("<div class='wpgmza-preloader'><div></div><div></div><div></div><div></div></div>"),$(this.preloader).hide(),$(this.element).append(this.preloader)},WPGMZA.ProMap.prototype.showPreloader=function(show){show?$(this.preloader).show():$(this.preloader).hide()},WPGMZA.ProMap.prototype.initMarkerListing=function(){if("1"!=WPGMZA.is_admin){var markerListingElement=$("[data-wpgmza-marker-listing][id$='_"+this.id+"']");this.markerListing=WPGMZA.MarkerListing.createInstance(this,markerListingElement[0]),this.off("markersplaced",this._onMarkersPlaced),delete this._onMarkersPlaced}},WPGMZA.ProMap.prototype.initCustomFieldFilterController=function(){this.customFieldFilterController=WPGMZA.CustomFieldFilterController.createInstance(this.id)},WPGMZA.ProMap.prototype.initUserLocationMarker=function(){var self=this;if(1==this.settings.show_user_location){var icon=this.settings.upload_default_ul_marker,options={id:WPGMZA.guid(),animation:WPGMZA.Marker.ANIMATION_DROP};icon&&icon.length&&(options.icon=icon);var marker=WPGMZA.Marker.createInstance(options);marker.isFilterable=!1,marker.setOptions({zIndex:999999}),WPGMZA.watchPosition(function(position){marker.setPosition({lat:position.coords.latitude,lng:position.coords.longitude}),marker.map||self.addMarker(marker),self.userLocationMarker||(self.userLocationMarker=marker,self.trigger("userlocationmarkerplaced")),jQuery("body").find(".wpgmza-directions-from").val(position.coords.latitude+", "+position.coords.longitude)})}},WPGMZA.ProMap.prototype.initDirectionsBox=function(){1!=WPGMZA.is_admin&&this.directionsEnabled&&(this.directionsBox=WPGMZA.DirectionsBox.createInstance(this))},WPGMZA.ProMap.prototype.getMapObjectArrays=function(){var arrays=WPGMZA.Map.prototype.getMapObjectArrays.call(this);return arrays.heatmaps=this.heatmaps,arrays},WPGMZA.ProMap.prototype.addHeatmap=function(heatmap){if(!(heatmap instanceof WPGMZA.Heatmap))throw new Error("Argument must be an instance of WPGMZA.Heatmap");(heatmap.map=this).heatmaps.push(heatmap),this.dispatchEvent({type:"heatmapadded",heatmap:heatmap})},WPGMZA.ProMap.prototype.getHeatmapByID=function(id){for(var i=0;i<this.heatmaps.length;i++)if(this.heatmaps[i].id==id)return this.heatmaps[i];return null},WPGMZA.ProMap.prototype.removeHeatmap=function(heatmap){if(!(heatmap instanceof WPGMZA.Heatmap))throw new Error("Argument must be an instance of WPGMZA.Heatmap");if(heatmap.map!=this)throw new Error("Wrong map error");heatmap.map=null,heatmap.googleHeatmap.setMap(null),this.heatmaps.splice(this.heatmaps.indexOf(heatmap),1),this.dispatchEvent({type:"heatmapremoved",heatmap:heatmap})},WPGMZA.ProMap.prototype.removeHeatmapByID=function(id){var heatmap=this.getHeatmapByID(id);heatmap&&this.removeHeatmap(heatmap)},WPGMZA.ProMap.prototype.getInfoWindowStyle=function(){if(!this.settings.other_settings)return WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE;var local=this.settings.other_settings.wpgmza_iw_type,global=WPGMZA.settings.wpgmza_iw_type;return"-1"==local&&"-1"==global?WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE:"-1"==local?global:local||WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE},WPGMZA.ProMap.prototype.fetchMarkers=function(){var self=this;if(WPGMZA.settings.wpgmza_settings_marker_pull!=WPGMZA.MARKER_PULL_XML||"1"==WPGMZA.is_admin){var data,request,filter={map_id:this.id,mashup_ids:this.mashupIDs};"1"==WPGMZA.is_admin&&(filter.includeUnapproved=!0,filter.excludeIntegrated=!0),this.shortcodeAttributes.acf_post_id&&($.isNumeric(this.shortcodeAttributes.acf_post_id)?filter.acf_post_id=this.shortcodeAttributes.acf_post_id:"this"==this.shortcodeAttributes.acf_post_id&&(filter.acf_post_id=WPGMZA.postID)),request={useCompressedPathVariable:!0,data:data={filter:JSON.stringify(filter)},success:function(data,status,xhr){self.onMarkersFetched(data)}},1==WPGMZA.is_admin&&(data.skip_cache=1,request.useCompressedPathVariable=!1),this.showPreloader(!0),WPGMZA.restAPI.call("/markers/",request)}else{var urls=[WPGMZA.markerXMLPathURL+this.id+"markers.xml"];if(this.mashupIDs&&this.mashupIDs.forEach(function(id){urls.push(WPGMZA.markerXMLPathURL+id+"markers.xml")}),urls=urls.filter(function(item,index){return urls.indexOf(item)==index}),window.Worker&&window.Blob&&window.URL&&WPGMZA.settings.enable_asynchronous_xml_parsing){var source=WPGMZA.loadXMLAsWebWorker.toString().replace(/function\(\)\s*{([\s\S]+)}/,"$1"),blob=new Blob([source],{type:"text/javascript"}),worker=new Worker(URL.createObjectURL(blob));worker.onmessage=function(event){self.onMarkersFetched(event.data)},worker.postMessage({command:"load",protocol:window.location.protocol,urls:urls})}else for(var filesLoaded=0,converter=new WPGMZA.XMLCacheConverter,converted=[],i=0;i<urls.length;i++)$.ajax(urls[i],{success:function(response,status,xhr){converted=converted.concat(converter.convert(response)),++filesLoaded==urls.length&&self.onMarkersFetched(converted)}})}},WPGMZA.ProMap.prototype.onMarkersFetched=function(data){var self=this,startFiltered=this.shortcodeAttributes.cat&&this.shortcodeAttributes.cat.length;this.showPreloader(!1);for(var i=0;i<data.length;i++){var obj=data[i],marker=WPGMZA.Marker.createInstance(obj);startFiltered&&(marker.isFiltered=!0,marker.setVisible(!1)),this.addMarker(marker),window.marker_array&&(marker_array[this.id][obj.id]=marker)}var triggerEvent=function(){self._markersPlaced=!0,self.trigger("markersplaced"),self.off("filteringcomplete",triggerEvent)};if(this.shortcodeAttributes.cat){var categories=this.shortcodeAttributes.cat.split(","),select=$("select[mid='"+this.id+"'][name='wpgmza_filter_select']");for(i=0;i<categories.length;i++)$("input[type='checkbox'][mid='"+this.id+"'][value='"+categories[i]+"']").prop("checked",!0),select.val(categories[i]);this.on("filteringcomplete",triggerEvent),this.markerFilter.update({categories:categories})}else triggerEvent();if(this.shortcodeAttributes.markers){var arr=this.shortcodeAttributes.markers.split(","),markers=[];for(i=0;i<arr.length;i++){var id=arr[i];id=id.replace(" ","");marker=this.getMarkerByID(id);markers.push(marker)}this.fitMapBoundsToMarkers(markers)}this.shortcodeAttributes.acf_post_id&&marker.trigger("select")},WPGMZA.ProMap.prototype.updateInfoWindowDistances=function(){this.showDistanceFromLocation;this.markers.forEach(function(marker){marker.infoWindow&&marker.infoWindow.updateDistanceFromLocation()})},WPGMZA.ProMap.prototype.hasVisibleMarkers=function(){for(var markers=this.markers,i=0;i<markers.length;i++)if(markers[i].isFilterable&&markers[i].getVisible())return!0;return!1}}),jQuery(function($){var Parent;WPGMZA.GoogleMap=function(element,options){var self=this;if(Parent.call(this,element,options),!window.google){var status=WPGMZA.googleAPIStatus,message="Google API not loaded";if(status&&status.message&&(message+=" - "+status.message),"USER_CONSENT_NOT_GIVEN"==status.code)return;throw $(element).html("<div class='notice notice-error'><p>"+WPGMZA.localized_strings.google_api_not_loaded+"<pre>"+message+"</pre></p></div>"),new Error(message)}this.loadGoogleMap(),options&&this.setOptions(options,!0),google.maps.event.addListener(this.googleMap,"click",function(event){var wpgmzaEvent=new WPGMZA.Event("click");wpgmzaEvent.latLng={lat:event.latLng.lat(),lng:event.latLng.lng()},self.dispatchEvent(wpgmzaEvent)}),google.maps.event.addListener(this.googleMap,"rightclick",function(event){var wpgmzaEvent=new WPGMZA.Event("rightclick");wpgmzaEvent.latLng={lat:event.latLng.lat(),lng:event.latLng.lng()},self.dispatchEvent(wpgmzaEvent)}),google.maps.event.addListener(this.googleMap,"dragend",function(event){self.dispatchEvent("dragend")}),google.maps.event.addListener(this.googleMap,"zoom_changed",function(event){self.dispatchEvent("zoom_changed"),self.dispatchEvent("zoomchanged")}),google.maps.event.addListener(this.googleMap,"idle",function(event){self.onIdle(event)}),WPGMZA.isProVersion()||(this.trigger("init"),this.dispatchEvent("created"),WPGMZA.events.dispatchEvent({type:"mapcreated",map:this}),$(this.element).trigger("wpgooglemaps_loaded"))},WPGMZA.isProVersion()?(Parent=WPGMZA.ProMap,WPGMZA.GoogleMap.prototype=Object.create(WPGMZA.ProMap.prototype)):(Parent=WPGMZA.Map,WPGMZA.GoogleMap.prototype=Object.create(WPGMZA.Map.prototype)),WPGMZA.GoogleMap.prototype.constructor=WPGMZA.GoogleMap,WPGMZA.GoogleMap.parseThemeData=function(raw){var json;try{json=JSON.parse(raw)}catch(e){try{json=eval(raw)}catch(e){var str=raw;str=str.replace(/\\'/g,"'"),str=str.replace(/\\"/g,'"'),str=str.replace(/\\0/g,"\0"),str=str.replace(/\\\\/g,"\\");try{json=eval(str)}catch(e){return console.warn("Couldn't parse theme data"),[]}}}return json},WPGMZA.GoogleMap.prototype.loadGoogleMap=function(){var self=this,options=this.settings.toGoogleMapsOptions();this.googleMap=new google.maps.Map(this.engineElement,options),google.maps.event.addListener(this.googleMap,"bounds_changed",function(){self.onBoundsChanged()}),1==this.settings.bicycle&&this.enableBicycleLayer(!0),1==this.settings.traffic&&this.enableTrafficLayer(!0),1==this.settings.transport&&this.enablePublicTransportLayer(!0),this.showPointsOfInterest(this.settings.show_point_of_interest),$(this.engineElement).append($(this.element).find(".wpgmza-loader"))},WPGMZA.GoogleMap.prototype.setOptions=function(options,initializing){if(Parent.prototype.setOptions.call(this,options),options.scrollwheel&&delete options.scrollwheel,initializing){var converted=$.extend(options,this.settings.toGoogleMapsOptions()),clone=$.extend({},converted);if(!clone.center instanceof google.maps.LatLng&&(clone.center instanceof WPGMZA.LatLng||"object"==typeof clone.center)&&(clone.center={lat:parseFloat(clone.center.lat),lng:parseFloat(clone.center.lng)}),"1"==this.settings.hide_point_of_interest){clone.styles||(clone.styles=[]),clone.styles.push({featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]})}this.googleMap.setOptions(clone)}else this.googleMap.setOptions(options)},WPGMZA.GoogleMap.prototype.addMarker=function(marker){marker.googleMarker.setMap(this.googleMap),Parent.prototype.addMarker.call(this,marker)},WPGMZA.GoogleMap.prototype.removeMarker=function(marker){marker.googleMarker.setMap(null),Parent.prototype.removeMarker.call(this,marker)},WPGMZA.GoogleMap.prototype.addPolygon=function(polygon){polygon.googlePolygon.setMap(this.googleMap),Parent.prototype.addPolygon.call(this,polygon)},WPGMZA.GoogleMap.prototype.removePolygon=function(polygon){polygon.googlePolygon.setMap(null),Parent.prototype.removePolygon.call(this,polygon)},WPGMZA.GoogleMap.prototype.addPolyline=function(polyline){polyline.googlePolyline.setMap(this.googleMap),Parent.prototype.addPolyline.call(this,polyline)},WPGMZA.GoogleMap.prototype.removePolyline=function(polyline){polyline.googlePolyline.setMap(null),Parent.prototype.removePolyline.call(this,polyline)},WPGMZA.GoogleMap.prototype.addCircle=function(circle){circle.googleCircle.setMap(this.googleMap),Parent.prototype.addCircle.call(this,circle)},WPGMZA.GoogleMap.prototype.removeCircle=function(circle){circle.googleCircle.setMap(null),Parent.prototype.removeCircle.call(this,circle)},WPGMZA.GoogleMap.prototype.addRectangle=function(rectangle){rectangle.googleRectangle.setMap(this.googleMap),Parent.prototype.addRectangle.call(this,rectangle)},WPGMZA.GoogleMap.prototype.removeRectangle=function(rectangle){rectangle.googleRectangle.setMap(null),Parent.prototype.removeRectangle.call(this,rectangle)},WPGMZA.GoogleMap.prototype.getCenter=function(){var latLng=this.googleMap.getCenter();return{lat:latLng.lat(),lng:latLng.lng()}},WPGMZA.GoogleMap.prototype.setCenter=function(latLng){WPGMZA.Map.prototype.setCenter.call(this,latLng),latLng instanceof WPGMZA.LatLng?this.googleMap.setCenter({lat:latLng.lat,lng:latLng.lng}):this.googleMap.setCenter(latLng)},WPGMZA.GoogleMap.prototype.panTo=function(latLng){latLng instanceof WPGMZA.LatLng?this.googleMap.panTo({lat:latLng.lat,lng:latLng.lng}):this.googleMap.panTo(latLng)},WPGMZA.GoogleMap.prototype.getZoom=function(){return this.googleMap.getZoom()},WPGMZA.GoogleMap.prototype.setZoom=function(value){if(isNaN(value))throw new Error("Value must not be NaN");return this.googleMap.setZoom(parseInt(value))},WPGMZA.GoogleMap.prototype.getBounds=function(){var bounds=this.googleMap.getBounds(),northEast=bounds.getNorthEast(),southWest=bounds.getSouthWest(),nativeBounds=new WPGMZA.LatLngBounds({});return nativeBounds.north=northEast.lat(),nativeBounds.south=southWest.lat(),nativeBounds.west=southWest.lng(),nativeBounds.east=northEast.lng(),nativeBounds.topLeft={lat:northEast.lat(),lng:southWest.lng()},nativeBounds.bottomRight={lat:southWest.lat(),lng:northEast.lng()},nativeBounds},WPGMZA.GoogleMap.prototype.fitBounds=function(southWest,northEast){if(southWest instanceof WPGMZA.LatLng&&(southWest={lat:southWest.lat,lng:southWest.lng}),northEast instanceof WPGMZA.LatLng)northEast={lat:northEast.lat,lng:northEast.lng};else if(southWest instanceof WPGMZA.LatLngBounds){var bounds=southWest;southWest={lat:bounds.south,lng:bounds.west},northEast={lat:bounds.north,lng:bounds.east}}var nativeBounds=new google.maps.LatLngBounds(southWest,northEast);this.googleMap.fitBounds(nativeBounds)},WPGMZA.GoogleMap.prototype.fitBoundsToVisibleMarkers=function(){for(var bounds=new google.maps.LatLngBounds,i=0;i<this.markers.length;i++)markers[i].getVisible()&&bounds.extend(markers[i].getPosition());this.googleMap.fitBounds(bounds)},WPGMZA.GoogleMap.prototype.enableBicycleLayer=function(enable){this.bicycleLayer||(this.bicycleLayer=new google.maps.BicyclingLayer),this.bicycleLayer.setMap(enable?this.googleMap:null)},WPGMZA.GoogleMap.prototype.enableTrafficLayer=function(enable){this.trafficLayer||(this.trafficLayer=new google.maps.TrafficLayer),this.trafficLayer.setMap(enable?this.googleMap:null)},WPGMZA.GoogleMap.prototype.enablePublicTransportLayer=function(enable){this.publicTransportLayer||(this.publicTransportLayer=new google.maps.TransitLayer),this.publicTransportLayer.setMap(enable?this.googleMap:null)},WPGMZA.GoogleMap.prototype.showPointsOfInterest=function(show){var text=$("textarea[name='theme_data']").val();if(text){var styles=JSON.parse(text);styles.push({featureType:"poi",stylers:[{visibility:show?"on":"off"}]}),this.googleMap.setOptions({styles:styles})}},WPGMZA.GoogleMap.prototype.getMinZoom=function(){return parseInt(this.settings.min_zoom)},WPGMZA.GoogleMap.prototype.setMinZoom=function(value){this.googleMap.setOptions({minZoom:value,maxZoom:this.getMaxZoom()})},WPGMZA.GoogleMap.prototype.getMaxZoom=function(){return parseInt(this.settings.max_zoom)},WPGMZA.GoogleMap.prototype.setMaxZoom=function(value){this.googleMap.setOptions({minZoom:this.getMinZoom(),maxZoom:value})},WPGMZA.GoogleMap.prototype.latLngToPixels=function(latLng){var map=this.googleMap,nativeLatLng=new google.maps.LatLng({lat:parseFloat(latLng.lat),lng:parseFloat(latLng.lng)}),topRight=map.getProjection().fromLatLngToPoint(map.getBounds().getNorthEast()),bottomLeft=map.getProjection().fromLatLngToPoint(map.getBounds().getSouthWest()),scale=Math.pow(2,map.getZoom()),worldPoint=map.getProjection().fromLatLngToPoint(nativeLatLng);return{x:(worldPoint.x-bottomLeft.x)*scale,y:(worldPoint.y-topRight.y)*scale}},WPGMZA.GoogleMap.prototype.pixelsToLatLng=function(x,y){null==y&&("x"in x&&"y"in x?(y=x.y,x=x.x):console.warn("Y coordinate undefined in pixelsToLatLng (did you mean to pass 2 arguments?)"));var map=this.googleMap,topRight=map.getProjection().fromLatLngToPoint(map.getBounds().getNorthEast()),bottomLeft=map.getProjection().fromLatLngToPoint(map.getBounds().getSouthWest()),scale=Math.pow(2,map.getZoom()),worldPoint=new google.maps.Point(x/scale+bottomLeft.x,y/scale+topRight.y),latLng=map.getProjection().fromPointToLatLng(worldPoint);return{lat:latLng.lat(),lng:latLng.lng()}},WPGMZA.GoogleMap.prototype.onElementResized=function(event){this.googleMap&&google.maps.event.trigger(this.googleMap,"resize")},WPGMZA.GoogleMap.prototype.enableAllInteractions=function(){var options={scrollwheel:!0,draggable:!0,disableDoubleClickZoom:!1};this.googleMap.setOptions(options)}}),jQuery(function($){var Parent;WPGMZA.OLMap=function(element,options){var self=this;Parent.call(this,element),this.setOptions(options);var marker,viewOptions=this.settings.toOLViewOptions();$(this.element).html(""),this.olMap=new ol.Map({target:$(element)[0],layers:[this.getTileLayer()],view:new ol.View(viewOptions)}),this.olMap.getInteractions().forEach(function(interaction){interaction instanceof ol.interaction.DragPan?interaction.setActive("yes"!=self.settings.wpgmza_settings_map_draggable):interaction instanceof ol.interaction.DoubleClickZoom?interaction.setActive(!self.settings.wpgmza_settings_map_clickzoom):interaction instanceof ol.interaction.MouseWheelZoom&&interaction.setActive("yes"!=self.settings.wpgmza_settings_map_scroll)},this),"greedy"!=this.settings.wpgmza_force_greedy_gestures&&"yes"!=this.settings.wpgmza_force_greedy_gestures&&(this.gestureOverlay=$("<div class='wpgmza-gesture-overlay'></div>"),this.gestureOverlayTimeoutID=null,WPGMZA.isTouchDevice()||(this.olMap.on("wheel",function(event){if(!ol.events.condition.platformModifierKeyOnly(event))return self.showGestureOverlay(),event.originalEvent.preventDefault(),!1}),this.gestureOverlay.text(WPGMZA.localized_strings.use_ctrl_scroll_to_zoom))),this.olMap.getControls().forEach(function(control){control instanceof ol.control.Zoom&&"yes"==WPGMZA.settings.wpgmza_settings_map_zoom&&self.olMap.removeControl(control)},this),"yes"!=WPGMZA.settings.wpgmza_settings_map_full_screen_control&&this.olMap.addControl(new ol.control.FullScreen),WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER&&(this.markerLayer=new ol.layer.Vector({source:new ol.source.Vector({features:[]})}),this.olMap.addLayer(this.markerLayer),this.olMap.on("click",function(event){var features=self.olMap.getFeaturesAtPixel(event.pixel);if(features&&features.length){var marker=features[0].wpgmzaMarker;marker&&(marker.trigger("click"),marker.trigger("select"))}})),this.olMap.on("movestart",function(event){self.isBeingDragged=!0}),this.olMap.on("moveend",function(event){self.wrapLongitude(),self.isBeingDragged=!1,self.dispatchEvent("dragend"),self.onIdle()}),this.olMap.getView().on("change:resolution",function(event){self.dispatchEvent("zoom_changed"),self.dispatchEvent("zoomchanged"),setTimeout(function(){self.onIdle()},10)}),this.olMap.getView().on("change",function(){self.onBoundsChanged()}),self.onBoundsChanged(),this.storeLocator&&(marker=this.storeLocator.centerPointMarker)&&(this.olMap.addOverlay(marker.overlay),marker.setVisible(!1)),$(this.element).on("click contextmenu",function(event){var isRight;event=event||window.event;var latLng=self.pixelsToLatLng(event.offsetX,event.offsetY);if("which"in event?isRight=3==event.which:"button"in event&&(isRight=2==event.button),1!=event.which&&1!=event.button){if(isRight)return self.onRightClick(event)}else{if(self.isBeingDragged)return;if($(event.target).closest(".ol-marker").length)return;self.trigger({type:"click",latLng:latLng})}}),WPGMZA.isProVersion()||(this.trigger("init"),this.dispatchEvent("created"),WPGMZA.events.dispatchEvent({type:"mapcreated",map:this}),$(this.element).trigger("wpgooglemaps_loaded"))},Parent=WPGMZA.isProVersion()?WPGMZA.ProMap:WPGMZA.Map,WPGMZA.OLMap.prototype=Object.create(Parent.prototype),WPGMZA.OLMap.prototype.constructor=WPGMZA.OLMap,WPGMZA.OLMap.prototype.getTileLayer=function(){var options={};return WPGMZA.settings.tile_server_url&&(options.url=WPGMZA.settings.tile_server_url),new ol.layer.Tile({source:new ol.source.OSM(options)})},WPGMZA.OLMap.prototype.wrapLongitude=function(){var transformed=ol.proj.transform(this.olMap.getView().getCenter(),"EPSG:3857","EPSG:4326"),center={lat:transformed[1],lng:transformed[0]};-180<=center.lng&&center.lng<=180||(center.lng=center.lng-360*Math.floor(center.lng/360),180<center.lng&&(center.lng-=360),this.setCenter(center))},WPGMZA.OLMap.prototype.getCenter=function(){var lonLat=ol.proj.toLonLat(this.olMap.getView().getCenter());return{lat:lonLat[1],lng:lonLat[0]}},WPGMZA.OLMap.prototype.setCenter=function(latLng){var view=this.olMap.getView();WPGMZA.Map.prototype.setCenter.call(this,latLng),view.setCenter(ol.proj.fromLonLat([latLng.lng,latLng.lat])),this.wrapLongitude(),this.onBoundsChanged()},WPGMZA.OLMap.prototype.getBounds=function(){var bounds=this.olMap.getView().calculateExtent(this.olMap.getSize()),nativeBounds=new WPGMZA.LatLngBounds,topLeft=ol.proj.toLonLat([bounds[0],bounds[1]]),bottomRight=ol.proj.toLonLat([bounds[2],bounds[3]]);return nativeBounds.north=topLeft[1],nativeBounds.south=bottomRight[1],nativeBounds.west=topLeft[0],nativeBounds.east=bottomRight[0],nativeBounds},WPGMZA.OLMap.prototype.fitBounds=function(southWest,northEast){if(southWest instanceof WPGMZA.LatLng&&(southWest={lat:southWest.lat,lng:southWest.lng}),northEast instanceof WPGMZA.LatLng)northEast={lat:northEast.lat,lng:northEast.lng};else if(southWest instanceof WPGMZA.LatLngBounds){var bounds=southWest;southWest={lat:bounds.south,lng:bounds.west},northEast={lat:bounds.north,lng:bounds.east}}var view=this.olMap.getView(),extent=ol.extent.boundingExtent([ol.proj.fromLonLat([parseFloat(southWest.lng),parseFloat(southWest.lat)]),ol.proj.fromLonLat([parseFloat(northEast.lng),parseFloat(northEast.lat)])]);view.fit(extent,this.olMap.getSize())},WPGMZA.OLMap.prototype.panTo=function(latLng,zoom){var view=this.olMap.getView(),options={center:ol.proj.fromLonLat([parseFloat(latLng.lng),parseFloat(latLng.lat)]),duration:500};1<arguments.length&&(options.zoom=parseInt(zoom)),view.animate(options)},WPGMZA.OLMap.prototype.getZoom=function(){return Math.round(this.olMap.getView().getZoom())},WPGMZA.OLMap.prototype.setZoom=function(value){this.olMap.getView().setZoom(value)},WPGMZA.OLMap.prototype.getMinZoom=function(){return this.olMap.getView().getMinZoom()},WPGMZA.OLMap.prototype.setMinZoom=function(value){this.olMap.getView().setMinZoom(value)},WPGMZA.OLMap.prototype.getMaxZoom=function(){return this.olMap.getView().getMaxZoom()},WPGMZA.OLMap.prototype.setMaxZoom=function(value){this.olMap.getView().setMaxZoom(value)},WPGMZA.OLMap.prototype.setOptions=function(options){Parent.prototype.setOptions.call(this,options),this.olMap&&this.olMap.getView().setProperties(this.settings.toOLViewOptions())},WPGMZA.OLMap.prototype.addMarker=function(marker){WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_HTML_ELEMENT?this.olMap.addOverlay(marker.overlay):(this.markerLayer.getSource().addFeature(marker.feature),marker.featureInSource=!0),Parent.prototype.addMarker.call(this,marker)},WPGMZA.OLMap.prototype.removeMarker=function(marker){WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_HTML_ELEMENT?this.olMap.removeOverlay(marker.overlay):(this.markerLayer.getSource().removeFeature(marker.feature),marker.featureInSource=!1),Parent.prototype.removeMarker.call(this,marker)},WPGMZA.OLMap.prototype.addPolygon=function(polygon){this.olMap.addLayer(polygon.layer),Parent.prototype.addPolygon.call(this,polygon)},WPGMZA.OLMap.prototype.removePolygon=function(polygon){this.olMap.removeLayer(polygon.layer),Parent.prototype.removePolygon.call(this,polygon)},WPGMZA.OLMap.prototype.addPolyline=function(polyline){this.olMap.addLayer(polyline.layer),Parent.prototype.addPolyline.call(this,polyline)},WPGMZA.OLMap.prototype.removePolyline=function(polyline){this.olMap.removeLayer(polyline.layer),Parent.prototype.removePolyline.call(this,polyline)},WPGMZA.OLMap.prototype.addCircle=function(circle){this.olMap.addLayer(circle.layer),Parent.prototype.addCircle.call(this,circle)},WPGMZA.OLMap.prototype.removeCircle=function(circle){this.olMap.removeLayer(circle.layer),Parent.prototype.removeCircle.call(this,circle)},WPGMZA.OLMap.prototype.addRectangle=function(rectangle){this.olMap.addLayer(rectangle.layer),Parent.prototype.addRectangle.call(this,rectangle)},WPGMZA.OLMap.prototype.removeRectangle=function(rectangle){this.olMap.removeLayer(rectangle.layer),Parent.prototype.removeRectangle.call(this,rectangle)},WPGMZA.OLMap.prototype.pixelsToLatLng=function(x,y){null==y&&("x"in x&&"y"in x?(y=x.y,x=x.x):console.warn("Y coordinate undefined in pixelsToLatLng (did you mean to pass 2 arguments?)"));var coord=this.olMap.getCoordinateFromPixel([x,y]);if(!coord)return{x:null,y:null};var lonLat=ol.proj.toLonLat(coord);return{lat:lonLat[1],lng:lonLat[0]}},WPGMZA.OLMap.prototype.latLngToPixels=function(latLng){var coord=ol.proj.fromLonLat([latLng.lng,latLng.lat]),pixel=this.olMap.getPixelFromCoordinate(coord);return pixel?{x:pixel[0],y:pixel[1]}:{x:null,y:null}},WPGMZA.OLMap.prototype.enableBicycleLayer=function(value){if(value)this.bicycleLayer||(this.bicycleLayer=new ol.layer.Tile({source:new ol.source.OSM({url:"http://{a-c}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png"})})),this.olMap.addLayer(this.bicycleLayer);else{if(!this.bicycleLayer)return;this.olMap.removeLayer(this.bicycleLayer)}},WPGMZA.OLMap.prototype.showGestureOverlay=function(){var self=this;clearTimeout(this.gestureOverlayTimeoutID),$(this.gestureOverlay).stop().animate({opacity:"100"}),$(this.element).append(this.gestureOverlay),$(this.gestureOverlay).css({"line-height":$(this.element).height()+"px",opacity:"1.0"}),$(this.gestureOverlay).show(),this.gestureOverlayTimeoutID=setTimeout(function(){self.gestureOverlay.fadeOut(2e3)},2e3)},WPGMZA.OLMap.prototype.onElementResized=function(event){this.olMap.updateSize()},WPGMZA.OLMap.prototype.onRightClick=function(event){if($(event.target).closest(".ol-marker, .wpgmza_modern_infowindow, .wpgmza-modern-store-locator").length)return!0;var parentOffset=$(this.element).offset(),relX=event.pageX-parentOffset.left,relY=event.pageY-parentOffset.top,latLng=this.pixelsToLatLng(relX,relY);return this.trigger({type:"rightclick",latLng:latLng}),$(this.element).trigger({type:"rightclick",latLng:latLng}),event.preventDefault(),!1},WPGMZA.OLMap.prototype.enableAllInteractions=function(){this.olMap.getInteractions().forEach(function(interaction){(interaction instanceof ol.interaction.DragPan||interaction instanceof ol.interaction.DoubleClickZoom||interaction instanceof ol.interaction.MouseWheelZoom)&&interaction.setActive(!0)},this)}}),jQuery(function($){WPGMZA.ProMarkerFilter=function(map){WPGMZA.MarkerFilter.call(this,map)},WPGMZA.ProMarkerFilter.prototype=Object.create(WPGMZA.MarkerFilter.prototype),WPGMZA.ProMarkerFilter.prototype.constructor=WPGMZA.ProMarkerFilter,WPGMZA.MarkerFilter.createInstance=function(map){return new WPGMZA.ProMarkerFilter(map)},WPGMZA.ProMarkerFilter.prototype.getFilteringParameters=function(){var params=WPGMZA.MarkerFilter.prototype.getFilteringParameters.call(this),mashupIDs=this.map.mashupIDs;if(mashupIDs&&(params.mashupIDs=mashupIDs),this.map.markerListing&&(params=$.extend(params,this.map.markerListing.getFilteringParameters())),this.map.customFieldFilterController){var customFieldFilterFilteringParams=this.map.customFieldFilterController.getAjaxRequestData().data.widgetData;params.customFields=customFieldFilterFilteringParams}return params},WPGMZA.ProMarkerFilter.prototype.update=function(params,source){var self=this;function dispatchEvent(result){var event=new WPGMZA.Event("filteringcomplete");event.map=self.map,event.source=source,event.filteredMarkers=result,event.filteringParams=params,self.onFilteringComplete(event),self.trigger(event),self.map.trigger(event)}this.updateTimeoutID||(params=params||{},this.xhr&&(this.xhr.abort(),delete this.xhr),this.updateTimeoutID=setTimeout(function(){if((params=$.extend(self.getFilteringParameters(),params)).center instanceof WPGMZA.LatLng&&(params.center=params.center.toLatLngLiteral()),params.hideAll)return dispatchEvent([]),void delete self.updateTimeoutID;self.map.showPreloader(!0),self.xhr=WPGMZA.restAPI.call("/markers",{data:{fields:["id"],filter:JSON.stringify(params)},success:function(result,status,xhr){self.map.showPreloader(!1),dispatchEvent(result)},useCompressedPathVariable:!0}),delete self.updateTimeoutID},0))},WPGMZA.ProMarkerFilter.prototype.onFilteringComplete=function(event){var map=[];event.filteredMarkers.forEach(function(data){map[data.id]=!0}),this.map.markers.forEach(function(marker){if(marker.isFilterable){var allowByFilter=!!map[marker.id];marker.isFiltered=!allowByFilter,marker.setVisible(allowByFilter)}})}}),jQuery(function($){WPGMZA.ProMarkerPanel=function(){var self=this;this.element=$(".wpgmza-marker-panel"),this.initAutoComplete(),this.initMarkerIconPicker(),this.initMarkerGalleryInput(),this.initCategoryPicker(),this.addressChanged=!1,$(this.element).find("button.wpgmza-save-marker").on("click",function(event){self.onSave(event)}),$(document.body).on("click","[data-edit-marker-id]",function(event){self.onEditMarker(event)}),$(this.element).find("input[data-ajax-name='address']").on("input change",function(event){self.onAddressChanged(event)})},WPGMZA.ProMarkerPanel.prototype.initAutoComplete=function(){window.google&&google.maps&&(window.google.maps.places?this.autoComplete=new google.maps.places.Autocomplete(this.element.find("[data-ajax-name='address']")[0]):console.warn("Please enable the Places API to use address autocomplete"))},WPGMZA.ProMarkerPanel.prototype.initMarkerIconPicker=function(){this.markerIconPicker=new WPGMZA.MarkerIconPicker($(this.element).find(".wpgmza-marker-icon-picker"))},WPGMZA.ProMarkerPanel.prototype.initMarkerGalleryInput=function(){this.markerGalleryInput=new WPGMZA.MarkerGalleryInput($(this.element).find("input[data-ajax-name='gallery']"))},WPGMZA.ProMarkerPanel.prototype.initCategoryPicker=function(){this.categoryPicker=new WPGMZA.CategoryPicker($(this.element).find(".wpgmza-category-picker"))},WPGMZA.ProMarkerPanel.prototype.showPleaseWaitButton=function(){$(this.element).find("button.wpgmza-save-marker").text(WPGMZA.localized_strings.add_marker),$(this.element).find("button.wpgmza-save-marker").prop("disabled",!0)},WPGMZA.ProMarkerPanel.prototype.restoreSaveButton=function(){"-1"==$(this.element).find("[data-ajax-name='id']").val()?$(this.element).find("button.wpgmza-save-marker").text(WPGMZA.localized_strings.add_marker):$(this.element).find("button.wpgmza-save-marker").text(WPGMZA.localized_strings.save_marker),$(this.element).find("button.wpgmza-save-marker").prop("disabled",!1)},WPGMZA.ProMarkerPanel.prototype.reset=function(){$(this.element).find("[data-ajax-name='id']").val("-1"),$(this.element).find("[data-ajax-name]:not([data-ajax-name='map_id'])").val(""),$(this.element).find("select[data-ajax-name]>option:first-child").prop("selected",!0),$(this.element).find("input[type='checkbox']").prop("checked",!1),tinyMCE.get("wpgmza-description-editor")?tinyMCE.get("wpgmza-description-editor").setContent(""):$("#wpgmza-description-editor").val(""),this.markerIconPicker.reset(),this.categoryPicker.setSelection(null),this.markerGalleryInput.clear(),this.restoreSaveButton(),this.addressChanged=!1},WPGMZA.ProMarkerPanel.prototype.select=function(marker){var self=this;this.reset(),this.showPleaseWaitButton(),WPGMZA.restAPI.call("/markers/"+marker.id+"?skip_cache=1&raw_data=true",{success:function(data,status,xhr){self.populate(data),self.restoreSaveButton()}})},WPGMZA.ProMarkerPanel.prototype.populate=function(data){for(var name in data){switch(name){case"description":tinyMCE.get("wpgmza-description-editor")?tinyMCE.get("wpgmza-description-editor").setContent(data.description):$("#wpgmza-description-editor").val(data.description);break;case"icon":this.markerIconPicker.setIcon(data.icon);continue;case"categories":this.categoryPicker.setSelection(data.categories);break;case"gallery":data.gallery&&this.markerGalleryInput.populate(data.gallery);break;case"custom_field_data":data.custom_field_data.forEach(function(field){$("fieldset[data-custom-field-id='"+field.id+"'] input[data-ajax-name]").val(field.value)})}var target=$(this.element).find("[data-ajax-name='"+name+"']");switch((target.attr("type")||"").toLowerCase()){case"checkbox":target.prop("checked",1==data[name]);break;default:$(this.element).find("[data-ajax-name='"+name+"']:not(select)").val(data[name]),$(this.element).find("select[data-ajax-name='"+name+"']").each(function(index,el){"string"==typeof data[name]&&0==data[name].length||$(el).val(data[name])})}}this.addressChanged=!1,!data.pic||!data.pic.length||data.gallery&&data.gallery.length||this.markerGalleryInput.addPicture({url:data.pic})},WPGMZA.ProMarkerPanel.prototype.getFieldData=function(){var fields=$(this.element).find("[data-ajax-name]"),data={};return fields.each(function(index,el){var type="text";switch($(el).attr("type")&&(type=$(el).attr("type").toLowerCase()),type){case"checkbox":data[$(el).attr("data-ajax-name")]=$(el).prop("checked")?1:0;break;case"radio":$(el).prop("checked")&&(data[$(el).attr("data-ajax-name")]=$(el).val());break;default:data[$(el).attr("data-ajax-name")]=$(el).val()}}),tinyMCE.get("wpgmza-description-editor")?data.description=tinyMCE.get("wpgmza-description-editor").getContent():data.description=$("#wpgmza-description-editor").val(),data.gallery=this.markerGalleryInput.toJSON(),0==data.gallery.length&&(data.gallery=null),data},WPGMZA.ProMarkerPanel.prototype.onEditMarker=function(event){var self=this,id=$(event.currentTarget).attr("data-edit-marker-id");this.reset(),this.showPleaseWaitButton(),WPGMZA.restAPI.call("/markers/"+id+"?skip_cache=1&raw_data=true",{success:function(data,status,xhr){self.populate(data),self.restoreSaveButton()}})},WPGMZA.ProMarkerPanel.prototype.onAddressChanged=function(event){this.addressChanged=!0},WPGMZA.ProMarkerPanel.prototype.onSave=function(event){var self=this,address=$(this.element).find("[data-ajax-name='address']").val();0!=address.length?(this.showPleaseWaitButton(),this.addressChanged?WPGMZA.Geocoder.createInstance().geocode({address:address},function(results,status){switch(status){case WPGMZA.Geocoder.SUCCESS:var latLng=results[0].latLng;$(self.element).find("[data-ajax-name='lat']").val(latLng.lat),$(self.element).find("[data-ajax-name='lng']").val(latLng.lng),callback();break;case WPGMZA.Geocoder.ZERO_RESULTS:alert(WPGMZA.localized_strings.address_not_found),self.restoreSaveButton();break;default:alert(WPGMZA.localized_strings.geocode_fail),self.restoreSaveButton()}}):callback()):alert(WPGMZA.localized_strings.no_address_specified);function callback(){var id=$(self.element).find("[data-ajax-name='id']").val(),route="/markers/";-1==id||(route+=id),WPGMZA.restAPI.call(route,{method:"POST",data:self.getFieldData(),success:function(data,status,xhr){var marker,map=WPGMZA.maps[0];self.reset(),(marker=map.getMarkerByID(id))&&map.removeMarker(marker),marker=WPGMZA.Marker.createInstance(data),map.addMarker(marker),marker.panIntoView(),WPGMZA.adminMarkerDataTable.reload()}})}}}),jQuery(function($){WPGMZA.ProMarker=function(row){var self=this;if(this._icon=WPGMZA.MarkerIcon.createInstance(),this.title="",this.description="",this.categories=[],this.approved=1,row&&row.category&&row.category.length){var m=row.category.match(/\d+/g);m&&(this.categories=m)}WPGMZA.Marker.call(this,row),this.on("mouseover",function(event){self.onMouseOver(event)})},WPGMZA.ProMarker.prototype=Object.create(WPGMZA.Marker.prototype),WPGMZA.ProMarker.prototype.constructor=WPGMZA.ProMarker,WPGMZA.ProMarker.STICKY_ZINDEX=999999,Object.defineProperty(WPGMZA.ProMarker.prototype,"isIntegrated",{get:function(){return/[^\d]/.test(this.id)}}),Object.defineProperty(WPGMZA.ProMarker.prototype,"icon",{get:function(){return this._icon},set:function(value){if(value instanceof WPGMZA.MarkerIcon)this._icon=value,this.map&&this.updateIcon();else{if("object"!=typeof value&&"string"!=typeof value)throw new Error("Value must be an instance of WPGMZA.MarkerIcon, an icon literal, or a string");this._icon=WPGMZA.MarkerIcon.createInstance(value),this.map&&this.updateIcon()}}}),WPGMZA.ProMarker.prototype.onAdded=function(event){if(WPGMZA.Marker.prototype.onAdded.call(this,event),this.updateIcon(),(!this.map.storeLocator||this!=this.map.storeLocator.marker)&&this!=this.map.userLocationMarker){if(1==this.map.settings.store_locator_hide_before_search&&1!=WPGMZA.is_admin&&this.isFilterable)return this.isFiltered=!0,void this.setVisible(!1);WPGMZA.getQueryParamValue("markerid")!=this.id&&this.map.shortcodeAttributes.marker!=this.id||(this.openInfoWindow(),this.map.setCenter(this.getPosition())),"approved"in this&&0==this.approved&&this.setOpacity(.6),1==this.sticky&&this.setOptions({zIndex:WPGMZA.ProMarker.STICKY_ZINDEX})}},WPGMZA.ProMarker.prototype.onClick=function(event){WPGMZA.Marker.prototype.onClick.apply(this,arguments),1==this.map.settings.click_open_link&&this.link&&this.link.length&&("yes"==WPGMZA.settings.wpgmza_settings_infowindow_links?window.open(this.link):window.open(this.link,"_self"))},WPGMZA.ProMarker.prototype.onMouseOver=function(event){WPGMZA.settings.wpgmza_settings_map_open_marker_by==WPGMZA.ProInfoWindow.OPEN_BY_HOVER&&this.openInfoWindow()},WPGMZA.ProMarker.prototype.getIconFromCategory=function(){if(this.categories.length){var self=this,categoryIDs=this.categories.slice();categoryIDs.sort(function(a,b){var categoryA=self.map.getCategoryByID(a),categoryB=self.map.getCategoryByID(b);return categoryA&&categoryB?categoryA.depth<categoryB.depth?-1:1:null});for(var i=0;i<categoryIDs.length;i++){var category=this.map.getCategoryByID(categoryIDs[i]);if(category){var icon=category.icon;if(icon&&icon.length)return icon}}}},WPGMZA.ProMarker.prototype.setIcon=function(icon){this.icon=icon},WPGMZA.ProMarker.prototype.openInfoWindow=function(){if(WPGMZA.Marker.prototype.openInfoWindow.apply(this),this.disableInfoWindow)return!1;this.map&&this.map.userLocationMarker==this&&this.infoWindow.setContent(WPGMZA.localized_strings.my_location)}}),jQuery(function($){var Parent;WPGMZA.GoogleMarker=function(row){var self=this;Parent.call(this,row),this._opacity=1;var settings={};if(row)for(var name in row)row[name]instanceof WPGMZA.LatLng?settings[name]=row[name].toGoogleLatLng():row[name]instanceof WPGMZA.Map||"icon"==name||(settings[name]=row[name]);this.googleMarker=new google.maps.Marker(settings),(this.googleMarker.wpgmzaMarker=this).googleMarker.setPosition(new google.maps.LatLng({lat:parseFloat(this.lat),lng:parseFloat(this.lng)})),this.anim&&this.googleMarker.setAnimation(this.anim),this.animation&&this.googleMarker.setAnimation(this.animation),google.maps.event.addListener(this.googleMarker,"click",function(){self.dispatchEvent("click"),self.dispatchEvent("select")}),google.maps.event.addListener(this.googleMarker,"mouseover",function(){self.dispatchEvent("mouseover")}),google.maps.event.addListener(this.googleMarker,"dragend",function(){var googleMarkerPosition=self.googleMarker.getPosition();self.setPosition({lat:googleMarkerPosition.lat(),lng:googleMarkerPosition.lng()}),self.dispatchEvent({type:"dragend",latLng:self.getPosition()})}),this.trigger("init")},Parent=WPGMZA.isProVersion()?WPGMZA.ProMarker:WPGMZA.Marker,WPGMZA.GoogleMarker.prototype=Object.create(Parent.prototype),WPGMZA.GoogleMarker.prototype.constructor=WPGMZA.GoogleMarker,Object.defineProperty(WPGMZA.GoogleMarker.prototype,"opacity",{get:function(){return this._opacity},set:function(value){this._opacity=value,this.googleMarker.setOpacity(value)}}),WPGMZA.GoogleMarker.prototype.setLabel=function(label){label?(this.googleMarker.setLabel({text:label}),this.googleMarker.getIcon()||this.googleMarker.setIcon(WPGMZA.settings.default_marker_icon)):this.googleMarker.setLabel(null)},WPGMZA.GoogleMarker.prototype.setPosition=function(latLng){Parent.prototype.setPosition.call(this,latLng),this.googleMarker.setPosition({lat:this.lat,lng:this.lng})},WPGMZA.GoogleMarker.prototype.updateOffset=function(){var params,self=this,icon=this.googleMarker.getIcon(),img=new Image,x=this._offset.x,y=this._offset.y;icon=icon||WPGMZA.settings.default_marker_icon,params="string"==typeof icon?{url:icon}:icon,img.onload=function(){var defaultAnchor_x=img.width/2,defaultAnchor_y=img.height;params.anchor=new google.maps.Point(defaultAnchor_x-x,defaultAnchor_y-y),self.googleMarker.setIcon(params)},img.src=params.url},WPGMZA.GoogleMarker.prototype.setOptions=function(options){this.googleMarker.setOptions(options)},WPGMZA.GoogleMarker.prototype.setAnimation=function(animation){Parent.prototype.setAnimation.call(this,animation),this.googleMarker.setAnimation(animation)},WPGMZA.GoogleMarker.prototype.setVisible=function(visible){Parent.prototype.setVisible.call(this,visible),this.googleMarker.setVisible(!!visible)},WPGMZA.GoogleMarker.prototype.getVisible=function(visible){return this.googleMarker.getVisible()},WPGMZA.GoogleMarker.prototype.setDraggable=function(draggable){this.googleMarker.setDraggable(draggable)},WPGMZA.GoogleMarker.prototype.setOpacity=function(opacity){this.googleMarker.setOpacity(opacity)}}),jQuery(function($){var Parent;WPGMZA.OLMarker=function(row){var self=this;Parent.call(this,row);var origin=ol.proj.fromLonLat([parseFloat(this.lng),parseFloat(this.lat)]);if(WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_HTML_ELEMENT){var img=$("<img alt=''/>")[0];img.onload=function(event){self.updateElementHeight(),self.map&&self.map.olMap.updateSize()},img.src=WPGMZA.defaultMarkerIcon,this.element=$("<div class='ol-marker'></div>")[0],$(this.element).attr("title",this.title),this.element.appendChild(img),this.element.wpgmzaMarker=this,$(this.element).on("mouseover",function(event){self.dispatchEvent("mouseover")}),this.overlay=new ol.Overlay({element:this.element,position:origin,positioning:"bottom-center",stopEvent:!1}),this.overlay.setPosition(origin),this.animation&&this.setAnimation(this.animation),this.setLabel(this.settings.label),row&&row.draggable&&this.setDraggable(!0),this.rebindClickListener()}else{if(WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER)throw new Error("Invalid marker render mode");this.feature=new ol.Feature({geometry:new ol.geom.Point(origin)}),this.feature.setStyle(this.getVectorLayerStyle()),this.feature.wpgmzaMarker=this}this.trigger("init")},Parent=WPGMZA.isProVersion()?WPGMZA.ProMarker:WPGMZA.Marker,WPGMZA.OLMarker.prototype=Object.create(Parent.prototype),WPGMZA.OLMarker.prototype.constructor=WPGMZA.OLMarker,WPGMZA.OLMarker.RENDER_MODE_HTML_ELEMENT="element",WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER="vector",WPGMZA.OLMarker.renderMode=WPGMZA.OLMarker.RENDER_MODE_HTML_ELEMENT,"open-layers"==WPGMZA.settings.engine&&WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER&&(WPGMZA.OLMarker.defaultVectorLayerStyle=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],src:WPGMZA.defaultMarkerIcon})}),WPGMZA.OLMarker.hiddenVectorLayerStyle=new ol.style.Style({})),WPGMZA.OLMarker.prototype.getVectorLayerStyle=function(){return this.vectorLayerStyle?this.vectorLayerStyle:WPGMZA.OLMarker.defaultVectorLayerStyle},WPGMZA.OLMarker.prototype.updateElementHeight=function(height,calledOnFocus){var self=this;0!=(height=height||$(this.element).find("img").height())||calledOnFocus||$(window).one("focus",function(event){self.updateElementHeight(!1,!0)}),$(this.element).css({height:height+"px"})},WPGMZA.OLMarker.prototype.addLabel=function(){this.setLabel(this.getLabelText())},WPGMZA.OLMarker.prototype.setLabel=function(label){WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER?label?(this.label||(this.label=$("<div class='ol-marker-label'/>"),$(this.element).append(this.label)),this.label.html(label)):this.label&&$(this.element).find(".ol-marker-label").remove():console.warn("Marker labels are not currently supported in Vector Layer rendering mode")},WPGMZA.OLMarker.prototype.getVisible=function(visible){if(WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER)return"none"!=this.overlay.getElement().style.display},WPGMZA.OLMarker.prototype.setVisible=function(visible){if(Parent.prototype.setVisible.call(this,visible),WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER)if(visible){var style=this.getVectorLayerStyle();this.feature.setStyle(style)}else this.feature.setStyle(null);else this.overlay.getElement().style.display=visible?"block":"none"},WPGMZA.OLMarker.prototype.setPosition=function(latLng){Parent.prototype.setPosition.call(this,latLng);var origin=ol.proj.fromLonLat([parseFloat(this.lng),parseFloat(this.lat)]);WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER?this.feature.setGeometry(new ol.geom.Point(origin)):this.overlay.setPosition(origin)},WPGMZA.OLMarker.prototype.updateOffset=function(x,y){if(WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER){x=this._offset.x,y=this._offset.y;this.element.style.position="relative",this.element.style.left=x+"px",this.element.style.top=y+"px"}else console.warn("Marker offset is not currently supported in Vector Layer rendering mode")},WPGMZA.OLMarker.prototype.setAnimation=function(anim){if(WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER)switch(Parent.prototype.setAnimation.call(this,anim),anim){case WPGMZA.Marker.ANIMATION_NONE:$(this.element).removeAttr("data-anim");break;case WPGMZA.Marker.ANIMATION_BOUNCE:$(this.element).attr("data-anim","bounce");break;case WPGMZA.Marker.ANIMATION_DROP:$(this.element).attr("data-anim","drop")}else console.warn("Marker animation is not currently supported in Vector Layer rendering mode")},WPGMZA.OLMarker.prototype.setDraggable=function(draggable){var self=this;if(WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER)if(draggable){var options={disabled:!1};this.jQueryDraggableInitialized||(options.start=function(event){self.onDragStart(event)},options.stop=function(event){self.onDragEnd(event)}),$(this.element).draggable(options),this.jQueryDraggableInitialized=!0,this.rebindClickListener()}else $(this.element).draggable({disabled:!0});else console.warn("Marker dragging is not currently supported in Vector Layer rendering mode")},WPGMZA.OLMarker.prototype.setOpacity=function(opacity){WPGMZA.OLMarker.renderMode!=WPGMZA.OLMarker.RENDER_MODE_VECTOR_LAYER?$(this.element).css({opacity:opacity}):console.warn("Marker opacity is not currently supported in Vector Layer rendering mode")},WPGMZA.OLMarker.prototype.onDragStart=function(event){this.isBeingDragged=!0,this.map.olMap.getInteractions().forEach(function(interaction){interaction instanceof ol.interaction.DragPan&&interaction.setActive(!1)})},WPGMZA.OLMarker.prototype.onDragEnd=function(event){var offset_top=parseFloat($(this.element).css("top").match(/-?\d+/)[0]),offset_left=parseFloat($(this.element).css("left").match(/-?\d+/)[0]);$(this.element).css({top:"0px",left:"0px"});var currentLatLng=this.getPosition(),pixelsBeforeDrag=this.map.latLngToPixels(currentLatLng),pixelsAfterDrag={x:pixelsBeforeDrag.x+offset_left,y:pixelsBeforeDrag.y+offset_top},latLngAfterDrag=this.map.pixelsToLatLng(pixelsAfterDrag);this.setPosition(latLngAfterDrag),this.isBeingDragged=!1,this.trigger({type:"dragend",latLng:latLngAfterDrag}),"yes"!=this.map.settings.wpgmza_settings_map_draggable&&this.map.olMap.getInteractions().forEach(function(interaction){interaction instanceof ol.interaction.DragPan&&interaction.setActive(!0)})},WPGMZA.OLMarker.prototype.onElementClick=function(event){var self=event.currentTarget.wpgmzaMarker;self.isBeingDragged||(self.dispatchEvent("click"),self.dispatchEvent("select"))},WPGMZA.OLMarker.prototype.rebindClickListener=function(){$(this.element).off("click",this.onElementClick),$(this.element).on("click",this.onElementClick)}}),jQuery(function($){function compareMax(a,b){return b.max-a.max}function Cell(x,y,h,polygon){this.x=x,this.y=y,this.h=h,this.d=function(x,y,polygon){for(var inside=!1,minDistSq=1/0,k=0;k<polygon.length;k++)for(var ring=polygon[k],i=0,len=ring.length,j=len-1;i<len;j=i++){var a=ring[i],b=ring[j];a[1]>y!=b[1]>y&&x<(b[0]-a[0])*(y-a[1])/(b[1]-a[1])+a[0]&&(inside=!inside),minDistSq=Math.min(minDistSq,getSegDistSq(x,y,a,b))}return(inside?1:-1)*Math.sqrt(minDistSq)}(x,y,polygon),this.max=this.d+this.h*Math.SQRT2}function getSegDistSq(px,py,a,b){var x=a[0],y=a[1],dx=b[0]-x,dy=b[1]-y;if(0!==dx||0!==dy){var t=((px-x)*dx+(py-y)*dy)/(dx*dx+dy*dy);1<t?(x=b[0],y=b[1]):0<t&&(x+=dx*t,y+=dy*t)}return(dx=px-x)*dx+(dy=py-y)*dy}WPGMZA.ProPolygon=function(row,googlePolygon){WPGMZA.Polygon.call(this,row,googlePolygon)},WPGMZA.ProPolygon.prototype=Object.create(WPGMZA.Polygon.prototype),WPGMZA.ProPolygon.prototype.constructor=WPGMZA.ProPolygon,WPGMZA.ProPolygon.getLabelPosition=function(geojson,precision,debug){var minX,minY,maxX,maxY,polygon=geojson;precision=precision||1;for(var i=0;i<polygon[0].length;i++){var p=polygon[0][i];(!i||p[0]<minX)&&(minX=p[0]),(!i||p[1]<minY)&&(minY=p[1]),(!i||p[0]>maxX)&&(maxX=p[0]),(!i||p[1]>maxY)&&(maxY=p[1])}var width=maxX-minX,height=maxY-minY,cellSize=Math.min(width,height),h=cellSize/2;if(0===cellSize)return[minX,minY];for(var cellQueue=new WPGMZA.Queue(null,compareMax),x=minX;x<maxX;x+=cellSize)for(var y=minY;y<maxY;y+=cellSize)cellQueue.push(new Cell(x+h,y+h,h,polygon));var bestCell=function(polygon){for(var area=0,x=0,y=0,points=polygon[0],i=0,len=points.length,j=len-1;i<len;j=i++){var a=points[i],b=points[j],f=a[0]*b[1]-b[0]*a[1];x+=(a[0]+b[0])*f,y+=(a[1]+b[1])*f,area+=3*f}return 0===area?new Cell(points[0][0],points[0][1],0,polygon):new Cell(x/area,y/area,0,polygon)}(polygon),bboxCell=new Cell(minX+width/2,minY+height/2,0,polygon);bboxCell.d>bestCell.d&&(bestCell=bboxCell);for(cellQueue.length;cellQueue.length;){var cell=cellQueue.pop();cell.d>bestCell.d&&(bestCell=cell),cell.max-bestCell.d<=precision||(h=cell.h/2,cellQueue.push(new Cell(cell.x-h,cell.y-h,h,polygon)),cellQueue.push(new Cell(cell.x+h,cell.y-h,h,polygon)),cellQueue.push(new Cell(cell.x-h,cell.y+h,h,polygon)),cellQueue.push(new Cell(cell.x+h,cell.y+h,h,polygon)),0)}return[bestCell.x,bestCell.y]}}),jQuery(function($){var Parent;WPGMZA.GooglePolygon=function(options,googlePolygon){var self=this;if(Parent.call(this,options,googlePolygon),googlePolygon)this.googlePolygon=googlePolygon;else if(this.googlePolygon=new google.maps.Polygon,options){var googleOptions=$.extend({},options);options.polydata&&(googleOptions.paths=this.parseGeometry(options.polydata)),options.linecolor&&(googleOptions.strokeColor="#"+options.linecolor),options.lineopacity&&(googleOptions.strokeOpacity=parseFloat(options.lineopacity)),options.fillcolor&&(googleOptions.fillColor="#"+options.fillcolor),options.opacity&&(googleOptions.fillOpacity=parseFloat(options.opacity)),this.googlePolygon.setOptions(googleOptions)}this.googlePolygon.wpgmzaPolygon=this,google.maps.event.addListener(this.googlePolygon,"click",function(){self.dispatchEvent({type:"click"})})},Parent=WPGMZA.isProVersion()?WPGMZA.ProPolygon:WPGMZA.Polygon,WPGMZA.GooglePolygon.prototype=Object.create(Parent.prototype),WPGMZA.GooglePolygon.prototype.constructor=WPGMZA.GooglePolygon,WPGMZA.GooglePolygon.prototype.getEditable=function(){return this.googlePolygon.getOptions().editable},WPGMZA.GooglePolygon.prototype.setEditable=function(value){this.googlePolygon.setOptions({editable:value})},WPGMZA.GooglePolygon.prototype.toJSON=function(){var result=WPGMZA.Polygon.prototype.toJSON.call(this);result.points=[];for(var path=this.googlePolygon.getPath(),i=0;i<path.getLength();i++){var latLng=path.getAt(i);result.points.push({lat:latLng.lat(),lng:latLng.lng()})}return result}}),jQuery(function($){var Parent;WPGMZA.OLPolygon=function(options,olFeature){if(Parent.call(this,options,olFeature),this.olStyle=new ol.style.Style,olFeature)this.olFeature=olFeature;else{var coordinates=[[]];if(options&&options.polydata){for(var paths=this.parseGeometry(options.polydata),i=0;i<paths.length;i++)coordinates[0].push(ol.proj.fromLonLat([parseFloat(paths[i].lng),parseFloat(paths[i].lat)]));this.olStyle=new ol.style.Style(this.getStyleFromSettings())}this.olFeature=new ol.Feature({geometry:new ol.geom.Polygon(coordinates)})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:[this.olFeature]}),style:this.olStyle}),this.layer.getSource().getFeatures()[0].setProperties({wpgmzaPolygon:this})},Parent=WPGMZA.isProVersion()?WPGMZA.ProPolygon:WPGMZA.Polygon,WPGMZA.OLPolygon.prototype=Object.create(Parent.prototype),WPGMZA.OLPolygon.prototype.constructor=WPGMZA.OLPolygon,WPGMZA.OLPolygon.prototype.getStyleFromSettings=function(){var params={};return this.linecolor&&this.lineopacity&&(params.stroke=new ol.style.Stroke({color:WPGMZA.hexOpacityToRGBA("#"+this.linecolor,this.lineopacity)})),this.opacity&&(params.fill=new ol.style.Fill({color:WPGMZA.hexOpacityToRGBA(this.fillcolor,this.opacity)})),params},WPGMZA.OLPolygon.prototype.updateStyleFromSettings=function(){var params=this.getStyleFromSettings();this.olStyle=new ol.style.Style(params),this.layer.setStyle(this.olStyle)},WPGMZA.OLPolygon.prototype.setEditable=function(editable){},WPGMZA.OLPolygon.prototype.toJSON=function(){var result=Parent.prototype.toJSON.call(this),coordinates=this.olFeature.getGeometry().getCoordinates()[0];result.points=[];for(var i=0;i<coordinates.length;i++){var lonLat=ol.proj.toLonLat(coordinates[i]),latLng={lat:lonLat[1],lng:lonLat[0]};result.points.push(latLng)}return result}}),jQuery(function($){WPGMZA.ProStoreLocator=function(map,element){WPGMZA.StoreLocator.call(this,map,element);var buttons=$(element).find("input[type='button'], button:not(.wpgmza-use-my-location)");if(buttons.prop("disabled",!0),map.on("markersplaced",function(event){buttons.prop("disabled",!1)}),"1"==map.settings.store_locator_use_their_location){var input=$(this.element).find(".addressInput"),button=new WPGMZA.UseMyLocationButton(input);input.after(button.element)}map.settings.store_locator_search_area==WPGMZA.ProStoreLocator.SEARCH_AREA_AUTO&&$(this.element).find(".wpgmza_sl_radius_select").remove()},WPGMZA.ProStoreLocator.prototype=Object.create(WPGMZA.StoreLocator.prototype),WPGMZA.ProStoreLocator.prototype.constructor=WPGMZA.ProStoreLocator,WPGMZA.ProStoreLocator.SEARCH_AREA_RADIAL="radial",WPGMZA.ProStoreLocator.SEARCH_AREA_AUTO="auto",WPGMZA.StoreLocator.createInstance=function(map,element){return new WPGMZA.ProStoreLocator(map,element)},Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"keywords",{get:function(){var legacy=$(".wpgmza_name_search_string + input").val();return legacy||$(this.map.element).find(".wpgmza-text-search").val()}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"categories",{configurable:!0,get:function(){var dropdown,value,results;if(0<$(this.map.element).find(".wpgmza-modern-store-locator").length)$(this.map.element).find(".wpgmza-modern-store-locator [name='wpgmza_cat_checkbox']:checked").each(function(index,el){(results=results||[]).push($(el).val())});else{if((dropdown=$(this.element).find(".wpgmza_sl_category_div > select")).length)return"0"==(value=dropdown.val())?null:[value];$(this.element).find(".wpgmza_sl_category_div :checked").each(function(index,el){(results=results||[]).push($(el).val())})}return results}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"hideMarkersInInitialState",{get:function(){return 1==this.map.settings.store_locator_hide_before_search}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"circleStrokeColor",{get:function(){return this.map.settings.sl_stroke_color?"#"+this.map.settings.sl_stroke_color:"#ff0000"}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"circleFillColor",{get:function(){return this.map.settings.sl_fill_color?"#"+this.map.settings.sl_fill_color:"#ff0000"}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"circleStrokeOpacity",{get:function(){return void 0!==this.map.settings.sl_stroke_opacity&&""!==this.map.settings.sl_stroke_opacity?parseFloat(this.map.settings.sl_stroke_opacity):.25}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"circleFillOpacity",{get:function(){return void 0!==this.map.settings.sl_fill_opacity&&""!==this.map.settings.sl_fill_opacity?parseFloat(this.map.settings.sl_fill_opacity):.15}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"circle",{get:function(){return this.map.settings.store_locator_search_area==WPGMZA.ProStoreLocator.SEARCH_AREA_AUTO?null:(this._circle||(WPGMZA.isDeviceiOS()||"modern"!=this.map.settings.wpgmza_store_locator_radius_style?this._circle=WPGMZA.Circle.createInstance({strokeColor:this.circleStrokeColor,strokeOpacity:this.circleStrokeOpacity,strokeWeight:2,fillColor:this.circleFillColor,fillOpacity:this.circleFillOpacity,visible:!1,clickable:!1}):(this._circle=WPGMZA.ModernStoreLocatorCircle.createInstance(this.map.id),this._circle.settings.color=this.circleStrokeColor)),this._circle)}}),Object.defineProperty(WPGMZA.ProStoreLocator.prototype,"marker",{get:function(){if(1!=this.map.settings.store_locator_bounce)return null;if(this._marker)return this._marker;var options={visible:!1};return this.map.settings.upload_default_sl_marker&&this.map.settings.upload_default_sl_marker.length&&(options.icon=this.map.settings.upload_default_sl_marker),this._marker=WPGMZA.Marker.createInstance(options),this._marker.disableInfoWindow=!0,this._marker.isFilterable=!1,1==this.map.settings.wpgmza_sl_animation?this._marker.setAnimation(WPGMZA.Marker.ANIMATION_BOUNCE):2==this.map.settings.wpgmza_sl_animation&&this._marker.setAnimation(WPGMZA.Marker.ANIMATION_DROP),this._marker}}),WPGMZA.ProStoreLocator.prototype.getZoomFromRadius=function(radius){return this.distanceUnits==WPGMZA.Distance.MILES&&(radius*=WPGMZA.Distance.KILOMETERS_PER_MILE),Math.round(14-Math.log(radius)/Math.LN2)},WPGMZA.ProStoreLocator.prototype.getFilteringParameters=function(){if(this.state==WPGMZA.StoreLocator.STATE_INITIAL)return this.hideMarkersInInitialState?{hideAll:!0}:{};var params=WPGMZA.StoreLocator.prototype.getFilteringParameters.call(this),proParams={};return this.map.settings.store_locator_search_area==WPGMZA.ProStoreLocator.SEARCH_AREA_AUTO&&(delete params.center,delete params.radius),this.keywords&&(proParams.keywords=this.keywords),this.categories&&(proParams.categories=this.categories),$.extend(params,proParams)},WPGMZA.ProStoreLocator.prototype.onFilteringComplete=function(event){var params=event.filteringParams,circle=this.circle,factor=(this.marker,this.distanceUnits==WPGMZA.Distance.MILES?WPGMZA.Distance.KILOMETERS_PER_MILE:1);if(event.source instanceof WPGMZA.StoreLocator){switch(WPGMZA.StoreLocator.prototype.onFilteringComplete.apply(this,arguments),this.map.settings.store_locator_search_area){case WPGMZA.ProStoreLocator.SEARCH_AREA_AUTO:if(!this.bounds||this.bounds.isInInitialState()){this.map.setZoom(this.map.settings.map_start_zoom);break}this.map.fitBounds(this.bounds);var maxZoom=this.map.settings.store_locator_auto_area_max_zoom;maxZoom&&this.map.getZoom()>=maxZoom&&this.map.setZoom(maxZoom);break;default:if(circle&&circle.setVisible(!1),params.center&&params.radius){this.map.setCenter(params.center),this.map.setZoom(this.getZoomFromRadius(params.radius)),circle&&(circle instanceof WPGMZA.ModernStoreLocatorCircle&&(circle.settings.radiusString=Math.round(params.radius)),circle.setRadius(params.radius*factor),circle.setCenter(params.center),circle.setVisible(!0),circle.map!=this.map&&this.map.addCircle(circle));break}}var storeLocatorResultEvent={type:"storelocatorresult"};event.center&&(storeLocatorResultEvent.center=event.center),this.map.trigger(storeLocatorResultEvent)}},WPGMZA.ProStoreLocator.prototype.onGeocodeComplete=function(event){if(event.results&&event.results.length){var location=new WPGMZA.LatLng({lat:event.results[0].lat,lng:event.results[0].lng});location.source=WPGMZA.ProMap.SHOW_DISTANCE_FROM_SEARCHED_ADDRESS,this.map.showDistanceFromLocation=location}WPGMZA.StoreLocator.prototype.onGeocodeComplete.apply(this,arguments)},WPGMZA.ProStoreLocator.prototype.onReset=function(event){this.map.showDistanceFromLocation=this.map.userLocation,this.map.updateInfoWindowDistances(),WPGMZA.StoreLocator.prototype.onReset.apply(this,arguments)}}),jQuery(function($){function defaultCompare(a,b){return a<b?-1:b<a?1:0}WPGMZA.Queue=function(data,compare){if(data=data||[],compare=compare||defaultCompare,this.data=data,this.length=this.data.length,this.compare=compare,0<this.lenght)for(var i=(this.length>>1)-1;0<=i;i--)this._down(i)},WPGMZA.Queue.prototype.push=function(item){this.data.push(item),this.length++,this._up(this.length-1)},WPGMZA.Queue.prototype.pop=function(){if(0!==this.length){var top=this.data[0],bottom=this.data.pop();return this.length--,0<this.length&&(this.data[0]=bottom,this._down(0)),top}},WPGMZA.Queue.prototype.peek=function(){return this.data[0]},WPGMZA.Queue.prototype._up=function(pos){for(var data=this.data,compare=this.compare,item=data[pos];0<pos;){var parent=pos-1>>1,current=data[parent];if(0<=compare(item,current))break;data[pos]=current,pos=parent}data[pos]=item},WPGMZA.Queue.prototype._down=function(pos){for(var data=this.data,compare=this.compare,halfLength=this.length>>1,item=data[pos];pos<halfLength;){var left=1+(pos<<1),best=data[left],right=left+1;if(right<this.length&&compare(data[right],best)<0&&(best=data[left=right]),0<=compare(best,item))break;data[pos]=best,pos=left}data[pos]=item}}),jQuery(function($){WPGMZA.UseMyLocationButton=function(target,options){var self=this;this.options={},options&&(this.options=options),this.target=$(target),this.element=$("<button class='wpgmza-use-my-location' type='button' title='"+WPGMZA.localized_strings.use_my_location+"'><i class='fa fa-crosshairs' aria-hidden='true'></i></button>"),this.element.on("click",function(event){self.onClick(event)})},WPGMZA.UseMyLocationButton.prototype=Object.create(WPGMZA.EventDispatcher.prototype),WPGMZA.UseMyLocationButton.prototype.constructor=WPGMZA.UseMyLocationButton,WPGMZA.UseMyLocationButton.prototype.onClick=function(event){var self=this;WPGMZA.getCurrentPosition(function(position){var lat=position.coords.latitude,lng=position.coords.longitude;self.target.val(lat+", "+lng),self.target.trigger("change"),WPGMZA.Geocoder.createInstance().geocode({latLng:{lat:lat,lng:lng}},function(results){results&&results.length&&self.target.val(results[0])})})}}),jQuery(function($){WPGMZA.ModernStoreLocator=function(map_id){var original,self=this,map=WPGMZA.getMapByID(map_id);if(WPGMZA.assertInstanceOf(this,"ModernStoreLocator"),(original=WPGMZA.isProVersion()?$(".wpgmza_sl_search_button[mid='"+map_id+"'], .wpgmza_sl_search_button_"+map_id).closest(".wpgmza_sl_main_div"):$(".wpgmza_sl_search_button").closest(".wpgmza_sl_main_div")).length){this.element=$("<div class='wpgmza-modern-store-locator'><div class='wpgmza-inner wpgmza-modern-hover-opaque'/></div>")[0];var addressInput,inner=$(this.element).find(".wpgmza-inner");addressInput=WPGMZA.isProVersion()?$(original).find(".addressInput"):$(original).find("#addressInput"),wpgmaps_localize[map_id].other_settings.store_locator_query_string&&wpgmaps_localize[map_id].other_settings.store_locator_query_string.length&&addressInput.attr("placeholder",wpgmaps_localize[map_id].other_settings.store_locator_query_string),inner.append(addressInput);var button,titleSearch=$(original).find("[id='nameInput_"+map_id+"']");if(titleSearch.length){var placeholder=wpgmaps_localize[map_id].other_settings.store_locator_name_string;placeholder&&placeholder.length&&titleSearch.attr("placeholder",placeholder),inner.append(titleSearch)}(button=$(original).find("button.wpgmza-use-my-location"))&&inner.append(button),$(addressInput).on("keydown keypress",function(event){13==event.keyCode&&(self.searchButton.trigger("click"),searchLocations(map_id),map.storeLocator.onSearch(event))}),$(addressInput).on("input",function(event){self.searchButton.show(),self.resetButton.hide()}),inner.append($(original).find("select.wpgmza_sl_radius_select")),this.searchButton=$(original).find(".wpgmza_sl_search_button, .wpgmza_sl_search_button_div"),inner.append(this.searchButton),this.resetButton=$(original).find(".wpgmza_sl_reset_button_div"),inner.append(this.resetButton),this.resetButton.on("click",function(event){resetLocations(map_id)}),this.resetButton.hide(),WPGMZA.isProVersion()&&(this.searchButton.on("click",function(event){0!=$("addressInput_"+map_id).val()&&(self.searchButton.hide(),self.resetButton.show(),map.storeLocator.state=WPGMZA.StoreLocator.STATE_APPLIED)}),this.resetButton.on("click",function(event){self.resetButton.hide(),self.searchButton.show(),map.storeLocator.state=WPGMZA.StoreLocator.STATE_INITIAL})),inner.append($("#wpgmza_distance_type_"+map_id));var container=$(original).find(".wpgmza_cat_checkbox_holder"),items=($(container).children("ul"),$(container).find("li")),numCategories=0,icons=[];items.each(function(index,el){var id=$(el).attr("class").match(/\d+/);for(var category_id in wpgmza_category_data)if(id==category_id){var src=wpgmza_category_data[category_id].image,icon=$('<div class="wpgmza-chip-icon"/>');icon.css({"background-image":"url('"+src+"')",width:$("#wpgmza_cat_checkbox_"+category_id+" + label").height()+"px"}),icons.push(icon),null!=src&&""!=src&&$("#wpgmza_cat_checkbox_"+category_id+" + label").prepend(icon),numCategories++;break}}),$(this.element).append(container),numCategories&&(this.optionsButton=$('<span class="wpgmza_store_locator_options_button"><i class="fa fa-list"></i></span>'),$(this.searchButton).before(this.optionsButton)),setInterval(function(){icons.forEach(function(icon){var height=$(icon).height();$(icon).css({width:height+"px"}),$(icon).closest("label").css({"padding-left":height+8+"px"})}),$(container).css("width",$(self.element).find(".wpgmza-inner").outerWidth()+"px")},1e3),$(this.element).find(".wpgmza_store_locator_options_button").on("click",function(event){container.hasClass("wpgmza-open")?container.removeClass("wpgmza-open"):container.addClass("wpgmza-open")}),$(original).remove(),$(this.element).find("input, select").on("focus",function(){$(inner).addClass("active")}),$(this.element).find("input, select").on("blur",function(){$(inner).removeClass("active")}),$(this.element).on("mouseover","li.wpgmza_cat_checkbox_item_holder",function(event){self.onMouseOverCategory(event)}),$(this.element).on("mouseleave","li.wpgmza_cat_checkbox_item_holder",function(event){self.onMouseLeaveCategory(event)}),$(map.markerFilter).on("filteringcomplete",function(event){this.map.hasVisibleMarkers()||(this.map.settings.store_locator_not_found_message!=WPGMZA.localized_strings.zero_results&&""!=this.map.settings.store_locator_not_found_message?alert(this.map.settings.store_locator_not_found_message):alert(WPGMZA.localized_strings.zero_results))}),$("body").on("click",".wpgmza_store_locator_options_button",function(event){setTimeout(function(){if($(".wpgmza_cat_checkbox_holder").hasClass("wpgmza-open")){var p_cat=$(".wpgmza_cat_checkbox_holder"),position_cat=p_cat.position().top+p_cat.outerHeight(!0)+$(".wpgmza-modern-store-locator").height(),$p_map=$(".wpgmza_map");$p_map.position().top+$p_map.outerHeight(!0)<=position_cat&&($(".wpgmza_cat_ul").css("overflow","scroll "),$(".wpgmza_cat_ul").css("height","100%"),$(".wpgmza-modern-store-locator").css("height","100%"),$(".wpgmza_cat_checkbox_holder.wpgmza-open").css({"padding-bottom":"50px",height:"100%"}))}},500)})}},WPGMZA.ModernStoreLocator.createInstance=function(map_id){switch(WPGMZA.settings.engine){case"open-layers":return new WPGMZA.OLModernStoreLocator(map_id);default:return new WPGMZA.GoogleModernStoreLocator(map_id)}},WPGMZA.ModernStoreLocator.prototype.onMouseOverCategory=function(event){var li=event.currentTarget;$(li).children("ul.wpgmza_cat_checkbox_item_holder").stop(!0,!1).fadeIn()},WPGMZA.ModernStoreLocator.prototype.onMouseLeaveCategory=function(event){var li=event.currentTarget;$(li).children("ul.wpgmza_cat_checkbox_item_holder").stop(!0,!1).fadeOut()}}),jQuery(function($){WPGMZA.GoogleModernStoreLocator=function(map_id){this.map=WPGMZA.getMapByID(map_id),WPGMZA.ModernStoreLocator.call(this,map_id);var options={fields:["name","formatted_address"],types:["geocode"]},restrict=wpgmaps_localize[map_id].other_settings.wpgmza_store_locator_restrict;this.addressInput=$(this.element).find(".addressInput, #addressInput")[0],this.addressInput&&(restrict&&restrict.length&&(options.componentRestrictions={country:restrict}),this.autoComplete=new google.maps.places.Autocomplete(this.addressInput,options)),this.map.googleMap.controls[google.maps.ControlPosition.TOP_CENTER].push(this.element)},WPGMZA.GoogleModernStoreLocator.prototype=Object.create(WPGMZA.ModernStoreLocator.prototype),WPGMZA.GoogleModernStoreLocator.prototype.constructor=WPGMZA.GoogleModernStoreLocator}),jQuery(function($){WPGMZA.OLModernStoreLocator=function(map_id){WPGMZA.ModernStoreLocator.call(this,map_id),(WPGMZA.isProVersion()?$(".wpgmza_map[data-map-id='"+map_id+"']"):$("#wpgmza_map")).append(this.element)},WPGMZA.OLModernStoreLocator.prototype=Object.create(WPGMZA.ModernStoreLocator),WPGMZA.OLModernStoreLocator.prototype.constructor=WPGMZA.OLModernStoreLocator}),jQuery(function($){WPGMZA.XMLCacheConverter=function(){},WPGMZA.XMLCacheConverter.prototype.convert=function(xml){var markers=[],remap={marker_id:"id",linkd:"link"};return $(xml).find("marker").each(function(index,el){var data={};$(el).children().each(function(j,child){var key=child.nodeName;remap[key]&&(key=remap[key]),child.hasAttribute("data-json")?data[key]=JSON.parse($(child).text()):data[key]=$(child).text()}),markers.push(data)}),markers}}),jQuery(function($){WPGMZA.loadXMLAsWebWorker=function(){function tXml(a,d){function c(){for(var l=[];a[b];){if(60==a.charCodeAt(b)){if(47===a.charCodeAt(b+1)){b=a.indexOf(">",b);break}if(33===a.charCodeAt(b+1)){if(45==a.charCodeAt(b+2)){for(;62!==a.charCodeAt(b)||45!=a.charCodeAt(b-1)||45!=a.charCodeAt(b-2)||-1==b;)b=a.indexOf(">",b+1);-1===b&&(b=a.length)}else for(b+=2;62!==a.charCodeAt(b);)b++;b++;continue}var c=f();l.push(c)}else c=b,-2===(b=a.indexOf("<",b)-1)&&(b=a.length),0<(c=a.slice(c,b+1)).trim().length&&l.push(c);b++}return l}function l(){for(var c=b;-1===g.indexOf(a[b]);)b++;return a.slice(c,b)}function f(){var d={};b++,d.tagName=l();for(var f=!1;62!==a.charCodeAt(b);){if(64<(e=a.charCodeAt(b))&&e<91||96<e&&e<123){for(var g=l(),e=a.charCodeAt(b);39!==e&&34!==e&&!(64<e&&e<91||96<e&&e<123)&&62!==e;)b++,e=a.charCodeAt(b);if(f||(d.attributes={},f=!0),39===e||34===e){e=a[b];var h=++b;b=a.indexOf(e,h),e=a.slice(h,b)}else e=null,b--;d.attributes[g]=e}b++}return 47!==a.charCodeAt(b-1)&&("script"==d.tagName?(f=b+1,b=a.indexOf("<\/script>",b),d.children=[a.slice(f,b-1)],b+=8):"style"==d.tagName?(f=b+1,b=a.indexOf("</style>",b),d.children=[a.slice(f,b-1)],b+=7):-1==k.indexOf(d.tagName)&&(b++,d.children=c())),d}var g="\n\t>/= ",k=["img","br","input","meta","link"],h=null;if((d=d||{}).searchId){var b=new RegExp("s*ids*=s*['\"]"+d.searchId+"['\"]").exec(a).index;return-1!==b&&(-1!==(b=a.lastIndexOf("<",b))&&(h=f())),b}return b=0,h=c(),d.filter&&(h=tXml.filter(h,d.filter)),d.simplify&&(h=tXml.simplefy(h)),h}tXml.simplify=function(a){var d={};if(1===a.length&&"string"==typeof a[0])return a[0];for(var c in a.forEach(function(a){if(d[a.tagName]||(d[a.tagName]=[]),"object"==typeof a){var c=tXml.simplefy(a.children);d[a.tagName].push(c),a.attributes&&(c._attributes=a.attributes)}else d[a.tagName].push(a)}),d)1==d[c].length&&(d[c]=d[c][0]);return d},tXml.filter=function(a,d){var c=[];return a.forEach(function(a){"object"==typeof a&&d(a)&&c.push(a),a.children&&(a=tXml.filter(a.children,d),c=c.concat(a))}),c},tXml.domToXml=function(a){var c="";return function d(a){if(a)for(var f=0;f<a.length;f++)if("string"==typeof a[f])c+=a[f].trim();else{var g=a[f];c+="<"+g.tagName;var k=void 0;for(k in g.attributes)c=-1===g.attributes[k].indexOf('"')?c+(" "+k+'="'+g.attributes[k].trim())+'"':c+(" "+k+"='"+g.attributes[k].trim())+"'";c+=">",d(g.children),c+="</"+g.tagName+">"}}(O),c},"object"!=typeof window&&(module.exports=tXml);var inputData,totalFiles,worker=self,dataForMainThread=[],filesLoaded=0;function onXMLLoaded(request){if(4==request.readyState&&200==request.status){(new Date).getTime();!function(xml){for(var markers=xml[0].children[0],remap={marker_id:"id",linkd:"link"},i=0;i<markers.children.length;i++){var data={};markers.children[i].children.forEach(function(node){var key=node.tagName;remap[key]&&(key=remap[key]),node.attributes["data-json"]?data[key]=JSON.parse(node.children[0]):node.children.length?data[key]=node.children[0]:data[key]=""}),dataForMainThread.push(data)}}(tXml(request.responseText)),++filesLoaded>=totalFiles?worker.postMessage(dataForMainThread):loadNextFile()}}function loadNextFile(){var url=inputData.urls[filesLoaded],request=new XMLHttpRequest;request.onreadystatechange=function(){onXMLLoaded(this)},request.open("GET",inputData.protocol+url,!0),request.send()}self.addEventListener("message",function(event){var data=event.data;switch(data.command){case"load":dataForMainThread=[],filesLoaded=0,totalFiles=(inputData=data).urls.length,loadNextFile();break;default:throw new Error("Unknown command")}},!1)}}),jQuery(function($){if(window.wp&&wp.i18n&&wp.blocks&&wp.editor&&wp.components){var __=wp.i18n.__,_wp$editor=(wp.blocks.registerBlockType,wp.editor),InspectorControls=_wp$editor.InspectorControls,_wp$components=(_wp$editor.BlockControls,wp.components),PanelBody=(_wp$components.Dashicon,_wp$components.Toolbar,_wp$components.Button,_wp$components.Tooltip,_wp$components.PanelBody),SelectControl=(_wp$components.TextareaControl,_wp$components.TextControl,_wp$components.RichText,_wp$components.SelectControl),RangeControl=_wp$components.RangeControl;WPGMZA.Integration.ProGutenberg=function(){WPGMZA.Integration.Gutenberg.call(this)},WPGMZA.Integration.ProGutenberg.prototype=Object.create(WPGMZA.Integration.Gutenberg.prototype),WPGMZA.Integration.ProGutenberg.prototype.constructor=WPGMZA.Integration.ProGutenberg,WPGMZA.Integration.Gutenberg.getConstructor=function(){return WPGMZA.Integration.ProGutenberg},WPGMZA.Integration.ProGutenberg.prototype.getMapSelectOptions=function(){var result=[];return WPGMZA.gutenbergData.maps.forEach(function(el){result.push({key:el.id,value:el.id,label:el.map_title+" ("+el.id+")"})}),result},WPGMZA.Integration.ProGutenberg.prototype.updateMarkerSelectOptions=function(props){var select=$("select[name='marker']"),mashup_ids=$("select[name='mashup_ids']").val(),none=$("<option value='none'></option>"),request={fields:["id","address","title"],filter:{map_id:$("select[name='map_id']").val()}};none.text(__("None")),mashup_ids&&(request.filter.mashup_ids=mashup_ids),select.prop("disabled",!0),WPGMZA.restAPI.call("/markers/",{success:function(response){select.html(""),select.append(none),response.forEach(function(data){var option=$("<option/>");option.val(data.id),option.prop("value",data.id),option.text((data.title.length?data.title:data.address)+" ("+data.id+")"),select.append(option)}),select.prop("disabled",!1),props.attributes.marker&&select.val(props.attributes.marker)},data:request})},WPGMZA.Integration.ProGutenberg.prototype.updateCategorySelectOptions=function(props){var select=$("select[name='cat']"),none=$("<option value='none'></option>"),request={filter:{map_id:$("select[name='map_id']").val()}};none.text(__("None")),select.prop("disabled",!0),WPGMZA.restAPI.call("/categories/",{success:function(response){select.html(""),select.append(none),function addNodeChildren(node,depth){depth=depth||0,node.children&&node.children.forEach(function(child){for(var prefix="",option=$("<option/>"),i=0;i<depth;i++)prefix+="&nbsp;&nbsp;&nbsp;&nbsp;";option.val(child.id),option.prop(child.id),option.html(prefix+child.name+" ("+child.id+")"),select.append(option),addNodeChildren(child,depth+1)})}(response),select.prop("disabled",!1),props.attributes.cat&&select.val(props.attributes.cat)},data:request})},WPGMZA.Integration.ProGutenberg.prototype.getBlockInspectorControls=function(props){var self=this,selectedMapID="1";return props.attributes.id?selectedMapID=props.attributes.id:WPGMZA.gutenbergData.maps.length&&(selectedMapID=WPGMZA.gutenbergData.maps[0].id),setTimeout(function(){self.updateMarkerSelectOptions(props),self.updateCategorySelectOptions(props)},100),React.createElement(InspectorControls,{key:"inspector"},React.createElement(PanelBody,{title:__("Map Settings")},React.createElement(SelectControl,{name:"map_id",label:__("Map"),value:selectedMapID,options:this.getMapSelectOptions(),onChange:function(value){props.setAttributes({id:value})}}),React.createElement("p",{className:"map-block-gutenberg-button-container"},React.createElement("a",{href:WPGMZA.adminurl+"admin.php?page=wp-google-maps-menu",onClick:function(event){var map_id=$("select[name='map_id']").val();return window.open(WPGMZA.adminurl+"admin.php?page=wp-google-maps-menu&action=edit&map_id="+map_id),event.preventDefault(),!1},target:"_blank",className:"button button-primary"},React.createElement("i",{className:"fa fa-pencil-square-o","aria-hidden":"true"}),__("Go to Map Editor"))),React.createElement(SelectControl,{name:"mashup_ids",label:__("Mashup IDs"),value:props.attributes.mashup_ids||[],options:this.getMapSelectOptions(),multiple:!0,onChange:function(value){props.setAttributes({mashup_ids:value})}}),React.createElement("p",{className:"map-block-gutenberg-button-container"},React.createElement("button",{className:"button button-primary",onClick:function(){$("select[name='mashup_ids']").val(null),props.setAttributes({mashup_ids:[]})}},React.createElement("i",{className:"fa fa-times","aria-hidden":"true"}),__("Reset Mashup IDs"))),React.createElement(SelectControl,{name:"marker",label:__("Focused Marker"),value:"none",options:[{key:"none",value:"none",label:__("None")}],onChange:function(value){props.setAttributes({marker:value})}}),React.createElement(RangeControl,{name:"zoom",label:__("Override Zoom"),onChange:function(value){props.setAttributes({zoom:value})},min:1,max:21,step:1,value:parseInt(props.attributes.zoom)}),React.createElement("p",{className:"map-block-gutenberg-button-container"},React.createElement("button",{className:"button button-primary",onClick:function(){props.setAttributes({zoom:""})}},React.createElement("i",{className:"fa fa-times","aria-hidden":"true"}),__("Reset Override Zoom"))),React.createElement(SelectControl,{name:"cat",label:__("Initial Category"),value:"none",options:[{key:"none",value:"none",label:__("None")}],onChange:function(value){props.setAttributes({cat:value})}}),React.createElement("p",{className:"map-block-gutenberg-button-container"},React.createElement("a",{href:"https://www.wpgmaps.com/documentation/creating-your-first-map/",target:"_blank",className:"button button-primary"},React.createElement("i",{className:"fa fa-book","aria-hidden":"true"}),__("View Documentation")))))},WPGMZA.Integration.ProGutenberg.prototype.getBlockAttributes=function(props){return{id:{type:"string"},mashup_ids:{type:"array"},marker:{type:"string"},zoom:{type:"string"},cat:{type:"string"}}},WPGMZA.Integration.ProGutenberg.prototype.getBlockDefinition=function(props){return WPGMZA.Integration.Gutenberg.prototype.getBlockDefinition.call(this,props)},WPGMZA.integrationModules.gutenberg=WPGMZA.Integration.Gutenberg.createInstance()}}),jQuery(function($){WPGMZA.GoogleDirectionsRenderer=function(map){WPGMZA.DirectionsRenderer.apply(this,arguments),this.map=map,this.googleDirectionsDisplay=new google.maps.DirectionsRenderer({map:map.googleMap,preserveViewport:!0,draggable:!0,suppressMarkers:!0}),this.googleDirectionsDisplay.setPanel($("#directions_panel_"+map.id)[0])},WPGMZA.extend(WPGMZA.GoogleDirectionsRenderer,WPGMZA.DirectionsRenderer),WPGMZA.GoogleDirectionsRenderer.prototype.setDirections=function(directions){this.googleDirectionsDisplay.setDirections(directions.originalResponse),directions.routes&&directions.routes[0]&&directions.routes[0].legs&&directions.routes[0].legs[0]&&(this.directionLeg=directions.routes[0].legs[0],this.directionStartMarker=WPGMZA.Marker.createInstance({position:new WPGMZA.LatLng(this.directionLeg.start_location.lat(),this.directionLeg.start_location.lng()),icon:this.map.settings.directions_route_origin_icon,disableInfoWindow:!0}),this.map.addMarker(this.directionStartMarker),this.directionEndMarker=WPGMZA.Marker.createInstance({position:new WPGMZA.LatLng(this.directionLeg.end_location.lat(),this.directionLeg.end_location.lng()),icon:this.map.settings.directions_route_destination_icon,disableInfoWindow:!0}),this.map.addMarker(this.directionEndMarker));var options={polylineOptions:{strokeColor:"#4285F4"}};this.map.settings.directions_route_stroke_color&&(options.polylineOptions.strokeColor=this.map.settings.directions_route_stroke_color),this.map.settings.directions_route_stroke_weight&&(options.polylineOptions.strokeWeight=parseFloat(this.map.settings.directions_route_stroke_weight)),this.map.settings.directions_route_stroke_opacity&&(options.polylineOptions.strokeOpacity=parseFloat(this.map.settings.directions_route_stroke_opacity)),this.googleDirectionsDisplay.setMap(this.map.googleMap),this.googleDirectionsDisplay.setOptions(options)},WPGMZA.GoogleDirectionsRenderer.prototype.clear=function(){this.googleDirectionsDisplay.setMap(null),this.directionStartMarker&&this.map.removeMarker(this.directionStartMarker),this.directionEndMarker&&this.map.removeMarker(this.directionEndMarker)}}),jQuery(function($){WPGMZA.GoogleDirectionsService=function(map){WPGMZA.DirectionsService.apply(this,arguments),this.googleDirectionsService=new google.maps.DirectionsService},WPGMZA.extend(WPGMZA.GoogleDirectionsService,WPGMZA.DirectionsService),WPGMZA.GoogleDirectionsService.prototype.route=function(request,callback){var self=this;request.travelMode=request.travelMode.toUpperCase(),this.googleDirectionsService.route(request,function(response){var status;switch(response.originalResponse=$.extend({},response),response.status){case google.maps.DirectionsStatus.OK:status=WPGMZA.DirectionsService.SUCCESS;break;case google.maps.DirectionsStatus.ZERO_RESULTS:status=WPGMZA.DirectionsService.ZERO_RESULTS;break;case google.maps.DirectionsStatus.NOT_FOUND:status=WPGMZA.DirectionsService.NOT_FOUND;break;default:return void console.warn("Failed to get directions from Google: "+response.status)}callback(response,status);var event=new WPGMZA.Event({type:"directionsserviceresult",response:response,status:status});self.map.trigger(event)})}}),jQuery(function($){WPGMZA.GoogleHeatmap=function(row){WPGMZA.Heatmap.call(this,row),google.maps.visualization?(this.googleHeatmap=new google.maps.visualization.HeatmapLayer(this.settings),this.updateGoogleHeatmap()):console.warn("Heatmaps disabled. You must include the visualization library in the Google Maps API")},WPGMZA.GoogleHeatmap.prototype=Object.create(WPGMZA.Heatmap.prototype),WPGMZA.GoogleHeatmap.prototype.constructor=WPGMZA.GoogleHeatmap,WPGMZA.GoogleHeatmap.prototype.updateGoogleHeatmap=function(){for(var points=this.points,len=points.length,data=[],i=0;i<len;i++)data.push(new google.maps.LatLng(points[i].lat,points[i].lng));this.googleHeatmap.setData(data),this.map&&this.googleHeatmap.setMap(this.map.googleMap)},WPGMZA.GoogleHeatmap.prototype.addPoint=function(latLng){WPGMZA.Heatmap.prototype.addPoint.call(this,latLng),this.updateGoogleHeatmap()},WPGMZA.GoogleHeatmap.prototype.removePoint=function(latLng){WPGMZA.Heatmap.prototype.removePoint.call(this,latLng),this.updateGoogleHeatmap()}}),jQuery(function($){WPGMZA.GoogleProInfoWindow=function(mapObject){WPGMZA.GoogleInfoWindow.call(this,mapObject)},WPGMZA.GoogleProInfoWindow.prototype=Object.create(WPGMZA.GoogleInfoWindow.prototype),WPGMZA.GoogleProInfoWindow.prototype.constructor=WPGMZA.GoogleProInfoWindow,WPGMZA.GoogleProInfoWindow.prototype.open=function(map,mapObject){switch(this.mapObject=mapObject,"map-edit"==WPGMZA.currentPage?WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE:this.style){case WPGMZA.ProInfoWindow.STYLE_MODERN:case WPGMZA.ProInfoWindow.STYLE_MODERN_PLUS:case WPGMZA.ProInfoWindow.STYLE_MODERN_CIRCULAR:case WPGMZA.ProInfoWindow.STYLE_TEMPLATE:return WPGMZA.ProInfoWindow.prototype.open.call(this,map,mapObject);default:var result=WPGMZA.GoogleInfoWindow.prototype.open.call(this,map,mapObject);return this.maxWidth&&this.googleInfoWindow&&this.googleInfoWindow.setOptions({maxWidth:this.maxWidth}),result}}}),jQuery(function($){WPGMZA.GoogleProMap=function(element,options){WPGMZA.GoogleMap.call(this,element,options),this.loadKMLLayers(),this.trigger("init"),this.dispatchEvent("created"),WPGMZA.events.dispatchEvent({type:"mapcreated",map:this})},WPGMZA.GoogleProMap.prototype=Object.create(WPGMZA.GoogleMap.prototype),WPGMZA.GoogleProMap.prototype.constructor=WPGMZA.GoogleProMap.prototype,WPGMZA.GoogleProMap.prototype.addHeatmap=function(heatmap){heatmap.googleHeatmap.setMap(this.googleMap),WPGMZA.ProMap.prototype.addHeatmap.call(this,heatmap)},WPGMZA.GoogleProMap.prototype.loadKMLLayers=function(){if(this.kmlLayers)for(var i=0;i<this.kmlLayers.length;i++)this.kmlLayers[i].setMap(null);if(this.kmlLayers=[],this.settings.kml){var urls=this.settings.kml.split(","),cachebuster=(new Date).getTime();for(i=0;i<urls.length;i++)this.kmlLayers.push(new google.maps.KmlLayer(urls[i]+"?cachebuster="+cachebuster,{map:this.googleMap,preserveViewport:!0}))}},WPGMZA.GoogleProMap.prototype.loadFusionTableLayer=function(){this.settings.fusion&&(console.warn("Fusion Table Layers are deprecated and will cease functioning from 2019/12/03"),this.fusionLayer=new google.maps.FusionTablesLayer(this.settings.fusion,{map:this.googleMap,surpressInfoWindows:!0}))},WPGMZA.GoogleProMap.prototype.setStreetView=function(options){var latLng=this.getCenter();"marker"in(options=options||{bearing:0,pitch:10})&&(marker=this.getMarkerByID(options.marker))?latLng=marker.getPosition().toLatLngLiteral():"lat"in options&&"lng"in options&&(latLng={lat:parseFloat(options.lat),lng:parseFloat(options.lng)}),"bearing"in options&&(options.bearing=parseInt(options.bearing),isNaN(options.bearing)&&console.warn("Invalid bearing")),"pitch"in options&&(options.pitch=parseInt(options.pitch),isNaN(options.pitch)&&console.warn("Invalid pitch")),this.panorama=new google.maps.StreetViewPanorama(this.element,{position:latLng,pov:{heading:parseInt(options.bearing),pitch:parseInt(options.pitch)}})},WPGMZA.GoogleProMap.prototype.onInit=function(event){WPGMZA.GoogleMap.prototype.onInit.call(this,event),this.shortcodeAttributes.streetview&&!this.shortcodeAttributes.marker&&this.setStreetView(this.shortcodeAttributes)},WPGMZA.GoogleProMap.prototype.onMarkersPlaced=function(event){WPGMZA.GoogleMap.prototype.onMarkersPlaced.call(this,event),this.shortcodeAttributes.streetview&&this.shortcodeAttributes.marker&&this.setStreetView(this.shortcodeAttributes)}}),jQuery(function($){WPGMZA.GoogleProMarker=function(row){WPGMZA.GoogleMarker.call(this,row)},WPGMZA.GoogleProMarker.prototype=Object.create(WPGMZA.GoogleMarker.prototype),WPGMZA.GoogleProMarker.prototype.constructor=WPGMZA.GoogleProMarker,WPGMZA.GoogleProMarker.prototype.onAdded=function(event){WPGMZA.GoogleMarker.prototype.onAdded.apply(this,arguments),this.map.settings.wpgmza_settings_disable_infowindows&&this.googleMarker.setOptions({clickable:!1})},WPGMZA.GoogleProMarker.prototype.updateIcon=function(){var self=this,icon=this._icon;if(icon.retina){var img=new Image;img.onload=function(event){var size;size=new google.maps.Size(WPGMZA.settings.retinaWidth?parseInt(WPGMZA.settings.retinaWidth):Math.round(img.width/2),WPGMZA.settings.retinaHeight?parseInt(WPGMZA.settings.retinaHeight):Math.round(img.height/2)),self.googleMarker.setIcon(new google.maps.MarkerImage(icon.url,null,null,null,size))},img.src=icon.isDefault?WPGMZA.defaultMarkerIcon:icon.url}else this.googleMarker.setIcon(icon.url)}}),jQuery(function($){WPGMZA.GoogleProPolygon=function(row,googlePolygon){var self=this;WPGMZA.GooglePolygon.call(this,row,googlePolygon),google.maps.event.addListener(this.googlePolygon,"mouseover",function(event){self.onMouseOver(event)}),google.maps.event.addListener(this.googlePolygon,"mouseout",function(event){self.onMouseOut(event)})},WPGMZA.GoogleProPolygon.prototype=Object.create(WPGMZA.GooglePolygon.prototype),WPGMZA.GoogleProPolygon.prototype.constructor=WPGMZA.GoogleProPolygon,WPGMZA.GoogleProPolygon.prototype.onMouseOver=function(event){var options={};this.settings.hoverFillColor&&this.settings.hoverFillColor.length&&(options.fillColor=this.settings.hoverFillColor),this.settings.hoverOpacity&&this.settings.hoverOpacity.length&&(options.fillOpacity=this.settings.hoverOpacity),this.settings.hoverStrokeColor&&this.settings.hoverStrokeColor.length&&(options.strokeColor=this.settings.hoverStrokeColor),this.googlePolygon.setOptions(options)},WPGMZA.GoogleProPolygon.prototype.onMouseOut=function(event){this.googlePolygon.setOptions(this.settings)}}),jQuery(function($){WPGMZA.AdvancedTableDataTable=function(element,listing){var self=this;this.element=element,this.listing=listing,WPGMZA.DataTable.apply(this,arguments),this.overrideListingOrderSettings=!1,$(this.dataTableElement).on("click","th",function(event){self.onUserChangedOrder(event)})},WPGMZA.AdvancedTableDataTable.prototype=Object.create(WPGMZA.DataTable.prototype),WPGMZA.AdvancedTableDataTable.prototype.constructor=WPGMZA.AdvancedTableDataTable,WPGMZA.AdvancedTableDataTable.prototype.getDataTableSettings=function(){var json,self=this,options=WPGMZA.DataTable.prototype.getDataTableSettings.apply(this,arguments);return(json=$(this.element).attr("data-order-json"))&&(options.order=JSON.parse(json)),options.drawCallback=function(settings){var ths=$(self.element).find(".wpgmza_table > thead th");self.lastResponse&&self.lastResponse.meta&&(0!=self.lastResponse.meta.length&&($(self.element).find(".wpgmza_table > tbody > tr").each(function(index,tr){var meta=self.lastResponse.meta[index];$(tr).addClass("wpgmaps_mlist_row"),$(tr).attr("mid",meta.id),$(tr).attr("mapid",self.map.id),$(tr).children("td").each(function(col,td){var wpgmza_class=ths[col].className.match(/wpgmza_\w+/)[0];$(td).addClass(wpgmza_class)})}),$(self.element).find("[data-marker-icon-src]").each(function(index,el){var data,src=$(el).attr("data-marker-icon-src");try{data=JSON.parse(src)}catch(e){data=src}WPGMZA.MarkerIcon.createInstance(data).applyToElement(el)})),self.map.markerListing.trigger("markerlistingupdated"))},options},WPGMZA.AdvancedTableDataTable.prototype.onAJAXRequest=function(data,settings){var request,listingParams=this.listing.getAJAXRequestParameters().data,listingFilteringParams=listingParams.filteringParams;listingParams.overrideMarkerIDs;return delete listingParams.filteringParams,delete listingParams.overrideMarkerIDs,(request=$.extend({},listingParams,WPGMZA.DataTable.prototype.onAJAXRequest.apply(this,arguments))).filteringParams=$.extend({},listingFilteringParams,this.filteringParams),this.filteredMarkerIDs&&(request.markerIDs=this.filteredMarkerIDs.join(",")),void 0!==this.overrideListingOrderSettings&&(request.overrideListingOrderSettings=this.overrideListingOrderSettings),request},WPGMZA.AdvancedTableDataTable.prototype.onMarkerFilterFilteringComplete=function(event){var self=this;this.filteredMarkerIDs=[],event.filteredMarkers.forEach(function(data){self.filteredMarkerIDs.push(data.id)}),self.filteringParams=event.filteringParams},WPGMZA.AdvancedTableDataTable.prototype.onUserChangedOrder=function(event){this.overrideListingOrderSettings=!0}}),jQuery(function($){WPGMZA.MarkerListing=function(map,element,options){var self=this;if(WPGMZA.EventDispatcher.apply(this),this._paginationEnabled=!0,this.map=this.parent=map,this.element=element,this.element?this.element.wpgmzaMarkerListing=this:WPGMZA.isDeveloperMode()&&console.warn("Marker listing initialised with null element. This is presently supported to allow the marker listing category filter to still function, however this will be removed in the future."),options)for(var key in options)this[key]=options[key];this.categoryDropdown=$(".wpgmza-marker-listing-category-filter[data-map-id='"+this.map.id+"'] select"),$(this.categoryDropdown).closest(".wpgmza-store-locator").length||this.categoryDropdown.on("change",function(event){WPGMZA.getMapByID(self.map.id).markerFilter.update()}),this.categoryCheckboxes=$(".wpgmza-marker-listing-category-filter[data-map-id='"+this.map.id+"'] input[type='checkbox']"),this.categoryCheckboxes.on("change",function(event){WPGMZA.getMapByID(self.map.id).markerFilter.update()}),1==map.settings.store_locator_hide_before_search&&(this.showOnFilteringComplete=!0,$(this.element).hide()),$(this.element).on("click",".wpgmaps_mlist_row, .wpgmaps_blist_row",function(event){self.onItemClick(event)}),$(document.body).on("filteringcomplete.wpgmza",function(event){event.map.id==self.map.id&&self.onFilteringComplete(event)}),this.reload()},WPGMZA.extend(WPGMZA.MarkerListing,WPGMZA.EventDispatcher),WPGMZA.MarkerListing.createInstance=function(map,element,options){switch(map.settings.list_markers_by){case WPGMZA.MarkerListing.STYLE_ADVANCED_TABLE:return new WPGMZA.AdvancedTableMarkerListing(map,element,options);case WPGMZA.MarkerListing.STYLE_CAROUSEL:return new WPGMZA.CarouselMarkerListing(map,element,options);case WPGMZA.MarkerListing.STYLE_MODERN:return new WPGMZA.ModernMarkerListing(map,element,options);default:return new WPGMZA.MarkerListing(map,element,options)}},WPGMZA.MarkerListing.STYLE_NONE=0,WPGMZA.MarkerListing.STYLE_BASIC_TABLE=1,WPGMZA.MarkerListing.STYLE_BASIC_LIST=4,WPGMZA.MarkerListing.STYLE_ADVANCED_TABLE=2,WPGMZA.MarkerListing.STYLE_CAROUSEL=3,WPGMZA.MarkerListing.STYLE_MODERN=6,WPGMZA.MarkerListing.ORDER_BY_ID=1,WPGMZA.MarkerListing.ORDER_BY_TITLE=2,WPGMZA.MarkerListing.ORDER_BY_ADDRESS=3,WPGMZA.MarkerListing.ORDER_BY_DESCRIPTION=4,WPGMZA.MarkerListing.ORDER_BY_CATEGORY=5,WPGMZA.MarkerListing.ORDER_BY_CATEGORY_PRIORITY=6,WPGMZA.MarkerListing.ORDER_BY_DISTANCE=7,WPGMZA.MarkerListing.ORDER_BY_RATING=8,Object.defineProperty(WPGMZA.MarkerListing.prototype,"mapID",{get:function(){return this.map.id}}),Object.defineProperty(WPGMZA.MarkerListing.prototype,"paginationEnabled",{get:function(){return this._paginationEnabled},set:function(value){this._paginationEnabled=!!value}}),Object.defineProperty(WPGMZA.MarkerListing.prototype,"pageSize",{get:function(){if(!WPGMZA.settings.wpgmza_default_items)return 10;var pageSize=parseInt(WPGMZA.settings.wpgmza_default_items);return isNaN(pageSize)?null:pageSize},set:function(value){this.pagination("pageSize",value)}}),Object.defineProperty(WPGMZA.MarkerListing.prototype,"currentPage",{get:function(){if(!this.paginationElement)return 0;try{return $(this.paginationElement).pagination("getSelectedPageNum")-1}catch(e){return 0}},set:function(value){throw new Error("Not yet implemented")}}),Object.defineProperty(WPGMZA.MarkerListing.prototype,"imageWidth",{get:function(){var width=WPGMZA.settings.wpgmza_settings_image_width;return!(!width||!/^\d+$/.test(width))&&width}}),Object.defineProperty(WPGMZA.MarkerListing.prototype,"imageHeight",{get:function(){var height=WPGMZA.settings.wpgmza_settings_image_height;return!(!height||!/^\d+$/.test(height))&&height}}),Object.defineProperty(WPGMZA.MarkerListing.prototype,"style",{get:function(){return this.map.settings.list_markers_by}}),WPGMZA.MarkerListing.prototype.initPagination=function(){if(this.paginationElement){try{$(this.paginationElement).pagination("destroy")}catch(e){}$(this.paginationElement).remove()}if(this.paginationEnabled&&!this.showOnFilteringComplete&&this.pageSize){var options=this.getPaginationOptions();if(this.lastAJAXResponse.recordsFiltered<=options.pageSize)return;this.paginationElement=$("<div class='wpgmza-pagination'/>"),this.pagination=$(this.paginationElement).pagination(this.getPaginationOptions()),$(this.element).after(this.paginationElement)}},WPGMZA.MarkerListing.prototype.getPaginationOptions=function(){var self=this,options={triggerPagingOnInit:!1,pageSize:this.pageSize,dataSource:function(done){done(self.getPaginationDataSource())},callback:function(data,pagination){self.pageOnPaginationReinit=$(self.paginationElement).pagination("getSelectedPageNum"),$(self.paginationElement).pagination("disable"),self.reload()}};return this.pageOnPaginationReinit&&(options.pageNumber=this.pageOnPaginationReinit),options},WPGMZA.MarkerListing.prototype.getPaginationDataSource=function(){var source=[];if(!this.lastAJAXResponse)return source;for(var i=0;i<this.lastAJAXResponse.recordsFiltered;i++)source.push(i);return source},WPGMZA.MarkerListing.prototype.getAJAXRequestParameters=function(params){var self=this;(params=params||{}).data||(params.data={}),params.method="POST",params.useCompressedPathVariable=!0,params.cache=!0;var str=$(this.element).attr("data-wpgmza-ajax-parameters");if(!str||!str.length)throw new Error("No AJAX parameters specified on Marker Listing attribute");var attributeParameters=JSON.parse(str);if($.extend(params.data,{phpClass:$(this.element).attr("data-wpgmza-php-class"),start:this.currentPage*this.pageSize,length:this.pageSize},attributeParameters),this.overrideMarkerIDs&&(params.data.overrideMarkerIDs=this.overrideMarkerIDs.join(",")),this.lastFilteringParams&&(params.data.filteringParams=this.lastFilteringParams),this.map.showDistanceFromLocation){params.data.filteringParams||(params.data.filteringParams={});var location=this.map.showDistanceFromLocation;params.data.filteringParams.center={lat:location.lat,lng:location.lng,source:location.source}}return params.success=function(response,textStatus,xhr){self.onAJAXResponse(response,textStatus,xhr)},params},WPGMZA.MarkerListing.prototype.onAJAXResponse=function(response,textStatus,xhr){this.map.showPreloader(!1),this.lastAJAXResponse=response,this.onHTMLResponse(response.html),this.initPagination(),this.trigger("markerlistingupdated")},WPGMZA.MarkerListing.prototype.onHTMLResponse=function(html){var self=this;$(this.element).html(html),$(this.element).find(".wpgmza-gallery-container").each(function(index,el){var map=self.map,marker_id=$(el).closest("[data-marker-id]").attr("data-marker-id"),marker=map.getMarkerByID(marker_id);if(marker.gallery){var gallery=new WPGMZA.MarkerGallery(marker,self);$(el).html(""),$(el).append(gallery.element)}}),$(this.element).find("[data-marker-icon-src]").each(function(index,el){var data,src=$(el).attr("data-marker-icon-src");try{data=JSON.parse(src)}catch(e){data=src}WPGMZA.MarkerIcon.createInstance(data).applyToElement(el)})},WPGMZA.MarkerListing.prototype.getImageElementFromURL=function(url){var img=$("<img class='wpgmza_map_image'/>");return $(img).attr("src",url),this.imageWidth&&$(img).css({width:this.imageWidth+"px"}),this.imageHeight&&$(img).css({height:this.imageHeight+"px"}),img},WPGMZA.MarkerListing.prototype.getRatingWidget=function(marker){var options={type:"marker",id:marker.id};return marker.rating&&(options.averageRating=marker.rating.average,options.numRatings=marker.rating.count),WPGMZA.RatingWidget.createInstance(options)},WPGMZA.MarkerListing.prototype.reload=function(){if(this.element){this.prevXHRRequest&&this.prevXHRRequest.abort();var route=$(this.element).attr("data-wpgmza-rest-api-route"),params=this.getAJAXRequestParameters();this.map.showPreloader(!0),this.prevXHRRequest=WPGMZA.restAPI.call(route,params)}},WPGMZA.MarkerListing.prototype.enable=function(value){value?this.pagination("enable"):this.pagination("disable")},WPGMZA.MarkerListing.prototype.getFilteringParameters=function(){var params={};return this.categoryDropdown.length&&"0"!=this.categoryDropdown.val()&&(params.categories=[this.categoryDropdown.val()]),this.categoryCheckboxes.length&&(params.categories=[],this.categoryCheckboxes.each(function(index,el){$(el).prop("checked")&&params.categories.push($(el).val())})),params},WPGMZA.MarkerListing.prototype.onFilteringComplete=function(event){var self=this;this.showOnFilteringComplete&&($(this.element).show(),delete this.showOnFilteringComplete),this.overrideMarkerIDs=[],event.filteredMarkers.forEach(function(data){self.overrideMarkerIDs.push(data.id)}),this.lastFilteringParams=event.filteringParams,this.pageOnPaginationReinit=1,this.reload()},WPGMZA.MarkerListing.prototype.onItemClick=function(event){var marker_id=$(event.currentTarget).attr("mid"),marker=this.map.getMarkerByID(marker_id),listingPushedInMap=WPGMZA.maps[0].settings.push_in_map&&WPGMZA.maps[0].settings.push_in_map.length,clickedGetDirections=$(event.target).hasClass("wpgmza_gd"),zoomLevelOnClick=13;if(marker.trigger("select"),this.style!=WPGMZA.MarkerListing.STYLE_MODERN&&!WPGMZA.settings.disable_scroll_on_marker_listing_click&&!clickedGetDirections&&!listingPushedInMap){var offset=0;WPGMZA.settings.marker_listing_item_click_scroll_offset&&(offset=parseInt(WPGMZA.settings.marker_listing_item_click_scroll_offset)),$("html, body").animate({scrollTop:$(this.map.element).offset().top-offset},500)}this.map.settings.zoom_level_on_marker_listing_click&&(zoomLevelOnClick=this.map.settings.zoom_level_on_marker_listing_click),this.map instanceof WPGMZA.GoogleMap?(this.map.panTo(marker.getPosition()),this.map.setZoom(zoomLevelOnClick)):this.map.panTo(marker.getPosition(),zoomLevelOnClick)}}),jQuery(function($){WPGMZA.AdvancedTableMarkerListing=function(map,element,options){this.element=element=$("#wpgmza_marker_holder_"+map.id+", #wpgmza_marker_list_"+map.id),WPGMZA.MarkerListing.apply(this,arguments),this.dataTable=new WPGMZA.AdvancedTableDataTable(element,this),this.dataTable.map=map},WPGMZA.AdvancedTableMarkerListing.prototype=Object.create(WPGMZA.MarkerListing.prototype),WPGMZA.AdvancedTableMarkerListing.prototype.constructor=WPGMZA.AdvancedTableMarkerListing,WPGMZA.AdvancedTableMarkerListing.prototype.reload=function(){this.dataTable&&this.dataTable.reload()},WPGMZA.AdvancedTableMarkerListing.prototype.onFilteringComplete=function(event){this.dataTable.onMarkerFilterFilteringComplete(event),WPGMZA.MarkerListing.prototype.onFilteringComplete.apply(this,arguments)},WPGMZA.AdvancedTableMarkerListing.prototype.onItemClick=function(event){var isFirstCell=$(event.target).is(":first-child");$(event.target).closest(".dataTable").is(".collapsed")&&isFirstCell||WPGMZA.MarkerListing.prototype.onItemClick.call(this,event)}}),jQuery(function($){WPGMZA.CarouselMarkerListing=function(map,element,options){WPGMZA.MarkerListing.call(this,map,element,$.extend({paginationEnabled:!1},options))},WPGMZA.CarouselMarkerListing.prototype=Object.create(WPGMZA.MarkerListing.prototype),WPGMZA.CarouselMarkerListing.prototype.constructor=WPGMZA.CarouselMarkerListing,WPGMZA.CarouselMarkerListing.createInstance=function(el){return new WPGMZA.CarouselMarkerListing(el)},WPGMZA.CarouselMarkerListing.prototype.getOwlCarouselOptions=function(){var options={autoplay:!0,autoplayTimeout:5e3,lazyLoad:!1,autoHeight:!1,dots:!1,nav:!1,loop:!0,responsive:{0:{items:1},500:{items:3},800:{items:5}}};return"yes"==wpgmaps_localize_global_settings.carousel_lazyload&&(options.lazyLoad=!0),isNaN(wpgmaps_localize_global_settings.carousel_autoplay)||(options.autoplayTimeout=parseInt(wpgmaps_localize_global_settings.carousel_autoplay)),"yes"==wpgmaps_localize_global_settings.carousel_autoheight&&(options.autoHeight=!0),"yes"==wpgmaps_localize_global_settings.carousel_pagination&&(options.dots=!0),"yes"==wpgmaps_localize_global_settings.carousel_navigation&&(options.nav=!0),isNaN(wpgmaps_localize_global_settings.carousel_items)||(options.responsive[800].items=parseInt(wpgmaps_localize_global_settings.carousel_items)),isNaN(wpgmaps_localize_global_settings.carousel_items_tablet)||(options.responsive[500].items=parseInt(wpgmaps_localize_global_settings.carousel_items_tablet)),isNaN(wpgmaps_localize_global_settings.carousel_items_mobile)||(options.responsive[0].items=parseInt(wpgmaps_localize_global_settings.carousel_items_mobile)),options},WPGMZA.CarouselMarkerListing.prototype.getAJAXRequestParameters=function(params){return delete(params=WPGMZA.MarkerListing.prototype.getAJAXRequestParameters.call(this,params)).data.start,delete params.data.length,params},WPGMZA.CarouselMarkerListing.prototype.onHTMLResponse=function(html){WPGMZA.MarkerListing.prototype.onHTMLResponse.call(this,html),$(this.element).trigger("destroy.owl.carousel"),$(this.element).owlCarousel(this.getOwlCarouselOptions())}}),jQuery(function($){WPGMZA.ModernMarkerListing=function(map,element,options){var self=this,map_id=map.id,container=$("#wpgmza_map_"+map_id);container.attr("data-mashup-ids");WPGMZA.MarkerListing.apply(this,arguments),this.map=map,this.element=element,this.openButton=$('<div class="wpgmza-modern-marker-open-button wpgmza-modern-shadow wpgmza-modern-hover-opaque"><i class="fa fa-map-marker"></i> <i class="fa fa-list"></i></div>'),container.append(this.openButton),container.append(this.element),this.popoutPanel=new WPGMZA.PopoutPanel,this.popoutPanel.element=this.element,map.on("init",function(event){container.append(self.element),container.append(self.openButton)}),self.openButton.on("click",function(event){self.open(),$("#wpgmza_map_"+map_id+" .wpgmza-modern-store-locator").addClass("wpgmza_sl_offset")}),this.markerView=new WPGMZA.ModernMarkerListingMarkerView(map),this.markerView.parent=this,$(this.element).find(".wpgmza-close-container").on("click",function(event){self.close(),$("#wpgmza_map_"+self.map.id+" .wpgmza-modern-store-locator").removeClass("wpgmza_sl_offset")}),$(this.element).on("click","li",function(event){self.markerView.open($(event.currentTarget).attr("mid"))}),$(document.body).on("click",".wpgmza_sl_reset_button_"+map_id,function(event){$(self.element).find("li[mid]").show()}),$(document.body).on("filteringcomplete.wpgmza",function(event){event.map.id==self._mapID&&self.onFilteringComplete(event)})},WPGMZA.ModernMarkerListing.prototype=Object.create(WPGMZA.MarkerListing.prototype),WPGMZA.ModernMarkerListing.prototype.constructor=WPGMZA.ModernMarkerListing,WPGMZA.ModernMarkerListing.prototype.initPagination=function(){WPGMZA.MarkerListing.prototype.initPagination.apply(this,arguments),this.pageSize&&$(this.element).find("ul").after(this.paginationElement)},WPGMZA.ModernMarkerListing.prototype.onHTMLResponse=function(html){$(this.element).find("ul.wpgmza-modern-marker-listing-list-item-container").html(html)},WPGMZA.ModernMarkerListing.prototype.open=function(){this.popoutPanel.open()},WPGMZA.ModernMarkerListing.prototype.close=function(){this.popoutPanel.close()}}),jQuery(function($){WPGMZA.OLDirectionsRenderer=function(map){var self=this;WPGMZA.DirectionsRenderer.apply(this,arguments),this.panel=$("#directions_panel_"+map.id),this.panel.on("click",".wpgmza-directions-step",function(event){self.onStepClicked(event)})},WPGMZA.extend(WPGMZA.OLDirectionsRenderer,WPGMZA.DirectionsRenderer),WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_LEFT=0,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_RIGHT=1,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_SHARP_LEFT=2,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_SHARP_RIGHT=3,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_SLIGHT_LEFT=4,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_SLIGHT_RIGHT=5,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_STRAIGHT=6,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_ENTER_ROUNDABOUT=7,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_EXIT_ROUNDABOUT=8,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_U_TURN=9,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_GOAL=10,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_DEPART=11,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_KEEP_LEFT=12,WPGMZA.OLDirectionsRenderer.INSTRUCTION_TYPE_KEEP_RIGHT=13,WPGMZA.OLDirectionsRenderer.instructionTypeToClassName=function(type){for(var name in WPGMZA.OLDirectionsRenderer)if(name.match(/^INSTRUCTION_TYPE_/)&&WPGMZA.OLDirectionsRenderer[name]==type)return"wpgmza-"+name.replace(/_/g,"-").toLowerCase()},WPGMZA.OLDirectionsRenderer.prototype.clear=function(){this.polyline&&(this.map.removePolyline(this.polyline),delete this.polyline),this.stepHighlightPolyline&&(this.map.removePolyline(this.stepHighlightPolyline),delete this.stepHighlightPolyline),this.panel.html("")},WPGMZA.OLDirectionsRenderer.prototype.setDirections=function(directions){var self=this,route=directions.routes[0],source=window.polyline.decode(route.geometry),points=[];this.clear(),source.forEach(function(arr){points.push(new WPGMZA.LatLng({lat:arr[0],lng:arr[1]}))});var settings={strokeColor:"#4285F4",strokeWeight:4,strokeOpacity:.8};this.map.settings.directions_route_stroke_color&&(settings.strokeColor=this.map.settings.directions_route_stroke_color),this.map.settings.directions_route_stroke_weight&&(settings.strokeWeight=this.map.settings.directions_route_stroke_weight),this.map.settings.directions_route_stroke_opacity&&(settings.strokeOpacity=this.map.settings.directions_route_stroke_opacity),this.polyline=WPGMZA.Polyline.createInstance({points:points,settings:settings}),this.map.addPolyline(this.polyline),this.directionStartMarker&&this.map.removeMarker(this.directionStartMarker),this.directionEndMarker&&this.map.removeMarker(this.directionEndMarker),this.directionStartMarker=WPGMZA.Marker.createInstance({position:points[0],icon:this.map.settings.directions_route_origin_icon,disableInfoWindow:!0}),this.map.addMarker(this.directionStartMarker),this.directionEndMarker=WPGMZA.Marker.createInstance({position:points[points.length-1],icon:this.map.settings.directions_route_destination_icon,disableInfoWindow:!0}),this.map.addMarker(this.directionEndMarker);var steps=[];route.segments&&route.segments.forEach(function(segment){steps=steps.concat(segment.steps)}),steps.forEach(function(step){var div=$("<div class='wpgmza-directions-step'></div>");div[0].wpgmzaDirectionsStep=step,div.html(step.instruction),div.addClass(WPGMZA.OLDirectionsRenderer.instructionTypeToClassName(step.type)),self.panel.append(div)})},WPGMZA.OLDirectionsRenderer.prototype.onStepClicked=function(event){var step=event.currentTarget.wpgmzaDirectionsStep,bounds=new WPGMZA.LatLngBounds,startIndex=step.way_points[0],endIndex=step.way_points[step.way_points.length-1];if(this.stepHighlightPolyline&&(this.map.removePolyline(this.stepHighlightPolyline),delete this.stepHighlightPolyline),startIndex!=endIndex){for(var points=[],i=startIndex;i<=endIndex;i++){var vertex=this.polyline.points[i];points.push(vertex),bounds.extend(vertex)}var polyline=WPGMZA.Polyline.createInstance({points:points,settings:{strokeColor:"#ff0000",strokeWeight:4,strokeOpacity:.8}});this.stepHighlightPolyline=polyline,this.map.addPolyline(this.stepHighlightPolyline),this.map.fitBounds(bounds),WPGMZA.animateScroll(this.map.element)}}}),jQuery(function($){WPGMZA.OLDirectionsService=function(map){WPGMZA.DirectionsService.apply(this,arguments),this.apiKey=WPGMZA.settings.open_route_service_key},WPGMZA.extend(WPGMZA.OLDirectionsService,WPGMZA.DirectionsService),WPGMZA.OLDirectionsService.prototype.geocodeWaypoints=function(waypoints,callback){var geocoder=WPGMZA.Geocoder.createInstance(),index=0,coordinates=[];!function geocodeNextWaypoint(){geocoder.geocode({address:waypoints[index]},function(results){results.length?coordinates.push([results[0].latLng.lng,results[0].latLng.lat]):coordinates.push(WPGMZA.DirectionsService.NOT_FOUND),++index==waypoints.length?callback(coordinates):geocodeNextWaypoint()})}()},WPGMZA.OLDirectionsService.prototype.route=function(request,callback){var profile,url,self=this,translated={};switch(request.travelMode){case WPGMZA.DirectionsService.WALKING:profile="foot-walking";break;case WPGMZA.DirectionsService.BICYCLING:profile="cycling-regular";break;case WPGMZA.DirectionsService.TRANSIT:console.warn("Public transport profile is not supported by OpenRouteService");default:profile="driving-car"}url="https://api.openrouteservice.org/v2/directions/"+profile;var waypoints=[request.origin];request.waypoints&&request.waypoints.forEach(function(obj){waypoints.push(obj.location)}),waypoints.push(request.destination),this.geocodeWaypoints(waypoints,function(coordinates){for(var i=0;i<coordinates.length;i++)if(coordinates[i]==WPGMZA.DirectionsService.NOT_FOUND){var response={geocoded_waypoints:[]};for(i=0;i<waypoints.length;i++)response.geocoded_waypoints.push({geocoder_status:coordinates[i]});return void callback(response,WPGMZA.DirectionsService.NOT_FOUND)}switch(translated.coordinates=coordinates,WPGMZA.locale.substr(0,2)){case"de":case"en":case"pt":case"ru":case"hu":case"fr":case"it":case"cn":case"dk":case"de":translated.language=WPGMZA.locale.substr(0,2)}$.ajax(url,{method:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(translated),beforeSend:function(xhr){xhr.setRequestHeader("Authorization",self.apiKey)},success:function(response,status,xhr){status=response.routes&&0<response.routes.length?WPGMZA.DirectionsService.SUCCESS:WPGMZA.DirectionsService.ZERO_RESULTS,callback(response,status);var event=new WPGMZA.Event({type:"directionsserviceresult",response:response,status:status});self.map.trigger(event)}})})}}),jQuery(function($){WPGMZA.OLHeatmap=function(row){WPGMZA.Heatmap.call(this,row);var settings=$.extend({source:this.getSource()},this.settings);this.olHeatmap=new ol.layer.Heatmap(settings),this.updateOLHeatmap()},WPGMZA.OLHeatmap.prototype=Object.create(WPGMZA.Heatmap.prototype),WPGMZA.OLHeatmap.prototype.constructor=WPGMZA.OLHeatmap,WPGMZA.OLHeatmap.prototype.updateOLHeatmap=function(){var self=this;setTimeout(function(){self.olHeatmap.setSource(self.getSource())},1e3)},WPGMZA.OLHeatmap.prototype.getSource=function(){for(var points=this.points,len=points.length,features=[],i=0;i<len;i++)features.push(new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([points[i].lng,points[i].lat]))}));return new ol.source.Vector({features:features})},WPGMZA.OLHeatmap.prototype.addPoint=function(latLng){WPGMZA.Heatmap.prototype.addPoint.call(this,latLng),this.updateOLHeatmap()},WPGMZA.OLHeatmap.prototype.removePoint=function(latLng){WPGMZA.Heatmap.prototype.removePoint.call(this,latLng),this.updateOLHeatmap()}}),jQuery(function($){WPGMZA.OLProInfoWindow=function(mapObject){WPGMZA.OLInfoWindow.call(this,mapObject)},WPGMZA.OLProInfoWindow.prototype=Object.create(WPGMZA.OLInfoWindow.prototype),WPGMZA.OLProInfoWindow.prototype.constructor=WPGMZA.OLProInfoWindow,Object.defineProperty(WPGMZA.OLProInfoWindow.prototype,"panIntoViewOnOpen",{get:function(){return this.style==WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE}}),WPGMZA.OLProInfoWindow.prototype.open=function(map,mapObject){switch(this.mapObject=mapObject,"map-edit"==WPGMZA.currentPage?WPGMZA.ProInfoWindow.STYLE_NATIVE_GOOGLE:this.style){case WPGMZA.ProInfoWindow.STYLE_MODERN:case WPGMZA.ProInfoWindow.STYLE_MODERN_PLUS:case WPGMZA.ProInfoWindow.STYLE_MODERN_CIRCULAR:case WPGMZA.ProInfoWindow.STYLE_TEMPLATE:return WPGMZA.ProInfoWindow.prototype.open.call(this,map,mapObject);default:return WPGMZA.OLInfoWindow.prototype.open.call(this,map,mapObject)}}}),jQuery(function($){WPGMZA.OLProMap=function(element,options){WPGMZA.OLMap.call(this,element,options);var prevHoveringMapObjects=[];this.loadKMLLayers(),this.olMap.on("pointermove",function(event){if(!event.dragging){for(var pixel=event.map.getEventPixel(event.originalEvent),currentHoveringMapObjects=[],i=(event.map.forEachFeatureAtPixel(pixel,function(feature,layer){return layer&&layer.wpgmzaObject&&(layer.wpgmzaObject.hovering||(layer.wpgmzaObject.hovering=!0,layer.wpgmzaObject.dispatchEvent("mouseover")),currentHoveringMapObjects.push(layer.wpgmzaObject)),!0}),0);i<prevHoveringMapObjects.length;i++)-1==currentHoveringMapObjects.indexOf(prevHoveringMapObjects[i])&&(prevHoveringMapObjects[i].hovering=!1,prevHoveringMapObjects[i].dispatchEvent("mouseout"));prevHoveringMapObjects=currentHoveringMapObjects}}),this.trigger("init"),this.dispatchEvent("created"),WPGMZA.events.dispatchEvent({type:"mapcreated",map:this})},WPGMZA.OLProMap.prototype=Object.create(WPGMZA.OLMap.prototype),WPGMZA.OLProMap.prototype.constructor=WPGMZA.OLMap.prototype,WPGMZA.OLProMap.prototype.addHeatmap=function(heatmap){this.olMap.addLayer(heatmap.olHeatmap),WPGMZA.ProMap.prototype.addHeatmap.call(this,heatmap)},WPGMZA.OLProMap.prototype.loadKMLLayers=function(){if(this.kmlLayers)for(var i=0;i<this.kmlLayers.length;i++)this.olMap.removeLayer(this.kmlLayers[i]);if(this.kmlLayers=[],this.settings.kml){var urls=this.settings.kml.split(",");for((new Date).getTime(),i=0;i<urls.length;i++){var layer=new ol.layer.Vector({source:new ol.source.Vector({url:urls[i],format:new ol.format.KML({extractAttributes:!0})})});this.kmlLayers.push(layer),this.olMap.addLayer(layer)}}}}),jQuery(function($){WPGMZA.OLProMarker=function(row){WPGMZA.OLMarker.call(this,row)},WPGMZA.OLProMarker.prototype=Object.create(WPGMZA.OLMarker.prototype),WPGMZA.OLProMarker.prototype.constructor=WPGMZA.OLProMarker,WPGMZA.OLProMarker.prototype.updateIcon=function(){var self=this,icon=this._icon;WPGMZA.OLMarker.renderMode==WPGMZA.OLMarker.RENDER_MODE_HTML_ELEMENT?(this.icon.applyToElement($(this.element).find("img")),WPGMZA.getImageDimensions(icon.url,function(dimensions){self.updateElementHeight(dimensions.height)})):(this.vectorLayerStyle=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],src:icon.url})}),this.feature.setStyle(this.vectorLayerStyle))}}),jQuery(function($){WPGMZA.OLProPolygon=function(row,olFeature){var self=this;WPGMZA.OLPolygon.call(this,row,olFeature),this.addEventListener("mouseover",function(event){self.onMouseOver(event)}),this.addEventListener("mouseout",function(event){self.onMouseOut(event)})},WPGMZA.OLProPolygon.prototype=Object.create(WPGMZA.OLPolygon.prototype),WPGMZA.OLProPolygon.prototype.constructor=WPGMZA.OLProPolygon,WPGMZA.OLProPolygon.prototype.onMouseOver=function(event){if(!this.olHoverStyle){var params={};this.settings.hoverOpacity&&(params.fill=new ol.style.Fill({color:WPGMZA.hexOpacityToRGBA(this.settings.hoverFillColor,this.settings.hoverOpacity)})),this.settings.hoverStrokeColor&&(params.stroke=new ol.style.Stroke({color:WPGMZA.hexOpacityToRGBA(this.settings.hoverStrokeColor,1)})),this.olHoverStyle=new ol.style.Style(params)}this.layer.setStyle(this.olHoverStyle)},WPGMZA.OLProPolygon.prototype.onMouseOut=function(event){this.layer.setStyle(this.olStyle)}}),jQuery(function($){WPGMZA.ProAdminMarkerDataTable=function(element){WPGMZA.AdminMarkerDataTable.apply(this,arguments)},WPGMZA.extend(WPGMZA.ProAdminMarkerDataTable,WPGMZA.AdminMarkerDataTable),WPGMZA.AdminMarkerDataTable.createInstance=function(element){return new WPGMZA.ProAdminMarkerDataTable(element)},WPGMZA.ProAdminMarkerDataTable.prototype.onAJAXResponse=function(response){WPGMZA.AdminMarkerDataTable.prototype.onAJAXResponse.apply(this,arguments),$("[data-marker-icon-src]").each(function(index,element){WPGMZA.MarkerIcon.createInstance($(element).attr("data-marker-icon-src")).applyToElement(element)})}});